<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Laura Ospina-Rozo" />


<title>Polarisation analysis</title>

<script src="site_libs/header-attrs-2.17/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #ffffff;
    color: #a0a0a0;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
div.sourceCode
  { color: #1f1c1b; background-color: #ffffff; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #1f1c1b; } /* Normal */
code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
code span.an { color: #ca60ca; } /* Annotation */
code span.at { color: #0057ae; } /* Attribute */
code span.bn { color: #b08000; } /* BaseN */
code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
code span.ch { color: #924c9d; } /* Char */
code span.cn { color: #aa5500; } /* Constant */
code span.co { color: #898887; } /* Comment */
code span.cv { color: #0095ff; } /* CommentVar */
code span.do { color: #607880; } /* Documentation */
code span.dt { color: #0057ae; } /* DataType */
code span.dv { color: #b08000; } /* DecVal */
code span.er { color: #bf0303; text-decoration: underline; } /* Error */
code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
code span.fl { color: #b08000; } /* Float */
code span.fu { color: #644a9b; } /* Function */
code span.im { color: #ff5500; } /* Import */
code span.in { color: #b08000; } /* Information */
code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
code span.op { color: #1f1c1b; } /* Operator */
code span.ot { color: #006e28; } /* Other */
code span.pp { color: #006e28; } /* Preprocessor */
code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
code span.sc { color: #3daee9; } /* SpecialChar */
code span.ss { color: #ff5500; } /* SpecialString */
code span.st { color: #bf0303; } /* String */
code span.va { color: #0057ae; } /* Variable */
code span.vs { color: #bf0303; } /* VerbatimString */
code span.wa { color: #bf0303; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Photonic Rebels</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Main</a>
</li>
<li>
  <a href="MacroEcol_1_SettingUp.html">Setting up</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Extracting variables
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="MacroEcol_2_OpticalProperties.html">Reflectivity &amp; Absorptivity</a>
    </li>
    <li>
      <a href="MacroEcol_3_Polarisation.html">Polarisation</a>
    </li>
    <li>
      <a href="MacroEcol_4_EcologicalVariables.html">Ecology</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Analysis
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="MacroEcol_5_ReflectivityStats.html">Reflectivity</a>
    </li>
    <li>
      <a href="MacroEcol_6_AbsorptivityStats.html">Absorptivity</a>
    </li>
    <li>
      <a href="MacroEcol_7_PolarisationStats.html">Polarisation</a>
    </li>
    <li>
      <a href="MacroEcol_8_SizeStats.html">Size</a>
    </li>
    <li>
      <a href="MacroEcol_9_ReflectivityQC.html">Quality control (reflectivity)</a>
    </li>
    <li>
      <a href="MacroEcol_10_AbsorptivityQC.html">Quality control (absorptivity)</a>
    </li>
  </ul>
</li>
<li>
  <a href="MacroEcol_11_ExtraFigures.html">Extra figures</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Polarisation analysis</h1>
<h4 class="author">Laura Ospina-Rozo</h4>

</div>


<p>In this script we study the Polarisation trait corrected by
phylogeny.</p>
<div id="setting-up" class="section level1">
<h1>Setting up</h1>
<div id="libraries" class="section level2">
<h2>Libraries</h2>
<p>Libraries sourced from an additional script.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;Scripts/MacroEcol_1_Libraries.R&quot;</span>))</span></code></pre></div>
</div>
<div id="data-sets" class="section level2">
<h2>Data sets</h2>
<p>Import polarisation data.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># elytra</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>PolBySpp <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;Data/FromCode/PolarzElytraBySpp.csv&quot;</span>))[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>PolByInd <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;Data/FromCode/PolarzElytraByInd.csv&quot;</span>))[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># elytra and pronotum</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>BeetlePol <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;Data/FromCode/PolarzElytraPronot.csv&quot;</span>))[<span class="sc">-</span><span class="dv">1</span>]</span></code></pre></div>
<p>All statistical analysis were done at the species level (polarisation
data by species). Plots are produced with the polarisation data by
individual.</p>
<p>And we imported the phylogeny from a .nwk file which contains 2000
phylogenetic trees. This allows us to test our hypothesis in multiple
trees and not only on the MCC tree. This way, we account for any
uncertainty in unresolved tips of our phylogeny.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Phylogeny</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>trees <span class="ot">&lt;-</span> ape<span class="sc">::</span><span class="fu">read.tree</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;Data/XMAS_mat2b_bst2ef_set23nn2_pinct.nwk&quot;</span>))</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set subset limits</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>trees_subset_min<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>trees_subset_max<span class="ot">&lt;-</span><span class="dv">2000</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>MCCtree <span class="ot">&lt;-</span> </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  ape<span class="sc">::</span><span class="fu">read.nexus</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;Data/xmas_mat2b_bst2ef_set23nn2_pinct_med.tre&quot;</span>))</span></code></pre></div>
<p>To explore the correlations between ecological variables and
polarisation</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># PC Values</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>PCValuesF <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;Data/FromCode/PCsbySpp.csv&quot;</span>))[<span class="sc">-</span><span class="dv">1</span>] <span class="sc">%&gt;%</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;PC1&quot;</span> <span class="ot">=</span> PC1_1, <span class="st">&quot;PC2&quot;</span> <span class="ot">=</span> PC2_1)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># merge with polarisation</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>PolPCs <span class="ot">&lt;-</span> <span class="fu">merge</span>(PCValuesF, PolBySpp)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co"># adapt to merge with phylogeny</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>PolPCs2 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(PolPCs) <span class="co"># create new data frame</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(PolPCs2) <span class="ot">&lt;-</span> PolPCs2[, <span class="dv">1</span>] <span class="co"># make species the row names</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>PolPCsRows <span class="ot">&lt;-</span> PolPCs2[, <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(PolPCs2)] <span class="co"># eliminate spp name (redundant)</span></span></code></pre></div>
<p>To explore correlations with reflectivity</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reflectivity data consolidated by species</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>ReflBySpp <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;Data/FromCode/ConsolidatedReflectivitySpp.csv&quot;</span>))[<span class="sc">-</span><span class="dv">1</span>] <span class="sc">%&gt;%</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(phylogeny_name)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge with polarisation</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>PolRefl <span class="ot">&lt;-</span> <span class="fu">merge</span>(ReflBySpp, PolBySpp)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co"># adapt to merge with phylogeny</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>PolRefl2 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(PolRefl) <span class="co"># create new data frame</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(PolRefl2) <span class="ot">&lt;-</span> PolRefl2[, <span class="dv">1</span>] <span class="co"># make species the row names</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>PolReflRows <span class="ot">&lt;-</span> PolRefl2[, <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(PolRefl2)] <span class="co"># eliminate spp name (redundant)</span></span></code></pre></div>
<p>To explore correlations with absorptivity</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>AbsBySpp <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;Data/FromCode/ConsolidatedAbsorptivitySpp.csv&quot;</span>))[<span class="sc">-</span><span class="dv">1</span>] <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(phylogeny_name)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># merge with polarisation</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>PolAbs <span class="ot">&lt;-</span> <span class="fu">merge</span>(AbsBySpp, PolBySpp)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co"># adapt to merge with phylogeny</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>PolAbs2 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(PolAbs) <span class="co"># create new data frame</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(PolAbs2) <span class="ot">&lt;-</span> PolAbs2[, <span class="dv">1</span>] <span class="co"># make species the row names</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>PolAbsRows <span class="ot">&lt;-</span> PolAbs2[, <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(PolAbs2)] <span class="co"># eliminate spp name (redundant)</span></span></code></pre></div>
<p>To explore correlations with reflectivity only in Right handed
polarisation (as a proxy of the amount of melanin/pigments)</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import equalised values for right handed polarisation</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>RHand0<span class="ot">&lt;-</span><span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;Data/FromCode/PolarzElytra_LERGBValues.csv&quot;</span>))[<span class="sc">-</span><span class="dv">1</span>]<span class="sc">%&gt;%</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Type <span class="sc">==</span> <span class="st">&quot;RCP&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>Type) <span class="sc">%&gt;%</span> </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">spp=</span> <span class="fu">substr</span>(ind,<span class="dv">1</span>,<span class="dv">4</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(spp) <span class="sc">%&gt;%</span> </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">meanRCP =</span> <span class="fu">mean</span>(RGB_ave),</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">sdRCP =</span> <span class="fu">sd</span>(RGB_ave),</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Join them with the phylogeny names</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>SppNames<span class="ot">&lt;-</span><span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;Data/9_CodesAndSpecies.csv&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="st">&quot;spp&quot;</span> <span class="ot">=</span> <span class="fu">substr</span>(Ind,<span class="dv">1</span>,<span class="dv">4</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>Ind) <span class="sc">%&gt;%</span> </span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>RHand <span class="ot">&lt;-</span> <span class="fu">merge</span>(RHand0[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)],SppNames)</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Name the right hand RGB &quot;pol&quot; to use the accessory scripts for multiple trees:</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>RHand <span class="ot">&lt;-</span> </span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>  RHand <span class="sc">%&gt;%</span> </span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Pol =</span> meanRCP) <span class="sc">%&gt;%</span> </span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(phylogeny_name) <span class="sc">%&gt;%</span> </span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">Pol=</span> <span class="fu">mean</span>(Pol))</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine with reflectivity</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>RHandRefl <span class="ot">&lt;-</span> <span class="fu">merge</span>(ReflBySpp, RHand) </span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>RHandRefl2 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(RHandRefl) <span class="co"># create new data frame</span></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(RHandRefl2) <span class="ot">&lt;-</span> RHandRefl2[, <span class="dv">1</span>] <span class="co"># make species the row names</span></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>RHandReflRows <span class="ot">&lt;-</span> RHandRefl2[, <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(RHandRefl2)] <span class="co"># eliminate spp name </span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine with absorptivity</span></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>RHandAbs <span class="ot">&lt;-</span> <span class="fu">merge</span>(AbsBySpp, RHand) </span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>RHandAbs2 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(RHandAbs) <span class="co"># create new data frame</span></span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(RHandAbs2) <span class="ot">&lt;-</span> RHandAbs2[, <span class="dv">1</span>] <span class="co"># make species the row names</span></span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>RHandAbsRows <span class="ot">&lt;-</span> RHandAbs2[, <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(RHandAbs2)] <span class="co"># eliminate spp name </span></span></code></pre></div>
<p>We prune the species in the tree that are not present in the
dataset</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prune extra spp in the tree, not contain in the test sample</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>PolAbs.species.MCC <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">unique</span>(PolAbs2<span class="sc">$</span>phylogeny_name))</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to &quot;row names&quot; (required for following steps)</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(PolAbs.species.MCC) <span class="ot">&lt;-</span> PolAbs.species.MCC[, <span class="dv">1</span>] </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Make sure the names in data set and tree match</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>PolAbs.temp.MCC <span class="ot">&lt;-</span> <span class="fu">name.check</span>(MCCtree, PolAbs.species.MCC)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co"># This step is necessary because the tips are different.</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>MCCtreeAbs <span class="ot">&lt;-</span> <span class="fu">drop.tip</span>(MCCtree, PolAbs.temp.MCC<span class="sc">$</span>tree_not_data)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Test if the species are the same</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="fu">identical</span>(</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">length</span>(<span class="fu">name.check</span>(MCCtreeAbs, PolAbs2<span class="sc">$</span>phylogeny_name)<span class="sc">$</span>tree_not_data),</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">length</span>(PolAbs2<span class="sc">$</span>phylogeny_name)</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
</div>
<div id="body-part" class="section level1">
<h1>Body part</h1>
<p>It is possible that different selective pressures apply to the elytra
than to other parts of the beetle body. There are various species that
seem to have stronger structural coloration in the pronotum. They may
have lost the polarization in their elytra.</p>
<p><strong>Are there differences in the polarisation between the elytra
and pronotum of the same individual?</strong></p>
<p style="color: #04C799">
<p><strong>Statistics</strong></p>
</p>
<p>Conduct a paired t-test to compare the mean of the difference to 0. A
negative difference would mean that in general the pronotum is more
polarized than the elytra.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Paired t test</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(BeetlePol<span class="sc">$</span>Difference)</span></code></pre></div>
<pre><code>## 
##  One Sample t-test
## 
## data:  BeetlePol$Difference
## t = -1.2468, df = 173, p-value = 0.2142
## alternative hypothesis: true mean is not equal to 0
## 95 percent confidence interval:
##  -0.019894362  0.004490845
## sample estimates:
##    mean of x 
## -0.007701759</code></pre>
<p>The mean difference in polarisation between the two body parts is not
significantly different than 0.</p>
<p style="color: #04C799">
<p><strong>Plots</strong></p>
</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(BeetlePol<span class="sc">$</span>Difference,</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="dv">20</span>,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;Difference in polarization (Elytra-Pronot)&quot;</span>,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;Frequency&quot;</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="MacroEcol_7_PolarisationStats_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>These beetles with higher polarisation in their elytra are:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>ElytraMoreP <span class="ot">&lt;-</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    BeetlePol <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(Difference <span class="sc">&gt;</span> <span class="fl">0.1</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>ElytraMoreP<span class="sc">$</span>ind</span></code></pre></div>
<pre><code>##  [1] &quot;atki01&quot; &quot;atki02&quot; &quot;brun01&quot; &quot;brun04&quot; &quot;brun05&quot; &quot;ecry01&quot; &quot;fchi01&quot; &quot;fchi02&quot; &quot;hirs03&quot; &quot;lats01&quot; &quot;lats03&quot; &quot;pvul02&quot; &quot;pvul03&quot; &quot;pvul04&quot; &quot;rayn01&quot; &quot;rayn03&quot; &quot;smgr01&quot;</code></pre>
<p>These beetles with higher polarisation in their pronotum are:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>PronotumMoreP <span class="ot">&lt;-</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    BeetlePol <span class="sc">%&gt;%</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(Difference <span class="sc">&lt;</span> <span class="sc">-</span><span class="fl">0.1</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>PronotumMoreP<span class="sc">$</span>ind</span></code></pre></div>
<pre><code>##  [1] &quot;aurs01&quot; &quot;aurs02&quot; &quot;clor09&quot; &quot;meli02&quot; &quot;meli03&quot; &quot;neus01&quot; &quot;oliv03&quot; &quot;opal01&quot; &quot;pvul01&quot; &quot;rubi01&quot; &quot;rubi02&quot; &quot;vrdi01&quot; &quot;vrdi03&quot;</code></pre>
</div>
<div id="ecological-variables" class="section level1">
<h1>Ecological variables</h1>
<p style="color: #04C799">
<p><strong>Question</strong></p>
</p>
<p><strong>Is polarization correlated to the extracted climate
variables?</strong></p>
<p style="color: #04C799">
<p><strong>Statistics</strong></p>
</p>
<div id="pagels-lambda" class="section level2">
<h2>Pagel’s lambda</h2>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>pagelPDPol <span class="ot">&lt;-</span> PolPCsRows<span class="sc">$</span>Pol <span class="co"># Define which trait we want to test</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(pagelPDPol) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(PolPCsRows) <span class="co"># Row names = tree tips</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">phylosig</span>(MCCtree, pagelPDPol, <span class="at">method =</span> <span class="st">&quot;lambda&quot;</span>, <span class="at">test =</span> <span class="cn">TRUE</span>, <span class="at">nsim =</span> <span class="dv">999</span>)</span></code></pre></div>
<pre><code>## 
## Phylogenetic signal lambda : 0.955169 
## logL(lambda) : 40.0202 
## LR(lambda=0) : 28.1436 
## P-value (based on LR test) : 0.000000112637</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># nsim = 999 means testing with 999 randomisations</span></span></code></pre></div>
<p>Phylogenetic signal is high.</p>
</div>
<div id="pgls-in-the-mcc" class="section level2">
<h2>PGLS in the MCC</h2>
<p>Create the data frame of comparative data</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract sizes</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>SizesDf <span class="ot">&lt;-</span> PolRefl <span class="sc">%&gt;%</span> </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>              dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="st">&quot;phylogeny_name&quot;</span>, <span class="st">&quot;size&quot;</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co"># merge size into ecological variables dataset</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>PolPCsWithSizes <span class="ot">&lt;-</span> <span class="fu">merge</span>(SizesDf, PolPCs)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>comp_data2 <span class="ot">&lt;-</span> <span class="fu">comparative.data</span>(</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">phy =</span> MCCtree,</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> PolPCsWithSizes, <span class="co"># aggregated data without the spp in the row names</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">names.col =</span> <span class="st">&quot;phylogeny_name&quot;</span>, <span class="co"># contains the column phylogeny name</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">vcv =</span> <span class="cn">TRUE</span>,</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">na.omit =</span> <span class="cn">FALSE</span>, <span class="at">warn.dropped =</span> <span class="cn">TRUE</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Establish the model</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>pglsPDPol <span class="ot">&lt;-</span> <span class="fu">pgls</span>(Pol <span class="sc">~</span> PC1 <span class="sc">+</span> PC2 <span class="sc">+</span> size <span class="sc">+</span> PC1 <span class="sc">*</span> size <span class="sc">+</span> PC2 <span class="sc">*</span> size,</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> comp_data2, <span class="at">param.CI =</span> <span class="fl">0.95</span>, <span class="at">lambda =</span> <span class="st">&quot;ML&quot;</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pglsPDPol)</span></code></pre></div>
<pre><code>## 
## Call:
## pgls(formula = Pol ~ PC1 + PC2 + size + PC1 * size + PC2 * size, 
##     data = comp_data2, lambda = &quot;ML&quot;, param.CI = 0.95)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.070205 -0.013454  0.006506  0.026522  0.079383 
## 
## Branch length transformations:
## 
## kappa  [Fix]  : 1.000
## lambda [ ML]  : 0.908
##    lower bound : 0.000, p = 0.0000078697
##    upper bound : 1.000, p = 0.0037317
##    95.0% CI   : (0.710, 0.983)
## delta  [Fix]  : 1.000
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)  0.0245801  0.1416766  0.1735   0.8631
## PC1         -0.0037788  0.0508632 -0.0743   0.9411
## PC2         -0.1073466  0.0641932 -1.6722   0.1021
## size         0.0107276  0.0493041  0.2176   0.8288
## PC1:size    -0.0078721  0.0218726 -0.3599   0.7208
## PC2:size     0.0358297  0.0257598  1.3909   0.1718
## 
## Residual standard error: 0.03551 on 41 degrees of freedom
## Multiple R-squared: 0.2871,  Adjusted R-squared: 0.2001 
## F-statistic: 3.302 on 5 and 41 DF,  p-value: 0.01348</code></pre>
<p style="color: #04C799">
<p><strong>Conclusion</strong></p>
</p>
<p><strong>Polarization does not directly correlate with these
ecological variables</strong></p>
</div>
<div id="pgls-in-multiple-trees" class="section level2">
<h2>PGLS in multiple trees</h2>
<p>Function</p>
<p>Note that the function has to be modified for the predictors and data
frame that we are using</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;Scripts/7_multiple_pgls_function_B.R&quot;</span>)) <span class="co"># script B is for Polarization as a response</span></span></code></pre></div>
<p>Model</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>MuPGLSPol2 <span class="ot">&lt;-</span> Polarization <span class="sc">~</span> PC1 <span class="sc">+</span> PC2 <span class="sc">+</span> size <span class="sc">+</span> PC1 <span class="sc">*</span> size <span class="sc">+</span> PC2 <span class="sc">*</span> size</span></code></pre></div>
<p>Dataset</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the phylogeny name again because in this function it is needed:</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>PDPol2 <span class="ot">&lt;-</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    PolPCsWithSizes <span class="sc">%&gt;%</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(phylogeny_name, Pol, size, PC1, PC2) <span class="sc">%&gt;%</span> </span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;Polarization&quot;</span> <span class="ot">=</span> Pol)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>PDPol2 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(PDPol2)</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(PDPol2) <span class="ot">&lt;-</span> PDPol2[, <span class="dv">1</span>]</span></code></pre></div>
<p>Apply</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>runsPol2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(trees[trees_subset_min<span class="sc">:</span>trees_subset_max],</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>                   pgls_runB, <span class="at">model =</span> MuPGLSPol2, <span class="at">dataset =</span> PDPol2)</span></code></pre></div>
<pre><code>## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>dfPol2 <span class="ot">&lt;-</span> <span class="fu">ldply</span>(runsPol2, data.frame)</span></code></pre></div>
<p>Get results</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">HPDinterval</span>(<span class="fu">as.mcmc</span>(dfPol2))</span></code></pre></div>
<pre><code>##                   lower        upper
## estimateP1 -0.019961932  0.012065708
## ts1        -0.398236915  0.218698747
## ps1         0.731524167  0.999803405
## estimateP2 -0.150983585 -0.075873842
## tP2        -2.341620113 -1.284685625
## pP2         0.017177465  0.173785078
## estimateP3 -0.004033164  0.037508114
## tP3        -0.081294101  0.739204491
## pP3         0.472676043  0.999673203
## estimateP4 -0.014311118 -0.001079027
## tP4        -0.659690073 -0.050508450
## pP4         0.513141587  0.939636609
## estimateP5  0.024501773  0.053619651
## tP5         0.974480549  2.027298118
## pP5         0.035180472  0.282547057
## attr(,&quot;Probability&quot;)
## [1] 0.950455</code></pre>
</div>
</div>
<div id="optical-properties" class="section level1">
<h1>Optical properties</h1>
<div id="pol-degree" class="section level2">
<h2>Pol Degree</h2>
<p>This is an indication of “how much of the colour is circularly
polarised to the left”. As a simplification, we assume that this is
equivalent to most of the reflections produced by a chiral mechanism</p>
<div id="reflectivity" class="section level3">
<h3>Reflectivity</h3>
<div id="vis" class="section level4">
<h4>VIS</h4>
<p style="color: #04C799">
<p><strong>Question</strong></p>
</p>
<p><strong>Can polarisation predict visible reflectivity?</strong></p>
<p style="color: #04C799">
<p><strong>Correlation</strong></p>
</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(PolRefl<span class="sc">$</span>VIS, PolRefl<span class="sc">$</span>Pol) <span class="co"># by spp</span></span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  PolRefl$VIS and PolRefl$Pol
## t = 1.5434, df = 45, p-value = 0.1297
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.06728212  0.48044869
## sample estimates:
##       cor 
## 0.2242168</code></pre>
<p style="color: #04C799">
<p><strong>Linear model</strong></p>
</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>ModL1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(PolRefl<span class="sc">$</span>VIS <span class="sc">~</span> PolRefl<span class="sc">$</span>Pol) <span class="co"># by spp</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ModL1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = PolRefl$VIS ~ PolRefl$Pol)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -10.4480  -4.9439   0.6226   3.3241  18.8607 
## 
## Coefficients:
##             Estimate Std. Error t value            Pr(&gt;|t|)    
## (Intercept)   13.288      1.131  11.744 0.00000000000000268 ***
## PolRefl$Pol   10.617      6.879   1.543                0.13    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 6.57 on 45 degrees of freedom
## Multiple R-squared:  0.05027,    Adjusted R-squared:  0.02917 
## F-statistic: 2.382 on 1 and 45 DF,  p-value: 0.1297</code></pre>
<p style="color: #04C799">
<p><strong>PGLS</strong></p>
</p>
<p>Create the data frame of comparative data</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>comp_data <span class="ot">&lt;-</span> <span class="fu">comparative.data</span>(</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">phy =</span> MCCtree,</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> PolRefl, <span class="co"># aggregated data without the spp in the row names</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">names.col =</span> <span class="st">&quot;phylogeny_name&quot;</span>, <span class="co"># contains the column phylogeny name</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">vcv =</span> <span class="cn">TRUE</span>,</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.omit =</span> <span class="cn">FALSE</span>, <span class="at">warn.dropped =</span> <span class="cn">TRUE</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Establish the model</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>pglsPDVIS <span class="ot">&lt;-</span> <span class="fu">pgls</span>(VIS <span class="sc">~</span> Pol,</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> comp_data, <span class="at">param.CI =</span> <span class="fl">0.95</span>, <span class="at">lambda =</span> <span class="st">&quot;ML&quot;</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pglsPDVIS)</span></code></pre></div>
<pre><code>## 
## Call:
## pgls(formula = VIS ~ Pol, data = comp_data, lambda = &quot;ML&quot;, param.CI = 0.95)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -6.0629 -1.4387 -0.1692  1.0222  3.3884 
## 
## Branch length transformations:
## 
## kappa  [Fix]  : 1.000
## lambda [ ML]  : 0.821
##    lower bound : 0.000, p = 0.59187
##    upper bound : 1.000, p = 0.15519
##    95.0% CI   : (NA, NA)
## delta  [Fix]  : 1.000
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)  11.4628     5.1935  2.2072  0.03245 *
## Pol           8.5383     8.8468  0.9651  0.33964  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.204 on 45 degrees of freedom
## Multiple R-squared: 0.02028, Adjusted R-squared: -0.001492 
## F-statistic: 0.9315 on 1 and 45 DF,  p-value: 0.3396</code></pre>
<p style="color: #04C799">
<p><strong>PGLS multiple trees</strong></p>
</p>
<p>Function</p>
<p>Note that the function has to be modified for the predictors and data
frame that we are using</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;Scripts/6_multiple_pgls_function_A.R&quot;</span>)) <span class="co"># script A is for Polarization as a response</span></span></code></pre></div>
<p>Model</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>MuPGLSPol3 <span class="ot">&lt;-</span> Response <span class="sc">~</span> Pol</span></code></pre></div>
<p>Dataset</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>PolRefl3 <span class="ot">&lt;-</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>    PolReflRows <span class="sc">%&gt;%</span> <span class="co"># phylogeny names in rows</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(Pol, VIS) <span class="sc">%&gt;%</span> </span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;Response&quot;</span> <span class="ot">=</span> VIS)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>PolRefl3 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(PolRefl3)</span></code></pre></div>
<p>Apply</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>runsPol3 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(trees[trees_subset_min<span class="sc">:</span>trees_subset_max],</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>                   pgls_runA, <span class="at">model =</span> MuPGLSPol3, <span class="at">dataset =</span> PolRefl3)</span></code></pre></div>
<pre><code>## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>dfPol3 <span class="ot">&lt;-</span> <span class="fu">ldply</span>(runsPol3, data.frame)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(dfPol3[,<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 980</code></pre>
<p>Get results</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">HPDinterval</span>(<span class="fu">as.mcmc</span>(dfPol3))</span></code></pre></div>
<pre><code>##                lower      upper
## estimateP1 1.5389948 12.2133812
## ts1        0.2060000  1.5457472
## ps1        0.1200562  0.8031361
## attr(,&quot;Probability&quot;)
## [1] 0.95</code></pre>
<p><span style="color: #04C799"><strong>Conclusion</strong></span>
<br/></p>
<p><strong>There’s no correlation between visible reflectivity and
polarisation at the species level.</strong></p>
<p><br> <br> <br></p>
</div>
<div id="nir" class="section level4">
<h4>NIR</h4>
<p style="color: #04C799">
<p><strong>Question</strong></p>
</p>
<p><strong>Is polarisation correlated with NIR
reflectivity?</strong></p>
<p style="color: #04C799">
<p><strong>Correlation</strong></p>
</p>
<p>Species level:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(PolRefl<span class="sc">$</span>NIR, PolRefl<span class="sc">$</span>Pol) <span class="co"># by spp</span></span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  PolRefl$NIR and PolRefl$Pol
## t = -1.7419, df = 45, p-value = 0.08836
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.50225033  0.03862105
## sample estimates:
##        cor 
## -0.2513332</code></pre>
<p style="color: #04C799">
<p><strong>Linear model</strong></p>
</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>ModL2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(PolRefl<span class="sc">$</span>NIR <span class="sc">~</span> PolRefl<span class="sc">$</span>Pol <span class="sc">+</span> PolRefl<span class="sc">$</span>VIS) <span class="co"># by spp</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ModL2)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = PolRefl$NIR ~ PolRefl$Pol + PolRefl$VIS)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -10.7760  -3.7231   0.3623   1.8078  26.2201 
## 
## Coefficients:
##             Estimate Std. Error t value            Pr(&gt;|t|)    
## (Intercept)  26.4224     2.2774  11.602 0.00000000000000563 ***
## PolRefl$Pol -29.5900     7.0475  -4.199            0.000129 ***
## PolRefl$VIS   1.1102     0.1488   7.460 0.00000000243789919 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 6.56 on 44 degrees of freedom
## Multiple R-squared:  0.5863, Adjusted R-squared:  0.5675 
## F-statistic: 31.18 on 2 and 44 DF,  p-value: 0.000000003685</code></pre>
<p style="color: #04C799">
<p><strong>PGLS</strong></p>
</p>
<p>The data frame of comparative data is the same as for visible
light</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>pglsPDNIR <span class="ot">&lt;-</span> <span class="fu">pgls</span>(NIR <span class="sc">~</span> Pol <span class="sc">+</span> VIS,</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> comp_data, <span class="at">param.CI =</span> <span class="fl">0.95</span>, <span class="at">lambda =</span> <span class="st">&quot;ML&quot;</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pglsPDNIR)</span></code></pre></div>
<pre><code>## 
## Call:
## pgls(formula = NIR ~ Pol + VIS, data = comp_data, lambda = &quot;ML&quot;, 
##     param.CI = 0.95)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2.5732 -0.5967  0.4584  1.3849  5.3729 
## 
## Branch length transformations:
## 
## kappa  [Fix]  : 1.000
## lambda [ ML]  : 0.602
##    lower bound : 0.000, p = 0.34197
##    upper bound : 1.000, p = 0.021873
##    95.0% CI   : (NA, 0.985)
## delta  [Fix]  : 1.000
## 
## Coefficients:
##             Estimate Std. Error t value       Pr(&gt;|t|)    
## (Intercept)  30.4608     4.3375  7.0227 0.000000010590 ***
## Pol         -28.4643     8.2204 -3.4627       0.001203 ** 
## VIS           1.1146     0.1471  7.5774 0.000000001644 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.824 on 44 degrees of freedom
## Multiple R-squared: 0.5847,  Adjusted R-squared: 0.5658 
## F-statistic: 30.97 on 2 and 44 DF,  p-value: 0.000000004027</code></pre>
<p style="color: #04C799">
<p><strong>PGLS multiple trees</strong></p>
</p>
<p>Function</p>
<p>Note that the function has to be modified for the predictors and data
frame that we are using</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;Scripts/13_multiple_pgls_function_H.R&quot;</span>)) <span class="co"># script A is for Polarization as a response</span></span></code></pre></div>
<p>Model</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>MuPGLSPol4 <span class="ot">&lt;-</span> Response <span class="sc">~</span> Pol <span class="sc">+</span> VIS</span></code></pre></div>
<p>Dataset</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>PolRefl4 <span class="ot">&lt;-</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>    PolReflRows <span class="sc">%&gt;%</span> <span class="co"># phylogeny names in rows</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(Pol, VIS, NIR) <span class="sc">%&gt;%</span> </span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;Response&quot;</span> <span class="ot">=</span> NIR)</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>PolRefl4 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(PolRefl4)</span></code></pre></div>
<p>Apply</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>runsPol4 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(trees[trees_subset_min<span class="sc">:</span>trees_subset_max],</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>                   pgls_runH, <span class="at">model =</span> MuPGLSPol4, <span class="at">dataset =</span> PolRefl4)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>dfPol4 <span class="ot">&lt;-</span> <span class="fu">ldply</span>(runsPol4, data.frame)</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(dfPol4[,<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 1001</code></pre>
<p>Get results</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">HPDinterval</span>(<span class="fu">as.mcmc</span>(dfPol4))</span></code></pre></div>
<pre><code>##                           lower               upper
## estimateP1 -30.5787807936124665 -26.984834060583118
## ts1         -4.1986326287349671  -3.208252902704267
## ps1          0.0001285882928512   0.002492216158802
## estimateP2   1.0936560546755665   1.133847417482905
## tP2          7.3334922240313078   7.843723842514416
## pP2          0.0000000006540746   0.000000003672992
## attr(,&quot;Probability&quot;)
## [1] 0.95005</code></pre>
</div>
<div id="frs" class="section level4">
<h4>FRS</h4>
<p style="color: #04C799">
<p><strong>Question</strong></p>
</p>
<p><strong>Is polarisation correlated with the NIR residuals corrected
by phylogeny?</strong></p>
<p style="color: #04C799">
<p><strong>Correlation</strong></p>
</p>
<p>Species level:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(PolRefl<span class="sc">$</span>FRS, PolRefl<span class="sc">$</span>Pol) <span class="co"># by spp</span></span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  PolRefl$FRS and PolRefl$Pol
## t = -4.2698, df = 45, p-value = 0.00009974
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.7140250 -0.2953307
## sample estimates:
##        cor 
## -0.5369585</code></pre>
<p style="color: #04C799">
<p><strong>Linear model</strong></p>
</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>ModL3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(PolRefl<span class="sc">$</span>FRS <span class="sc">~</span> PolRefl<span class="sc">$</span>Pol) <span class="co"># by spp</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ModL3)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = PolRefl$FRS ~ PolRefl$Pol)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -10.7187  -3.4801   0.3577   2.0168  26.3987 
## 
## Coefficients:
##             Estimate Std. Error t value  Pr(&gt;|t|)    
## (Intercept)   -3.270      1.119  -2.924   0.00539 ** 
## PolRefl$Pol  -29.038      6.801  -4.270 0.0000997 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 6.495 on 45 degrees of freedom
## Multiple R-squared:  0.2883, Adjusted R-squared:  0.2725 
## F-statistic: 18.23 on 1 and 45 DF,  p-value: 0.00009974</code></pre>
<p style="color: #04C799">
<p><strong>PGLS</strong></p>
</p>
<p>The data frame of comparative data is the same as for visible
light</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>pglsPDFRS <span class="ot">&lt;-</span> <span class="fu">pgls</span>(FRS <span class="sc">~</span> Pol,</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> comp_data, <span class="at">param.CI =</span> <span class="fl">0.95</span>, <span class="at">lambda =</span> <span class="st">&quot;ML&quot;</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pglsPDFRS)</span></code></pre></div>
<pre><code>## 
## Call:
## pgls(formula = FRS ~ Pol, data = comp_data, lambda = &quot;ML&quot;, param.CI = 0.95)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2.7353 -0.5292  0.3670  1.1161  5.4714 
## 
## Branch length transformations:
## 
## kappa  [Fix]  : 1.000
## lambda [ ML]  : 0.603
##    lower bound : 0.000, p = 0.34922
##    upper bound : 1.000, p = 0.023464
##    95.0% CI   : (NA, 0.986)
## delta  [Fix]  : 1.000
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)   0.74353    3.95005  0.1882 0.851541   
## Pol         -27.88818    8.01185 -3.4809 0.001123 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.809 on 45 degrees of freedom
## Multiple R-squared: 0.2121,  Adjusted R-squared: 0.1946 
## F-statistic: 12.12 on 1 and 45 DF,  p-value: 0.001123</code></pre>
<p style="color: #04C799">
<p><strong>PGLS multiple trees</strong></p>
</p>
<p>Dataset</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>PolRefl5 <span class="ot">&lt;-</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>    PolReflRows <span class="sc">%&gt;%</span> <span class="co"># phylogeny names in rows</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(Pol, FRS) <span class="sc">%&gt;%</span> </span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;Response&quot;</span> <span class="ot">=</span> FRS)</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>PolRefl5 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(PolRefl5)</span></code></pre></div>
<p>Apply</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>runsPol5 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(trees[trees_subset_min<span class="sc">:</span>trees_subset_max],</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>                   pgls_runA, <span class="at">model =</span> MuPGLSPol3, <span class="at">dataset =</span> PolRefl5)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>dfPol5 <span class="ot">&lt;-</span> <span class="fu">ldply</span>(runsPol5, data.frame)</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(dfPol5[,<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 1001</code></pre>
<p>Get results</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">HPDinterval</span>(<span class="fu">as.mcmc</span>(dfPol5))</span></code></pre></div>
<pre><code>##                      lower         upper
## estimateP1 -29.78511659011 -26.361994828
## ts1         -4.26978422766  -3.205786973
## ps1          0.00009973628   0.002479313
## attr(,&quot;Probability&quot;)
## [1] 0.95005</code></pre>
</div>
</div>
<div id="absorptivity" class="section level3">
<h3>Absorptivity</h3>
<div id="vis-1" class="section level4">
<h4>VIS</h4>
<p style="color: #04C799">
<p><strong>Question</strong></p>
</p>
<p><strong>Can polarisation predict visible absorptivity?</strong></p>
<p style="color: #04C799">
<p><strong>Correlation</strong></p>
</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(PolAbs<span class="sc">$</span>VIS, PolAbs<span class="sc">$</span>Pol) <span class="co"># by spp</span></span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  PolAbs$VIS and PolAbs$Pol
## t = 0.041288, df = 24, p-value = 0.9674
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.3801654  0.3944917
## sample estimates:
##         cor 
## 0.008427517</code></pre>
<p style="color: #04C799">
<p><strong>Linear model</strong></p>
</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>ModL1Abs <span class="ot">&lt;-</span> <span class="fu">lm</span>(PolAbs<span class="sc">$</span>VIS <span class="sc">~</span> PolAbs<span class="sc">$</span>Pol) <span class="co"># by spp</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ModL1Abs)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = PolAbs$VIS ~ PolAbs$Pol)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -23.4765  -4.4632   0.5597   7.5187  14.9412 
## 
## Coefficients:
##             Estimate Std. Error t value            Pr(&gt;|t|)    
## (Intercept)  79.3015     2.3443  33.828 &lt;0.0000000000000002 ***
## PolAbs$Pol    0.5093    12.3345   0.041               0.967    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 9.99 on 24 degrees of freedom
## Multiple R-squared:  7.102e-05,  Adjusted R-squared:  -0.04159 
## F-statistic: 0.001705 on 1 and 24 DF,  p-value: 0.9674</code></pre>
<p style="color: #04C799">
<p><strong>PGLS</strong></p>
</p>
<p>Create the data frame of comparative data</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>CompDataAbs <span class="ot">&lt;-</span> <span class="fu">comparative.data</span>(</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">phy =</span> MCCtreeAbs,</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> PolAbs, <span class="co"># aggregated data without the spp in the row names</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">names.col =</span> <span class="st">&quot;phylogeny_name&quot;</span>, <span class="co"># contains the column phylogeny name</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">vcv =</span> <span class="cn">TRUE</span>,</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.omit =</span> <span class="cn">FALSE</span>, <span class="at">warn.dropped =</span> <span class="cn">TRUE</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Establish the model</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>pglsPDVISAbs <span class="ot">&lt;-</span> <span class="fu">pgls</span>(VIS <span class="sc">~</span> Pol,</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> CompDataAbs, <span class="at">param.CI =</span> <span class="fl">0.95</span>, <span class="at">lambda =</span> <span class="st">&quot;ML&quot;</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pglsPDVISAbs)</span></code></pre></div>
<pre><code>## 
## Call:
## pgls(formula = VIS ~ Pol, data = CompDataAbs, lambda = &quot;ML&quot;, 
##     param.CI = 0.95)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -6.4016 -1.2370  0.6578  2.6280 11.2737 
## 
## Branch length transformations:
## 
## kappa  [Fix]  : 1.000
## lambda [ ML]  : 0.969
##    lower bound : 0.000, p = 0.29867
##    upper bound : 1.000, p = 0.4437
##    95.0% CI   : (NA, NA)
## delta  [Fix]  : 1.000
## 
## Coefficients:
##             Estimate Std. Error t value       Pr(&gt;|t|)    
## (Intercept)  80.7282     9.2640  8.7142 0.000000006724 ***
## Pol           5.9897    15.8311  0.3784         0.7085    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.695 on 24 degrees of freedom
## Multiple R-squared: 0.005929,    Adjusted R-squared: -0.03549 
## F-statistic: 0.1432 on 1 and 24 DF,  p-value: 0.7085</code></pre>
<p style="color: #04C799">
<p><strong>PGLS multiple trees</strong></p>
</p>
<p>Dataset</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>PolAbs3 <span class="ot">&lt;-</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>    PolAbsRows <span class="sc">%&gt;%</span> <span class="co"># phylogeny names in rows</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(Pol, VIS) <span class="sc">%&gt;%</span> </span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;Response&quot;</span> <span class="ot">=</span> VIS)</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>PolAbs3 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(PolAbs3)</span></code></pre></div>
<p>Apply</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>runsPol6 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(trees[trees_subset_min<span class="sc">:</span>trees_subset_max],</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>                   pgls_runA, <span class="at">model =</span> MuPGLSPol3, <span class="at">dataset =</span> PolAbs3)</span></code></pre></div>
<pre><code>## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>dfPol6 <span class="ot">&lt;-</span> <span class="fu">ldply</span>(runsPol6, data.frame)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(dfPol6[,<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 963</code></pre>
<p>Get results</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">HPDinterval</span>(<span class="fu">as.mcmc</span>(dfPol6))</span></code></pre></div>
<pre><code>##                 lower      upper
## estimateP1 0.45439180 11.9958349
## ts1        0.04128687  0.8167620
## ps1        0.43312728  0.9674088
## attr(,&quot;Probability&quot;)
## [1] 0.9501558</code></pre>
<p><span style="color: #04C799"><strong>Conclusion</strong></span>
<br/></p>
<p><strong>There’s no correlation between visible absorptivity and
polarisation at the species level.</strong></p>
<p><br> <br> <br></p>
</div>
<div id="nir-1" class="section level4">
<h4>NIR</h4>
<p style="color: #04C799">
<p><strong>Question</strong></p>
</p>
<p><strong>Is polarisation correlated with NIR
absorptivity?</strong></p>
<p style="color: #04C799">
<p><strong>Correlation</strong></p>
</p>
<p>Species level:</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(PolAbs<span class="sc">$</span>NIR, PolAbs<span class="sc">$</span>Pol) <span class="co"># by spp</span></span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  PolAbs$NIR and PolAbs$Pol
## t = 1.0748, df = 24, p-value = 0.2932
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.1887276  0.5555297
## sample estimates:
##       cor 
## 0.2142898</code></pre>
<p style="color: #04C799">
<p><strong>Linear model</strong></p>
</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>ModL2Abs <span class="ot">&lt;-</span> <span class="fu">lm</span>(PolAbs<span class="sc">$</span>NIR <span class="sc">~</span> PolAbs<span class="sc">$</span>Pol <span class="sc">+</span> PolAbs<span class="sc">$</span>VIS) <span class="co"># by spp</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ModL2Abs)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = PolAbs$NIR ~ PolAbs$Pol + PolAbs$VIS)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -14.1275  -4.5971   0.2726   4.3498  11.4918 
## 
## Coefficients:
##             Estimate Std. Error t value      Pr(&gt;|t|)    
## (Intercept)  -73.006     11.617  -6.285 0.00000206065 ***
## PolAbs$Pol    19.381      8.761   2.212        0.0372 *  
## PolAbs$VIS     1.345      0.145   9.274 0.00000000311 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 7.095 on 23 degrees of freedom
## Multiple R-squared:  0.7987, Adjusted R-squared:  0.7812 
## F-statistic: 45.62 on 2 and 23 DF,  p-value: 0.000000009877</code></pre>
<p style="color: #04C799">
<p><strong>PGLS</strong></p>
</p>
<p>The data frame of comparative data is the same as for visible
light</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>pglsPDNIRAbs <span class="ot">&lt;-</span> <span class="fu">pgls</span>(NIR <span class="sc">~</span> Pol <span class="sc">+</span> VIS,</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> CompDataAbs, <span class="at">param.CI =</span> <span class="fl">0.95</span>, <span class="at">lambda =</span> <span class="st">&quot;ML&quot;</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pglsPDNIRAbs)</span></code></pre></div>
<pre><code>## 
## Call:
## pgls(formula = NIR ~ Pol + VIS, data = CompDataAbs, lambda = &quot;ML&quot;, 
##     param.CI = 0.95)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.7269 -1.3667 -0.6236 -0.0045  2.7355 
## 
## Branch length transformations:
## 
## kappa  [Fix]  : 1.000
## lambda [ ML]  : 0.698
##    lower bound : 0.000, p = 0.047281
##    upper bound : 1.000, p = 0.09444
##    95.0% CI   : (0.024, NA)
## delta  [Fix]  : 1.000
## 
## Coefficients:
##              Estimate Std. Error t value        Pr(&gt;|t|)    
## (Intercept) -79.24713   11.51810 -6.8802 0.0000005146022 ***
## Pol          18.59591    9.55406  1.9464         0.06392 .  
## VIS           1.34625    0.13193 10.2041 0.0000000005214 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.878 on 23 degrees of freedom
## Multiple R-squared: 0.8256,  Adjusted R-squared: 0.8104 
## F-statistic: 54.42 on 2 and 23 DF,  p-value: 0.000000001902</code></pre>
<p style="color: #04C799">
<p><strong>PGLS multiple trees</strong></p>
</p>
<p>Dataset</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>PolAbs4 <span class="ot">&lt;-</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>    PolAbsRows <span class="sc">%&gt;%</span> <span class="co"># phylogeny names in rows</span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(Pol, VIS, NIR) <span class="sc">%&gt;%</span> </span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;Response&quot;</span> <span class="ot">=</span> NIR)</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>PolAbs4 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(PolAbs4)</span></code></pre></div>
<p>Apply</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>runsPol7 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(trees[trees_subset_min<span class="sc">:</span>trees_subset_max],</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>                   pgls_runH, <span class="at">model =</span> MuPGLSPol4, <span class="at">dataset =</span> PolAbs4)</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>dfPol7 <span class="ot">&lt;-</span> <span class="fu">ldply</span>(runsPol7, data.frame)</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(dfPol7[,<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 1001</code></pre>
<p>Get results</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">HPDinterval</span>(<span class="fu">as.mcmc</span>(dfPol7))</span></code></pre></div>
<pre><code>##                          lower              upper
## estimateP1 17.1499526859974480 21.154935391163267
## ts1         1.8199538150269474  2.345445447530623
## ps1         0.0263609336822412  0.079977595961537
## estimateP2  1.3184074324238098  1.360615900689254
## tP2         9.6488193841426106 10.803000242408297
## pP2         0.0000000001229536  0.000000001323613
## attr(,&quot;Probability&quot;)
## [1] 0.95005</code></pre>
</div>
<div id="frs-1" class="section level4">
<h4>FRS</h4>
<p style="color: #04C799">
<p><strong>Question</strong></p>
</p>
<p><strong>Is polarisation correlated with the NIR residuals corrected
by phylogeny?</strong></p>
<p style="color: #04C799">
<p><strong>Correlation</strong></p>
</p>
<p>Species level:</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(PolAbs<span class="sc">$</span>FRS, PolAbs<span class="sc">$</span>Pol) <span class="co"># by spp</span></span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  PolAbs$FRS and PolAbs$Pol
## t = 2.2597, df = 24, p-value = 0.03319
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.03759808 0.69366079
## sample estimates:
##     cor 
## 0.41885</code></pre>
<p style="color: #04C799">
<p><strong>Linear model</strong></p>
</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>ModL3Abs <span class="ot">&lt;-</span> <span class="fu">lm</span>(PolAbs<span class="sc">$</span>FRS <span class="sc">~</span> PolAbs<span class="sc">$</span>Pol) <span class="co"># by spp</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ModL3Abs)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = PolAbs$FRS ~ PolAbs$Pol)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -14.1317  -4.5898   0.3022   4.3367  11.4591 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)    5.061      1.630   3.105  0.00483 **
## PolAbs$Pol    19.379      8.576   2.260  0.03319 * 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 6.946 on 24 degrees of freedom
## Multiple R-squared:  0.1754, Adjusted R-squared:  0.1411 
## F-statistic: 5.106 on 1 and 24 DF,  p-value: 0.03319</code></pre>
<p style="color: #04C799">
<p><strong>PGLS</strong></p>
</p>
<p>The data frame of comparative data is the same as for visible
light</p>
<div class="sourceCode" id="cb100"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>pglsPDFRSAbs <span class="ot">&lt;-</span> <span class="fu">pgls</span>(FRS <span class="sc">~</span> Pol,</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> CompDataAbs, <span class="at">param.CI =</span> <span class="fl">0.95</span>, <span class="at">lambda =</span> <span class="st">&quot;ML&quot;</span></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pglsPDFRSAbs)</span></code></pre></div>
<pre><code>## 
## Call:
## pgls(formula = FRS ~ Pol, data = CompDataAbs, lambda = &quot;ML&quot;, 
##     param.CI = 0.95)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.7680 -1.5779 -0.6689  0.5747  3.1733 
## 
## Branch length transformations:
## 
## kappa  [Fix]  : 1.000
## lambda [ ML]  : 0.697
##    lower bound : 0.000, p = 0.047271
##    upper bound : 1.000, p = 0.087831
##    95.0% CI   : (0.024, NA)
## delta  [Fix]  : 1.000
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)  -1.0393     4.2966 -0.2419  0.81092  
## Pol          18.5950     9.3502  1.9887  0.05825 .
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.839 on 24 degrees of freedom
## Multiple R-squared: 0.1415,  Adjusted R-squared: 0.1057 
## F-statistic: 3.955 on 1 and 24 DF,  p-value: 0.05825</code></pre>
<p style="color: #04C799">
<p><strong>PGLS multiple trees</strong></p>
</p>
<p>Dataset</p>
<div class="sourceCode" id="cb102"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>PolAbs5 <span class="ot">&lt;-</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>    PolAbsRows <span class="sc">%&gt;%</span> <span class="co"># phylogeny names in rows</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(Pol, FRS) <span class="sc">%&gt;%</span> </span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;Response&quot;</span> <span class="ot">=</span> FRS)</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>PolAbs5 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(PolAbs5)</span></code></pre></div>
<p>Apply</p>
<div class="sourceCode" id="cb103"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>runsPol8 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(trees[trees_subset_min<span class="sc">:</span>trees_subset_max],</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>                   pgls_runA, <span class="at">model =</span> MuPGLSPol3, <span class="at">dataset =</span> PolAbs5)</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>dfPol8 <span class="ot">&lt;-</span> <span class="fu">ldply</span>(runsPol8, data.frame)</span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(dfPol8[,<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 1001</code></pre>
<p>Get results</p>
<div class="sourceCode" id="cb105"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">HPDinterval</span>(<span class="fu">as.mcmc</span>(dfPol8))</span></code></pre></div>
<pre><code>##                  lower       upper
## estimateP1 17.15984924 21.18197601
## ts1         1.85696827  2.39465696
## ps1         0.02383071  0.07389166
## attr(,&quot;Probability&quot;)
## [1] 0.95005</code></pre>
</div>
</div>
</div>
<div id="right-handed-pol" class="section level2">
<h2>Right handed Pol</h2>
<div id="reflectivity-1" class="section level3">
<h3>Reflectivity</h3>
<div id="vis-2" class="section level4">
<h4>VIS</h4>
<p style="color: #04C799">
<p><strong>Question</strong></p>
</p>
<p><strong>Can the darkness in the underlaying pigment affect the
visible reflectivity?</strong></p>
<p style="color: #04C799">
<p><strong>Correlation</strong></p>
</p>
<div class="sourceCode" id="cb107"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(RHandRefl<span class="sc">$</span>VIS, RHandRefl<span class="sc">$</span>Pol) <span class="co"># by spp</span></span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  RHandRefl$VIS and RHandRefl$Pol
## t = 4.5919, df = 45, p-value = 0.00003531
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.3314552 0.7331079
## sample estimates:
##       cor 
## 0.5648573</code></pre>
<p style="color: #04C799">
<p><strong>Linear model</strong></p>
</p>
<div class="sourceCode" id="cb109"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>ModL1RH <span class="ot">&lt;-</span> <span class="fu">lm</span>(RHandRefl<span class="sc">$</span>VIS <span class="sc">~</span> RHandRefl<span class="sc">$</span>Pol) <span class="co"># by spp</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ModL1RH)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = RHandRefl$VIS ~ RHandRefl$Pol)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -7.183 -3.552 -1.193  1.611 21.904 
## 
## Coefficients:
##               Estimate Std. Error t value  Pr(&gt;|t|)    
## (Intercept)     3.0506     2.5633   1.190      0.24    
## RHandRefl$Pol   2.4853     0.5412   4.592 0.0000353 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.563 on 45 degrees of freedom
## Multiple R-squared:  0.3191, Adjusted R-squared:  0.3039 
## F-statistic: 21.09 on 1 and 45 DF,  p-value: 0.00003531</code></pre>
<p style="color: #04C799">
<p><strong>PGLS</strong></p>
</p>
<p>Create the data frame of comparative data</p>
<div class="sourceCode" id="cb111"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>comp_dataRH <span class="ot">&lt;-</span> <span class="fu">comparative.data</span>(</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">phy =</span> MCCtree,</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> RHandRefl, <span class="co"># aggregated data without the spp in the row names</span></span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">names.col =</span> <span class="st">&quot;phylogeny_name&quot;</span>, <span class="co"># contains the column phylogeny name</span></span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">vcv =</span> <span class="cn">TRUE</span>,</span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.omit =</span> <span class="cn">FALSE</span>, <span class="at">warn.dropped =</span> <span class="cn">TRUE</span></span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Establish the model</p>
<div class="sourceCode" id="cb112"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>pglsPDVISRH <span class="ot">&lt;-</span> <span class="fu">pgls</span>(VIS <span class="sc">~</span> Pol,</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> comp_dataRH, <span class="at">param.CI =</span> <span class="fl">0.95</span>, <span class="at">lambda =</span> <span class="st">&quot;ML&quot;</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pglsPDVISRH)</span></code></pre></div>
<pre><code>## 
## Call:
## pgls(formula = VIS ~ Pol, data = comp_dataRH, lambda = &quot;ML&quot;, 
##     param.CI = 0.95)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.9302 -1.3884  0.0447  1.0418  7.0452 
## 
## Branch length transformations:
## 
## kappa  [Fix]  : 1.000
## lambda [ ML]  : 0.944
##    lower bound : 0.000, p = 0.0018141
##    upper bound : 1.000, p = 0.10278
##    95.0% CI   : (0.699, NA)
## delta  [Fix]  : 1.000
## 
## Coefficients:
##             Estimate Std. Error t value     Pr(&gt;|t|)    
## (Intercept)  2.71490    5.10664  0.5316       0.5976    
## Pol          2.48798    0.42974  5.7896 0.0000006404 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.007 on 45 degrees of freedom
## Multiple R-squared: 0.4269,  Adjusted R-squared: 0.4142 
## F-statistic: 33.52 on 1 and 45 DF,  p-value: 0.0000006404</code></pre>
<p style="color: #04C799">
<p><strong>PGLS multiple trees</strong></p>
</p>
<p>Function</p>
<p>Note that the function has to be modified for the predictors and data
frame that we are using</p>
<div class="sourceCode" id="cb114"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;Scripts/6_multiple_pgls_function_A.R&quot;</span>)) <span class="co"># script A is for Polarization as a response</span></span></code></pre></div>
<p>Model</p>
<div class="sourceCode" id="cb115"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>MuPGLSPol3 <span class="ot">&lt;-</span> Response <span class="sc">~</span> Pol</span></code></pre></div>
<p>Dataset</p>
<div class="sourceCode" id="cb116"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>RHandRefl3 <span class="ot">&lt;-</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>    RHandReflRows <span class="sc">%&gt;%</span> <span class="co"># phylogeny names in rows</span></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(Pol, VIS) <span class="sc">%&gt;%</span> </span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;Response&quot;</span> <span class="ot">=</span> VIS)</span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>RHandRefl3 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(RHandRefl3)</span></code></pre></div>
<p>Apply</p>
<div class="sourceCode" id="cb117"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>runsRHPol3 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(trees[trees_subset_min<span class="sc">:</span>trees_subset_max],</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>                   pgls_runA, <span class="at">model =</span> MuPGLSPol3, <span class="at">dataset =</span> RHandRefl3)</span></code></pre></div>
<pre><code>## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH</code></pre>
<div class="sourceCode" id="cb119"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>dfRHPol3 <span class="ot">&lt;-</span> <span class="fu">ldply</span>(runsRHPol3, data.frame)</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(dfRHPol3[,<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 992</code></pre>
<p>Get results</p>
<div class="sourceCode" id="cb121"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">HPDinterval</span>(<span class="fu">as.mcmc</span>(dfRHPol3))</span></code></pre></div>
<pre><code>##                       lower          upper
## estimateP1 2.32471130950857 2.675270900988
## ts1        5.32476946879407 6.392733318809
## ps1        0.00000001819721 0.000002109167
## attr(,&quot;Probability&quot;)
## [1] 0.9495968</code></pre>
<p><span style="color: #04C799"><strong>Conclusion</strong></span>
<br/></p>
<p><strong>PENDING.</strong></p>
<p><br> <br> <br></p>
</div>
<div id="nir-2" class="section level4">
<h4>NIR</h4>
<p style="color: #04C799">
<p><strong>Question</strong></p>
</p>
<p><strong>Can the darkness in the underlaying pigment affect the NIR
reflectivity?</strong></p>
<p style="color: #04C799">
<p><strong>Correlation</strong></p>
</p>
<p>Species level:</p>
<div class="sourceCode" id="cb123"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(RHandRefl<span class="sc">$</span>NIR, RHandRefl<span class="sc">$</span>Pol) <span class="co"># by spp</span></span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  RHandRefl$NIR and RHandRefl$Pol
## t = 4.8707, df = 45, p-value = 0.00001413
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.3613412 0.7484313
## sample estimates:
##       cor 
## 0.5875417</code></pre>
<p style="color: #04C799">
<p><strong>Linear model</strong></p>
</p>
<div class="sourceCode" id="cb125"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>ModL2RH <span class="ot">&lt;-</span> <span class="fu">lm</span>(RHandRefl<span class="sc">$</span>NIR <span class="sc">~</span> RHandRefl<span class="sc">$</span>Pol <span class="sc">+</span> RHandRefl<span class="sc">$</span>VIS) <span class="co"># by spp</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ModL2RH)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = RHandRefl$NIR ~ RHandRefl$Pol + RHandRefl$VIS)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -9.9226 -4.3421 -0.2965  2.4271 24.2257 
## 
## Coefficients:
##               Estimate Std. Error t value    Pr(&gt;|t|)    
## (Intercept)    20.1240     3.4000   5.919 0.000000444 ***
## RHandRefl$Pol   2.1381     0.8566   2.496    0.016379 *  
## RHandRefl$VIS   0.6956     0.1947   3.573    0.000871 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 7.266 on 44 degrees of freedom
## Multiple R-squared:  0.4925, Adjusted R-squared:  0.4694 
## F-statistic: 21.35 on 2 and 44 DF,  p-value: 0.0000003315</code></pre>
<p style="color: #04C799">
<p><strong>PGLS</strong></p>
</p>
<p>The data frame of comparative data is the same as for visible
light</p>
<div class="sourceCode" id="cb127"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>pglsPDNIRRH <span class="ot">&lt;-</span> <span class="fu">pgls</span>(NIR <span class="sc">~</span> Pol <span class="sc">+</span> VIS,</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> comp_dataRH, <span class="at">param.CI =</span> <span class="fl">0.95</span>, <span class="at">lambda =</span> <span class="st">&quot;ML&quot;</span></span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pglsPDNIRRH)</span></code></pre></div>
<pre><code>## 
## Call:
## pgls(formula = NIR ~ Pol + VIS, data = comp_dataRH, lambda = &quot;ML&quot;, 
##     param.CI = 0.95)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.6657 -1.1529  0.1889  1.2255  6.5501 
## 
## Branch length transformations:
## 
## kappa  [Fix]  : 1.000
## lambda [ ML]  : 0.827
##    lower bound : 0.000, p = 0.00854
##    upper bound : 1.000, p = 0.10273
##    95.0% CI   : (0.340, NA)
## delta  [Fix]  : 1.000
## 
## Coefficients:
##             Estimate Std. Error t value   Pr(&gt;|t|)    
## (Intercept) 26.50712    5.84639  4.5339 0.00004418 ***
## Pol          1.97254    0.80127  2.4618  0.0178146 *  
## VIS          0.73731    0.19706  3.7416  0.0005261 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.286 on 44 degrees of freedom
## Multiple R-squared: 0.548,   Adjusted R-squared: 0.5274 
## F-statistic: 26.67 on 2 and 44 DF,  p-value: 0.00000002592</code></pre>
<p style="color: #04C799">
<p><strong>PGLS multiple trees</strong></p>
</p>
<p>Function</p>
<p>Note that the function has to be modified for the predictors and data
frame that we are using</p>
<div class="sourceCode" id="cb129"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;Scripts/13_multiple_pgls_function_H.R&quot;</span>)) <span class="co"># script A is for Polarization as a response</span></span></code></pre></div>
<p>Model</p>
<div class="sourceCode" id="cb130"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>MuPGLSPol4 <span class="ot">&lt;-</span> Response <span class="sc">~</span> Pol <span class="sc">+</span> VIS</span></code></pre></div>
<p>Dataset</p>
<div class="sourceCode" id="cb131"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>RHandRefl4 <span class="ot">&lt;-</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>    RHandReflRows <span class="sc">%&gt;%</span> <span class="co"># phylogeny names in rows</span></span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(Pol, VIS, NIR) <span class="sc">%&gt;%</span> </span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;Response&quot;</span> <span class="ot">=</span> NIR)</span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a>RHandRefl4 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(RHandRefl4)</span></code></pre></div>
<p>Apply</p>
<div class="sourceCode" id="cb132"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>runsRHPol4 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(trees[trees_subset_min<span class="sc">:</span>trees_subset_max],</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>                   pgls_runH, <span class="at">model =</span> MuPGLSPol4, <span class="at">dataset =</span> RHandRefl4)</span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>dfRHPol4 <span class="ot">&lt;-</span> <span class="fu">ldply</span>(runsRHPol4, data.frame)</span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(dfRHPol4[,<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 1001</code></pre>
<p>Get results</p>
<div class="sourceCode" id="cb134"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">HPDinterval</span>(<span class="fu">as.mcmc</span>(dfRHPol4))</span></code></pre></div>
<pre><code>##                     lower       upper
## estimateP1 1.568982596475 2.343066714
## ts1        2.227658400835 2.925192813
## ps1        0.004720836798 0.028982730
## estimateP2 0.662245251570 0.813247260
## tP2        3.317189090327 4.402433444
## pP2        0.000006930049 0.001525176
## attr(,&quot;Probability&quot;)
## [1] 0.95005</code></pre>
</div>
<div id="frs-2" class="section level4">
<h4>FRS</h4>
<p style="color: #04C799">
<p><strong>Question</strong></p>
</p>
<p><strong>Can the darkness in the underlaying pigment affect the NIR
reflectivity?</strong></p>
<p style="color: #04C799">
<p><strong>Correlation</strong></p>
</p>
<p>Species level:</p>
<div class="sourceCode" id="cb136"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(RHandRefl<span class="sc">$</span>FRS, RHandRefl<span class="sc">$</span>Pol) <span class="co"># by spp</span></span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  RHandRefl$FRS and RHandRefl$Pol
## t = 1.7038, df = 45, p-value = 0.09531
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.04410901  0.49812836
## sample estimates:
##      cor 
## 0.246176</code></pre>
<p style="color: #04C799">
<p><strong>Linear model</strong></p>
</p>
<div class="sourceCode" id="cb138"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>ModL3RH <span class="ot">&lt;-</span> <span class="fu">lm</span>(RHandRefl<span class="sc">$</span>FRS <span class="sc">~</span> RHandRefl<span class="sc">$</span>Pol) <span class="co"># by spp</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ModL3RH)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = RHandRefl$FRS ~ RHandRefl$Pol)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -10.3853  -5.1370  -0.4918   3.1890  26.0037 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)    -11.366      3.438  -3.306  0.00187 **
## RHandRefl$Pol    1.237      0.726   1.704  0.09531 . 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 7.462 on 45 degrees of freedom
## Multiple R-squared:  0.0606, Adjusted R-squared:  0.03973 
## F-statistic: 2.903 on 1 and 45 DF,  p-value: 0.09531</code></pre>
<p style="color: #04C799">
<p><strong>PGLS</strong></p>
</p>
<p>The data frame of comparative data is the same as for visible
light</p>
<div class="sourceCode" id="cb140"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>pglsPDFRSRH <span class="ot">&lt;-</span> <span class="fu">pgls</span>(FRS <span class="sc">~</span> Pol,</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> comp_dataRH, <span class="at">param.CI =</span> <span class="fl">0.95</span>, <span class="at">lambda =</span> <span class="st">&quot;ML&quot;</span></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pglsPDFRSRH)</span></code></pre></div>
<pre><code>## 
## Call:
## pgls(formula = FRS ~ Pol, data = comp_dataRH, lambda = &quot;ML&quot;, 
##     param.CI = 0.95)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -5.1780 -0.9604 -0.0604  1.1057  8.1284 
## 
## Branch length transformations:
## 
## kappa  [Fix]  : 1.000
## lambda [ ML]  : 0.875
##    lower bound : 0.000, p = 0.005182
##    upper bound : 1.000, p = 0.2351
##    95.0% CI   : (0.400, NA)
## delta  [Fix]  : 1.000
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept) -4.26850    6.28085 -0.6796  0.50024  
## Pol          1.09243    0.61722  1.7699  0.08352 .
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.464 on 45 degrees of freedom
## Multiple R-squared: 0.06508, Adjusted R-squared: 0.04431 
## F-statistic: 3.133 on 1 and 45 DF,  p-value: 0.08352</code></pre>
<p style="color: #04C799">
<p><strong>PGLS multiple trees</strong></p>
</p>
<p>Dataset</p>
<div class="sourceCode" id="cb142"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>RHandRefl5 <span class="ot">&lt;-</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>    RHandReflRows <span class="sc">%&gt;%</span> <span class="co"># phylogeny names in rows</span></span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(Pol, FRS) <span class="sc">%&gt;%</span> </span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;Response&quot;</span> <span class="ot">=</span> FRS)</span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a>RHandRefl5 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(RHandRefl5)</span></code></pre></div>
<p>Apply</p>
<div class="sourceCode" id="cb143"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>runsRHPol5 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(trees[trees_subset_min<span class="sc">:</span>trees_subset_max],</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>                   pgls_runA, <span class="at">model =</span> MuPGLSPol3, <span class="at">dataset =</span> RHandRefl5)</span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>dfRHPol5 <span class="ot">&lt;-</span> <span class="fu">ldply</span>(runsRHPol5, data.frame)</span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(dfRHPol5[,<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 1001</code></pre>
<p>Get results</p>
<div class="sourceCode" id="cb145"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">HPDinterval</span>(<span class="fu">as.mcmc</span>(dfRHPol5))</span></code></pre></div>
<pre><code>##                 lower     upper
## estimateP1 0.86062030 1.3845539
## ts1        1.50152500 2.3154223
## ps1        0.02085044 0.1321538
## attr(,&quot;Probability&quot;)
## [1] 0.95005</code></pre>
</div>
</div>
<div id="absorptivity-1" class="section level3">
<h3>Absorptivity</h3>
<div id="vis-3" class="section level4">
<h4>VIS</h4>
<p style="color: #04C799">
<p><strong>Question</strong></p>
</p>
<p><strong>Can polarisation predict visible absorptivity?</strong></p>
<p style="color: #04C799">
<p><strong>Correlation</strong></p>
</p>
<div class="sourceCode" id="cb147"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(RHandAbs<span class="sc">$</span>VIS, RHandAbs<span class="sc">$</span>Pol) <span class="co"># by spp</span></span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  RHandAbs$VIS and RHandAbs$Pol
## t = -0.82271, df = 24, p-value = 0.4188
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.5196329  0.2369354
## sample estimates:
##        cor 
## -0.1656164</code></pre>
<p style="color: #04C799">
<p><strong>Linear model</strong></p>
</p>
<div class="sourceCode" id="cb149"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>ModL1AbsRH <span class="ot">&lt;-</span> <span class="fu">lm</span>(RHandAbs<span class="sc">$</span>VIS <span class="sc">~</span> RHandAbs<span class="sc">$</span>Pol) <span class="co"># by spp</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ModL1AbsRH)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = RHandAbs$VIS ~ RHandAbs$Pol)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -23.7907  -5.6429   0.3487   7.6899  13.0918 
## 
## Coefficients:
##              Estimate Std. Error t value          Pr(&gt;|t|)    
## (Intercept)    83.909      5.863  14.312 0.000000000000301 ***
## RHandAbs$Pol   -1.110      1.349  -0.823             0.419    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 9.852 on 24 degrees of freedom
## Multiple R-squared:  0.02743,    Adjusted R-squared:  -0.0131 
## F-statistic: 0.6769 on 1 and 24 DF,  p-value: 0.4188</code></pre>
<p style="color: #04C799">
<p><strong>PGLS</strong></p>
</p>
<p>Create the data frame of comparative data</p>
<div class="sourceCode" id="cb151"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>CompDataAbsRH <span class="ot">&lt;-</span> <span class="fu">comparative.data</span>(</span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">phy =</span> MCCtreeAbs,</span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> RHandAbs, <span class="co"># aggregated data without the spp in the row names</span></span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">names.col =</span> <span class="st">&quot;phylogeny_name&quot;</span>, <span class="co"># contains the column phylogeny name</span></span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">vcv =</span> <span class="cn">TRUE</span>,</span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.omit =</span> <span class="cn">FALSE</span>, <span class="at">warn.dropped =</span> <span class="cn">TRUE</span></span>
<span id="cb151-7"><a href="#cb151-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Establish the model</p>
<div class="sourceCode" id="cb152"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>pglsPDVISAbsRH <span class="ot">&lt;-</span> <span class="fu">pgls</span>(VIS <span class="sc">~</span> Pol,</span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> CompDataAbsRH, <span class="at">param.CI =</span> <span class="fl">0.95</span>, <span class="at">lambda =</span> <span class="st">&quot;ML&quot;</span></span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-5"><a href="#cb152-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pglsPDVISAbsRH)</span></code></pre></div>
<pre><code>## 
## Call:
## pgls(formula = VIS ~ Pol, data = CompDataAbsRH, lambda = &quot;ML&quot;, 
##     param.CI = 0.95)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -6.636 -1.330  1.265  2.925 10.437 
## 
## Branch length transformations:
## 
## kappa  [Fix]  : 1.000
## lambda [ ML]  : 0.958
##    lower bound : 0.000, p = 0.52354
##    upper bound : 1.000, p = 0.34748
##    95.0% CI   : (NA, NA)
## delta  [Fix]  : 1.000
## 
## Coefficients:
##             Estimate Std. Error t value     Pr(&gt;|t|)    
## (Intercept) 83.17557    9.94708  8.3618 0.0000000143 ***
## Pol         -0.52023    1.18225 -0.4400       0.6638    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.619 on 24 degrees of freedom
## Multiple R-squared: 0.008003,    Adjusted R-squared: -0.03333 
## F-statistic: 0.1936 on 1 and 24 DF,  p-value: 0.6638</code></pre>
<p style="color: #04C799">
<p><strong>PGLS multiple trees</strong></p>
</p>
<p>Dataset</p>
<div class="sourceCode" id="cb154"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>RHandAbs3 <span class="ot">&lt;-</span></span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>    RHandAbsRows <span class="sc">%&gt;%</span> <span class="co"># phylogeny names in rows</span></span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(Pol, VIS) <span class="sc">%&gt;%</span> </span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;Response&quot;</span> <span class="ot">=</span> VIS)</span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a>RHandAbs3 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(RHandAbs3)</span></code></pre></div>
<p>Apply</p>
<div class="sourceCode" id="cb155"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>runsRHPol6 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(trees[trees_subset_min<span class="sc">:</span>trees_subset_max],</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>                   pgls_runA, <span class="at">model =</span> MuPGLSPol3, <span class="at">dataset =</span> RHandAbs3)</span></code></pre></div>
<pre><code>## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH</code></pre>
<div class="sourceCode" id="cb157"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a>dfRHPol6 <span class="ot">&lt;-</span> <span class="fu">ldply</span>(runsRHPol6, data.frame)</span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(dfRHPol6[,<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 971</code></pre>
<p>Get results</p>
<div class="sourceCode" id="cb159"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">HPDinterval</span>(<span class="fu">as.mcmc</span>(dfRHPol6))</span></code></pre></div>
<pre><code>##                 lower       upper
## estimateP1 -1.1101595 -0.09741585
## ts1        -0.8227129 -0.08824638
## ps1         0.4187710  0.91363493
## attr(,&quot;Probability&quot;)
## [1] 0.9495366</code></pre>
<p><span style="color: #04C799"><strong>Conclusion</strong></span>
<br/></p>
<p><strong>There’s no correlation between visible absorptivity and
polarisation at the species level.</strong></p>
<p><br> <br> <br></p>
</div>
<div id="nir-3" class="section level4">
<h4>NIR</h4>
<p style="color: #04C799">
<p><strong>Question</strong></p>
</p>
<p><strong>Is polarisation correlated with NIR
absorptivity?</strong></p>
<p style="color: #04C799">
<p><strong>Correlation</strong></p>
</p>
<p>Species level:</p>
<div class="sourceCode" id="cb161"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(RHandAbs<span class="sc">$</span>NIR, RHandAbs<span class="sc">$</span>Pol) <span class="co"># by spp</span></span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  RHandAbs$NIR and RHandAbs$Pol
## t = -0.47705, df = 24, p-value = 0.6376
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.4667489  0.3017610
## sample estimates:
##         cor 
## -0.09691968</code></pre>
<p style="color: #04C799">
<p><strong>Linear model</strong></p>
</p>
<div class="sourceCode" id="cb163"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>ModL2AbsRH <span class="ot">&lt;-</span> <span class="fu">lm</span>(RHandAbs<span class="sc">$</span>NIR <span class="sc">~</span> RHandAbs<span class="sc">$</span>Pol <span class="sc">+</span> RHandAbs<span class="sc">$</span>VIS) <span class="co"># by spp</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ModL2AbsRH)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = RHandAbs$NIR ~ RHandAbs$Pol + RHandAbs$VIS)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -17.142  -4.009   1.767   4.109  16.372 
## 
## Coefficients:
##              Estimate Std. Error t value    Pr(&gt;|t|)    
## (Intercept)  -74.2454    14.2904  -5.195 0.000028762 ***
## RHandAbs$Pol   0.5027     1.0801   0.465       0.646    
## RHandAbs$VIS   1.3596     0.1611   8.438 0.000000017 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 7.777 on 23 degrees of freedom
## Multiple R-squared:  0.7581, Adjusted R-squared:  0.7371 
## F-statistic: 36.04 on 2 and 23 DF,  p-value: 0.00000008153</code></pre>
<p style="color: #04C799">
<p><strong>PGLS</strong></p>
</p>
<p>The data frame of comparative data is the same as for visible
light</p>
<div class="sourceCode" id="cb165"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>pglsPDNIRAbsRH <span class="ot">&lt;-</span> <span class="fu">pgls</span>(NIR <span class="sc">~</span> Pol <span class="sc">+</span> VIS,</span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> CompDataAbsRH, <span class="at">param.CI =</span> <span class="fl">0.95</span>, <span class="at">lambda =</span> <span class="st">&quot;ML&quot;</span></span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pglsPDNIRAbsRH)</span></code></pre></div>
<pre><code>## 
## Call:
## pgls(formula = NIR ~ Pol + VIS, data = CompDataAbsRH, lambda = &quot;ML&quot;, 
##     param.CI = 0.95)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.4294 -2.3680 -1.3293  0.3516  2.9541 
## 
## Branch length transformations:
## 
## kappa  [Fix]  : 1.000
## lambda [ ML]  : 0.882
##    lower bound : 0.000, p = 0.019671
##    upper bound : 1.000, p = 0.46582
##    95.0% CI   : (0.239, NA)
## delta  [Fix]  : 1.000
## 
## Coefficients:
##              Estimate Std. Error t value       Pr(&gt;|t|)    
## (Intercept) -81.03156   13.82652 -5.8606 0.000005671739 ***
## Pol           0.51156    0.89074  0.5743         0.5713    
## VIS           1.35538    0.14503  9.3458 0.000000002697 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.342 on 23 degrees of freedom
## Multiple R-squared: 0.7922,  Adjusted R-squared: 0.7741 
## F-statistic: 43.85 on 2 and 23 DF,  p-value: 0.00000001421</code></pre>
<p style="color: #04C799">
<p><strong>PGLS multiple trees</strong></p>
</p>
<p>Dataset</p>
<div class="sourceCode" id="cb167"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a>RHandAbs4 <span class="ot">&lt;-</span></span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>    RHandAbsRows <span class="sc">%&gt;%</span> <span class="co"># phylogeny names in rows</span></span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(Pol, VIS, NIR) <span class="sc">%&gt;%</span> </span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;Response&quot;</span> <span class="ot">=</span> NIR)</span>
<span id="cb167-5"><a href="#cb167-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-6"><a href="#cb167-6" aria-hidden="true" tabindex="-1"></a>RHandAbs4 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(RHandAbs4)</span></code></pre></div>
<p>Apply</p>
<div class="sourceCode" id="cb168"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>runsRHPol7 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(trees[trees_subset_min<span class="sc">:</span>trees_subset_max],</span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a>                   pgls_runH, <span class="at">model =</span> MuPGLSPol4, <span class="at">dataset =</span> RHandAbs4)</span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a>dfRHPol7 <span class="ot">&lt;-</span> <span class="fu">ldply</span>(runsRHPol7, data.frame)</span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-6"><a href="#cb168-6" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(dfRHPol7[,<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 1001</code></pre>
<p>Get results</p>
<div class="sourceCode" id="cb170"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="fu">HPDinterval</span>(<span class="fu">as.mcmc</span>(dfRHPol7))</span></code></pre></div>
<pre><code>##                        lower              upper
## estimateP1 0.173351686790757  0.706918816313237
## ts1        0.174959664134327  0.885683520350157
## ps1        0.384954689714818  0.862642397828346
## estimateP2 1.309132205945973  1.376597122439301
## tP2        8.654408621330273 10.025365076043126
## pP2        0.000000000393297  0.000000008174573
## attr(,&quot;Probability&quot;)
## [1] 0.95005</code></pre>
</div>
<div id="frs-3" class="section level4">
<h4>FRS</h4>
<p style="color: #04C799">
<p><strong>Question</strong></p>
</p>
<p><strong>Is polarisation correlated with the NIR residuals corrected
by phylogeny?</strong></p>
<p style="color: #04C799">
<p><strong>Correlation</strong></p>
</p>
<p>Species level:</p>
<div class="sourceCode" id="cb172"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(RHandAbs<span class="sc">$</span>FRS, RHandAbs<span class="sc">$</span>Pol) <span class="co"># by spp</span></span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  RHandAbs$FRS and RHandAbs$Pol
## t = 0.46896, df = 24, p-value = 0.6433
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.3032555  0.4654613
## sample estimates:
##        cor 
## 0.09528982</code></pre>
<p style="color: #04C799">
<p><strong>Linear model</strong></p>
</p>
<div class="sourceCode" id="cb174"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a>ModL3AbsRH <span class="ot">&lt;-</span> <span class="fu">lm</span>(RHandAbs<span class="sc">$</span>FRS <span class="sc">~</span> RHandAbs<span class="sc">$</span>Pol) <span class="co"># by spp</span></span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ModL3AbsRH)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = RHandAbs$FRS ~ RHandAbs$Pol)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -17.128  -4.098   1.842   4.087  16.505 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)    5.0768     4.5312   1.120    0.274
## RHandAbs$Pol   0.4891     1.0429   0.469    0.643
## 
## Residual standard error: 7.614 on 24 degrees of freedom
## Multiple R-squared:  0.00908,    Adjusted R-squared:  -0.03221 
## F-statistic: 0.2199 on 1 and 24 DF,  p-value: 0.6433</code></pre>
<p style="color: #04C799">
<p><strong>PGLS</strong></p>
</p>
<p>The data frame of comparative data is the same as for visible
light</p>
<div class="sourceCode" id="cb176"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>pglsPDFRSAbsRH <span class="ot">&lt;-</span> <span class="fu">pgls</span>(FRS <span class="sc">~</span> Pol,</span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> CompDataAbsRH, <span class="at">param.CI =</span> <span class="fl">0.95</span>, <span class="at">lambda =</span> <span class="st">&quot;ML&quot;</span></span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb176-4"><a href="#cb176-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-5"><a href="#cb176-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pglsPDFRSAbsRH)</span></code></pre></div>
<pre><code>## 
## Call:
## pgls(formula = FRS ~ Pol, data = CompDataAbsRH, lambda = &quot;ML&quot;, 
##     param.CI = 0.95)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.2491 -2.3854 -0.7869  0.8745  3.9450 
## 
## Branch length transformations:
## 
## kappa  [Fix]  : 1.000
## lambda [ ML]  : 0.883
##    lower bound : 0.000, p = 0.019636
##    upper bound : 1.000, p = 0.45962
##    95.0% CI   : (0.239, NA)
## delta  [Fix]  : 1.000
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept) -2.07307    6.41864 -0.3230   0.7495
## Pol          0.50711    0.86494  0.5863   0.5631
## 
## Residual standard error: 2.296 on 24 degrees of freedom
## Multiple R-squared: 0.01412, Adjusted R-squared: -0.02696 
## F-statistic: 0.3437 on 1 and 24 DF,  p-value: 0.5631</code></pre>
<p style="color: #04C799">
<p><strong>PGLS multiple trees</strong></p>
</p>
<p>Dataset</p>
<div class="sourceCode" id="cb178"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a>RHandAbs5 <span class="ot">&lt;-</span></span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a>    RHandAbsRows <span class="sc">%&gt;%</span> <span class="co"># phylogeny names in rows</span></span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(Pol, FRS) <span class="sc">%&gt;%</span> </span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;Response&quot;</span> <span class="ot">=</span> FRS)</span>
<span id="cb178-5"><a href="#cb178-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-6"><a href="#cb178-6" aria-hidden="true" tabindex="-1"></a>RHandAbs5 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(RHandAbs5)</span></code></pre></div>
<p>Apply</p>
<div class="sourceCode" id="cb179"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a>runsRHPol8 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(trees[trees_subset_min<span class="sc">:</span>trees_subset_max],</span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a>                   pgls_runA, <span class="at">model =</span> MuPGLSPol3, <span class="at">dataset =</span> RHandAbs5)</span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-4"><a href="#cb179-4" aria-hidden="true" tabindex="-1"></a>dfRHPol8 <span class="ot">&lt;-</span> <span class="fu">ldply</span>(runsRHPol8, data.frame)</span>
<span id="cb179-5"><a href="#cb179-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-6"><a href="#cb179-6" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(dfRHPol8[,<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 1001</code></pre>
<p>Get results</p>
<div class="sourceCode" id="cb181"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="fu">HPDinterval</span>(<span class="fu">as.mcmc</span>(dfRHPol8))</span></code></pre></div>
<pre><code>##                lower     upper
## estimateP1 0.1747109 0.6713303
## ts1        0.1923224 0.8844235
## ps1        0.3841219 0.8476692
## attr(,&quot;Probability&quot;)
## [1] 0.95005</code></pre>
</div>
</div>
</div>
</div>
<div id="mechanisms" class="section level1">
<h1>Mechanisms</h1>
<p>We tested the correlations between optical properties,
i.e. reflectivity and absorptivity, and polarisation in different
subsets of species since these correlations may depend on the
underlaying mechanisms.</p>
<div id="subsets" class="section level2">
<h2>Subsets</h2>
<p>We will compare three scenarios: 1) all species included 2) excluding
the species with a white underlay since they clearly have a different
mechanism that doe snot involve polarisation. 3) some species may be
combining additional structures or disorder with chiral structures. This
would change the correlations between polarisation and reflectivity,
thus in this scenario we also exclude these cases (clustering apart from
the other species).</p>
<p>Subset no underlay:</p>
<div class="sourceCode" id="cb183"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="co"># reflectivity</span></span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a>NoUnderlayRefl <span class="ot">&lt;-</span></span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a>  PolRefl <span class="sc">%&gt;%</span></span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(phylogeny_name <span class="sc">!=</span> <span class="st">&quot;Paraschizognathus_ocularis&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb183-5"><a href="#cb183-5" aria-hidden="true" tabindex="-1"></a>    phylogeny_name <span class="sc">!=</span> <span class="st">&quot;Paraschizognathus_prasinus&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb183-6"><a href="#cb183-6" aria-hidden="true" tabindex="-1"></a>    phylogeny_name <span class="sc">!=</span> <span class="st">&quot;Paraschizognathus_olivaceous&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb183-7"><a href="#cb183-7" aria-hidden="true" tabindex="-1"></a>    phylogeny_name <span class="sc">!=</span> <span class="st">&quot;Anoplognathus_prasinus&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb183-8"><a href="#cb183-8" aria-hidden="true" tabindex="-1"></a>    phylogeny_name <span class="sc">!=</span> <span class="st">&quot;Xylonichus_sp&quot;</span>)</span>
<span id="cb183-9"><a href="#cb183-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-10"><a href="#cb183-10" aria-hidden="true" tabindex="-1"></a><span class="co"># absorptivity</span></span>
<span id="cb183-11"><a href="#cb183-11" aria-hidden="true" tabindex="-1"></a>NoUnderlayAbs <span class="ot">&lt;-</span></span>
<span id="cb183-12"><a href="#cb183-12" aria-hidden="true" tabindex="-1"></a>  PolAbs <span class="sc">%&gt;%</span></span>
<span id="cb183-13"><a href="#cb183-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(phylogeny_name <span class="sc">!=</span> <span class="st">&quot;Paraschizognathus_ocularis&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb183-14"><a href="#cb183-14" aria-hidden="true" tabindex="-1"></a>    phylogeny_name <span class="sc">!=</span> <span class="st">&quot;Paraschizognathus_prasinus&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb183-15"><a href="#cb183-15" aria-hidden="true" tabindex="-1"></a>    phylogeny_name <span class="sc">!=</span> <span class="st">&quot;Paraschizognathus_olivaceous&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb183-16"><a href="#cb183-16" aria-hidden="true" tabindex="-1"></a>    phylogeny_name <span class="sc">!=</span> <span class="st">&quot;Anoplognathus_prasinus&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb183-17"><a href="#cb183-17" aria-hidden="true" tabindex="-1"></a>    phylogeny_name <span class="sc">!=</span> <span class="st">&quot;Xylonichus_sp&quot;</span>)</span></code></pre></div>
<p>Subset no special cases:</p>
<div class="sourceCode" id="cb184"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="co"># reflectivity</span></span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a>NoSpecialCasesRefl <span class="ot">&lt;-</span></span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a>  PolRefl <span class="sc">%&gt;%</span></span>
<span id="cb184-4"><a href="#cb184-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(phylogeny_name <span class="sc">!=</span> <span class="st">&quot;Paraschizognathus_ocularis&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb184-5"><a href="#cb184-5" aria-hidden="true" tabindex="-1"></a>    phylogeny_name <span class="sc">!=</span> <span class="st">&quot;Paraschizognathus_prasinus&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb184-6"><a href="#cb184-6" aria-hidden="true" tabindex="-1"></a>    phylogeny_name <span class="sc">!=</span> <span class="st">&quot;Paraschizognathus_olivaceous&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb184-7"><a href="#cb184-7" aria-hidden="true" tabindex="-1"></a>    phylogeny_name <span class="sc">!=</span> <span class="st">&quot;Anoplognathus_prasinus&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb184-8"><a href="#cb184-8" aria-hidden="true" tabindex="-1"></a>    phylogeny_name <span class="sc">!=</span> <span class="st">&quot;Xylonichus_sp&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb184-9"><a href="#cb184-9" aria-hidden="true" tabindex="-1"></a>    phylogeny_name <span class="sc">!=</span> <span class="st">&quot;Epichrysus_lamprimoides&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb184-10"><a href="#cb184-10" aria-hidden="true" tabindex="-1"></a>    phylogeny_name <span class="sc">!=</span> <span class="st">&quot;Anoplostethus_laetus&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb184-11"><a href="#cb184-11" aria-hidden="true" tabindex="-1"></a>    phylogeny_name <span class="sc">!=</span> <span class="st">&quot;Anoplostethus_opalinus&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb184-12"><a href="#cb184-12" aria-hidden="true" tabindex="-1"></a>    phylogeny_name <span class="sc">!=</span> <span class="st">&quot;Anoplostethus_roseus&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb184-13"><a href="#cb184-13" aria-hidden="true" tabindex="-1"></a>    phylogeny_name <span class="sc">!=</span> <span class="st">&quot;Anoplognathus_parvulus&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb184-14"><a href="#cb184-14" aria-hidden="true" tabindex="-1"></a>    phylogeny_name <span class="sc">!=</span> <span class="st">&quot;Anoplognathus_aureus&quot;</span>)</span>
<span id="cb184-15"><a href="#cb184-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-16"><a href="#cb184-16" aria-hidden="true" tabindex="-1"></a><span class="co"># absorptivity</span></span>
<span id="cb184-17"><a href="#cb184-17" aria-hidden="true" tabindex="-1"></a>NoSpecialCasesAbs <span class="ot">&lt;-</span></span>
<span id="cb184-18"><a href="#cb184-18" aria-hidden="true" tabindex="-1"></a>  PolAbs <span class="sc">%&gt;%</span></span>
<span id="cb184-19"><a href="#cb184-19" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(phylogeny_name <span class="sc">!=</span> <span class="st">&quot;Paraschizognathus_ocularis&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb184-20"><a href="#cb184-20" aria-hidden="true" tabindex="-1"></a>    phylogeny_name <span class="sc">!=</span> <span class="st">&quot;Paraschizognathus_prasinus&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb184-21"><a href="#cb184-21" aria-hidden="true" tabindex="-1"></a>    phylogeny_name <span class="sc">!=</span> <span class="st">&quot;Paraschizognathus_olivaceous&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb184-22"><a href="#cb184-22" aria-hidden="true" tabindex="-1"></a>    phylogeny_name <span class="sc">!=</span> <span class="st">&quot;Anoplognathus_prasinus&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb184-23"><a href="#cb184-23" aria-hidden="true" tabindex="-1"></a>    phylogeny_name <span class="sc">!=</span> <span class="st">&quot;Xylonichus_sp&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb184-24"><a href="#cb184-24" aria-hidden="true" tabindex="-1"></a>    phylogeny_name <span class="sc">!=</span> <span class="st">&quot;Epichrysus_lamprimoides&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb184-25"><a href="#cb184-25" aria-hidden="true" tabindex="-1"></a>    phylogeny_name <span class="sc">!=</span> <span class="st">&quot;Anoplostethus_laetus&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb184-26"><a href="#cb184-26" aria-hidden="true" tabindex="-1"></a>    phylogeny_name <span class="sc">!=</span> <span class="st">&quot;Anoplostethus_opalinus&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb184-27"><a href="#cb184-27" aria-hidden="true" tabindex="-1"></a>    phylogeny_name <span class="sc">!=</span> <span class="st">&quot;Anoplostethus_roseus&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb184-28"><a href="#cb184-28" aria-hidden="true" tabindex="-1"></a>    phylogeny_name <span class="sc">!=</span> <span class="st">&quot;Anoplognathus_parvulus&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb184-29"><a href="#cb184-29" aria-hidden="true" tabindex="-1"></a>    phylogeny_name <span class="sc">!=</span> <span class="st">&quot;Anoplognathus_aureus&quot;</span>)</span></code></pre></div>
<p>Subset no chiral composites:</p>
<div class="sourceCode" id="cb185"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="co"># reflectivity</span></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a>NoCCRefl <span class="ot">&lt;-</span></span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a>  PolRefl <span class="sc">%&gt;%</span></span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(phylogeny_name <span class="sc">!=</span> <span class="st">&quot;Epichrysus_lamprimoides&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb185-5"><a href="#cb185-5" aria-hidden="true" tabindex="-1"></a>    phylogeny_name <span class="sc">!=</span> <span class="st">&quot;Anoplostethus_laetus&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb185-6"><a href="#cb185-6" aria-hidden="true" tabindex="-1"></a>    phylogeny_name <span class="sc">!=</span> <span class="st">&quot;Anoplostethus_opalinus&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb185-7"><a href="#cb185-7" aria-hidden="true" tabindex="-1"></a>    phylogeny_name <span class="sc">!=</span> <span class="st">&quot;Anoplostethus_roseus&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb185-8"><a href="#cb185-8" aria-hidden="true" tabindex="-1"></a>    phylogeny_name <span class="sc">!=</span> <span class="st">&quot;Anoplognathus_parvulus&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb185-9"><a href="#cb185-9" aria-hidden="true" tabindex="-1"></a>    phylogeny_name <span class="sc">!=</span> <span class="st">&quot;Anoplognathus_aureus&quot;</span>)</span>
<span id="cb185-10"><a href="#cb185-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-11"><a href="#cb185-11" aria-hidden="true" tabindex="-1"></a><span class="co"># absorptivity</span></span>
<span id="cb185-12"><a href="#cb185-12" aria-hidden="true" tabindex="-1"></a>NoCCAbs <span class="ot">&lt;-</span></span>
<span id="cb185-13"><a href="#cb185-13" aria-hidden="true" tabindex="-1"></a>  PolAbs <span class="sc">%&gt;%</span></span>
<span id="cb185-14"><a href="#cb185-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(phylogeny_name <span class="sc">!=</span> <span class="st">&quot;Epichrysus_lamprimoides&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb185-15"><a href="#cb185-15" aria-hidden="true" tabindex="-1"></a>    phylogeny_name <span class="sc">!=</span> <span class="st">&quot;Anoplostethus_laetus&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb185-16"><a href="#cb185-16" aria-hidden="true" tabindex="-1"></a>    phylogeny_name <span class="sc">!=</span> <span class="st">&quot;Anoplostethus_opalinus&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb185-17"><a href="#cb185-17" aria-hidden="true" tabindex="-1"></a>    phylogeny_name <span class="sc">!=</span> <span class="st">&quot;Anoplostethus_roseus&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb185-18"><a href="#cb185-18" aria-hidden="true" tabindex="-1"></a>    phylogeny_name <span class="sc">!=</span> <span class="st">&quot;Anoplognathus_parvulus&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb185-19"><a href="#cb185-19" aria-hidden="true" tabindex="-1"></a>    phylogeny_name <span class="sc">!=</span> <span class="st">&quot;Anoplognathus_aureus&quot;</span>)</span></code></pre></div>
</div>
<div id="reflectivity-2" class="section level2">
<h2>Reflectivity</h2>
<div id="vis-4" class="section level3">
<h3>VIS</h3>
<p style="color: #04C799">
<p><strong>All species</strong></p>
</p>
<div class="sourceCode" id="cb186"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(PolRefl<span class="sc">$</span>VIS, PolRefl<span class="sc">$</span>Pol) <span class="co"># by spp</span></span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  PolRefl$VIS and PolRefl$Pol
## t = 1.5434, df = 45, p-value = 0.1297
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.06728212  0.48044869
## sample estimates:
##       cor 
## 0.2242168</code></pre>
<p style="color: #04C799">
<p><strong>No underlay</strong></p>
</p>
<div class="sourceCode" id="cb188"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(NoUnderlayRefl<span class="sc">$</span>VIS, NoUnderlayRefl<span class="sc">$</span>Pol) <span class="co"># by spp</span></span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  NoUnderlayRefl$VIS and NoUnderlayRefl$Pol
## t = 1.3748, df = 40, p-value = 0.1768
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.09782853  0.48503581
## sample estimates:
##       cor 
## 0.2124187</code></pre>
<p style="color: #04C799">
<p><strong>No special cases</strong></p>
</p>
<div class="sourceCode" id="cb190"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(NoSpecialCasesRefl<span class="sc">$</span>VIS, NoSpecialCasesRefl<span class="sc">$</span>Pol) <span class="co"># by spp</span></span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  NoSpecialCasesRefl$VIS and NoSpecialCasesRefl$Pol
## t = -1.5685, df = 34, p-value = 0.126
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.54203774  0.07519306
## sample estimates:
##        cor 
## -0.2597597</code></pre>
<p style="color: #04C799">
<p><strong>No chiral composites</strong></p>
</p>
<div class="sourceCode" id="cb192"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(NoCCRefl<span class="sc">$</span>VIS, NoCCRefl<span class="sc">$</span>Pol) <span class="co"># by spp</span></span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  NoCCRefl$VIS and NoCCRefl$Pol
## t = -1.4969, df = 39, p-value = 0.1425
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.50456471  0.08031186
## sample estimates:
##       cor 
## -0.233098</code></pre>
</div>
<div id="nir-4" class="section level3">
<h3>NIR</h3>
<p style="color: #04C799">
<p><strong>All species</strong></p>
</p>
<div class="sourceCode" id="cb194"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(PolRefl<span class="sc">$</span>NIR, PolRefl<span class="sc">$</span>Pol) <span class="co"># by spp</span></span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  PolRefl$NIR and PolRefl$Pol
## t = -1.7419, df = 45, p-value = 0.08836
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.50225033  0.03862105
## sample estimates:
##        cor 
## -0.2513332</code></pre>
<p style="color: #04C799">
<p><strong>No underlay</strong></p>
</p>
<div class="sourceCode" id="cb196"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(NoUnderlayRefl<span class="sc">$</span>NIR, NoUnderlayRefl<span class="sc">$</span>Pol) <span class="co"># by spp</span></span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  NoUnderlayRefl$NIR and NoUnderlayRefl$Pol
## t = -0.98424, df = 40, p-value = 0.3309
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.4372662  0.1575225
## sample estimates:
##        cor 
## -0.1537708</code></pre>
<p style="color: #04C799">
<p><strong>No special cases</strong></p>
</p>
<div class="sourceCode" id="cb198"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(NoSpecialCasesRefl<span class="sc">$</span>NIR, NoSpecialCasesRefl<span class="sc">$</span>Pol) <span class="co"># by spp</span></span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  NoSpecialCasesRefl$NIR and NoSpecialCasesRefl$Pol
## t = -3.4904, df = 34, p-value = 0.001356
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.7205635 -0.2226514
## sample estimates:
##        cor 
## -0.5136167</code></pre>
<p style="color: #04C799">
<p><strong>No chiral composites</strong></p>
</p>
<div class="sourceCode" id="cb200"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(NoCCRefl<span class="sc">$</span>NIR, NoCCRefl<span class="sc">$</span>Pol) <span class="co"># by spp</span></span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  NoCCRefl$NIR and NoCCRefl$Pol
## t = -3.7868, df = 39, p-value = 0.0005151
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.7124920 -0.2508605
## sample estimates:
##        cor 
## -0.5184949</code></pre>
</div>
<div id="frs-4" class="section level3">
<h3>FRS</h3>
<p style="color: #04C799">
<p><strong>All species</strong></p>
</p>
<div class="sourceCode" id="cb202"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(PolRefl<span class="sc">$</span>FRS, PolRefl<span class="sc">$</span>Pol) <span class="co"># by spp</span></span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  PolRefl$FRS and PolRefl$Pol
## t = -4.2698, df = 45, p-value = 0.00009974
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.7140250 -0.2953307
## sample estimates:
##        cor 
## -0.5369585</code></pre>
<p style="color: #04C799">
<p><strong>No underlay</strong></p>
</p>
<div class="sourceCode" id="cb204"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(NoUnderlayRefl<span class="sc">$</span>FRS, NoUnderlayRefl<span class="sc">$</span>Pol) <span class="co"># by spp</span></span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  NoUnderlayRefl$FRS and NoUnderlayRefl$Pol
## t = -4.2365, df = 40, p-value = 0.0001296
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.7359742 -0.3040243
## sample estimates:
##        cor 
## -0.5565308</code></pre>
<p style="color: #04C799">
<p><strong>No special cases</strong></p>
</p>
<div class="sourceCode" id="cb206"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(NoSpecialCasesRefl<span class="sc">$</span>FRS, NoSpecialCasesRefl<span class="sc">$</span>Pol) <span class="co"># by spp</span></span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  NoSpecialCasesRefl$FRS and NoSpecialCasesRefl$Pol
## t = -4.0927, df = 34, p-value = 0.0002481
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.7596570 -0.3031927
## sample estimates:
##        cor 
## -0.5745024</code></pre>
<p style="color: #04C799">
<p><strong>No chiral composites</strong></p>
</p>
<div class="sourceCode" id="cb208"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(NoCCRefl<span class="sc">$</span>FRS, NoCCRefl<span class="sc">$</span>Pol) <span class="co"># by spp</span></span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  NoCCRefl$FRS and NoCCRefl$Pol
## t = -3.8721, df = 39, p-value = 0.0004006
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.7181806 -0.2617452
## sample estimates:
##        cor 
## -0.5269616</code></pre>
</div>
</div>
<div id="absorptivity-2" class="section level2">
<h2>Absorptivity</h2>
<div id="vis-5" class="section level3">
<h3>VIS</h3>
<p style="color: #04C799">
<p><strong>All species</strong></p>
</p>
<div class="sourceCode" id="cb210"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(PolAbs<span class="sc">$</span>VIS, PolAbs<span class="sc">$</span>Pol) <span class="co"># by spp</span></span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  PolAbs$VIS and PolAbs$Pol
## t = 0.041288, df = 24, p-value = 0.9674
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.3801654  0.3944917
## sample estimates:
##         cor 
## 0.008427517</code></pre>
<p style="color: #04C799">
<p><strong>No underlay</strong></p>
</p>
<div class="sourceCode" id="cb212"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(NoUnderlayAbs<span class="sc">$</span>VIS, NoUnderlayAbs<span class="sc">$</span>Pol) <span class="co"># by spp</span></span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  NoUnderlayAbs$VIS and NoUnderlayAbs$Pol
## t = -0.012444, df = 19, p-value = 0.9902
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.4340068  0.4293611
## sample estimates:
##          cor 
## -0.002854879</code></pre>
<p style="color: #04C799">
<p><strong>No special cases</strong></p>
</p>
<div class="sourceCode" id="cb214"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(NoSpecialCasesAbs<span class="sc">$</span>VIS, NoSpecialCasesAbs<span class="sc">$</span>Pol) <span class="co"># by spp</span></span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  NoSpecialCasesAbs$VIS and NoSpecialCasesAbs$Pol
## t = 2.8367, df = 14, p-value = 0.01319
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.1547983 0.8463786
## sample estimates:
##       cor 
## 0.6041449</code></pre>
<p style="color: #04C799">
<p><strong>No chiral composites</strong></p>
</p>
<div class="sourceCode" id="cb216"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(NoCCAbs<span class="sc">$</span>VIS, NoCCAbs<span class="sc">$</span>Pol) <span class="co"># by spp</span></span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  NoCCAbs$VIS and NoCCAbs$Pol
## t = 3.2942, df = 19, p-value = 0.003815
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.2314862 0.8209405
## sample estimates:
##       cor 
## 0.6029232</code></pre>
</div>
<div id="nir-5" class="section level3">
<h3>NIR</h3>
<p style="color: #04C799">
<p><strong>All species</strong></p>
</p>
<div class="sourceCode" id="cb218"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(PolAbs<span class="sc">$</span>NIR, PolAbs<span class="sc">$</span>Pol) <span class="co"># by spp</span></span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  PolAbs$NIR and PolAbs$Pol
## t = 1.0748, df = 24, p-value = 0.2932
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.1887276  0.5555297
## sample estimates:
##       cor 
## 0.2142898</code></pre>
<p style="color: #04C799">
<p><strong>No underlay</strong></p>
</p>
<div class="sourceCode" id="cb220"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(NoUnderlayAbs<span class="sc">$</span>NIR, NoUnderlayAbs<span class="sc">$</span>Pol) <span class="co"># by spp</span></span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  NoUnderlayAbs$NIR and NoUnderlayAbs$Pol
## t = 0.33542, df = 19, p-value = 0.741
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.3671231  0.4921109
## sample estimates:
##        cor 
## 0.07672295</code></pre>
<p style="color: #04C799">
<p><strong>No special cases</strong></p>
</p>
<div class="sourceCode" id="cb222"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(NoSpecialCasesAbs<span class="sc">$</span>NIR, NoSpecialCasesAbs<span class="sc">$</span>Pol) <span class="co"># by spp</span></span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  NoSpecialCasesAbs$NIR and NoSpecialCasesAbs$Pol
## t = 2.6934, df = 14, p-value = 0.01748
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.1245892 0.8374076
## sample estimates:
##       cor 
## 0.5842138</code></pre>
<p style="color: #04C799">
<p><strong>No chiral composites</strong></p>
</p>
<div class="sourceCode" id="cb224"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(NoCCAbs<span class="sc">$</span>NIR, NoCCAbs<span class="sc">$</span>Pol) <span class="co"># by spp</span></span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  NoCCAbs$NIR and NoCCAbs$Pol
## t = 3.6547, df = 19, p-value = 0.001685
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.2917107 0.8409388
## sample estimates:
##       cor 
## 0.6424902</code></pre>
</div>
<div id="frs-5" class="section level3">
<h3>FRS</h3>
<p style="color: #04C799">
<p><strong>All species</strong></p>
</p>
<div class="sourceCode" id="cb226"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(PolAbs<span class="sc">$</span>FRS, PolAbs<span class="sc">$</span>Pol) <span class="co"># by spp</span></span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  PolAbs$FRS and PolAbs$Pol
## t = 2.2597, df = 24, p-value = 0.03319
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.03759808 0.69366079
## sample estimates:
##     cor 
## 0.41885</code></pre>
<p style="color: #04C799">
<p><strong>No underlay</strong></p>
</p>
<div class="sourceCode" id="cb228"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(NoUnderlayAbs<span class="sc">$</span>FRS, NoUnderlayAbs<span class="sc">$</span>Pol) <span class="co"># by spp</span></span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  NoUnderlayAbs$FRS and NoUnderlayAbs$Pol
## t = 0.93021, df = 19, p-value = 0.3639
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.2450606  0.5874641
## sample estimates:
##      cor 
## 0.208705</code></pre>
<p style="color: #04C799">
<p><strong>No special cases</strong></p>
</p>
<div class="sourceCode" id="cb230"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(NoSpecialCasesAbs<span class="sc">$</span>FRS, NoSpecialCasesAbs<span class="sc">$</span>Pol) <span class="co"># by spp</span></span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  NoSpecialCasesAbs$FRS and NoSpecialCasesAbs$Pol
## t = 0.68241, df = 14, p-value = 0.5061
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.3471587  0.6199864
## sample estimates:
##       cor 
## 0.1794233</code></pre>
<p style="color: #04C799">
<p><strong>No chiral composites</strong></p>
</p>
<div class="sourceCode" id="cb232"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(NoCCAbs<span class="sc">$</span>FRS, NoCCAbs<span class="sc">$</span>Pol) <span class="co"># by spp</span></span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  NoCCAbs$FRS and NoCCAbs$Pol
## t = 1.7531, df = 19, p-value = 0.0957
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.06978245  0.69317408
## sample estimates:
##      cor 
## 0.373145</code></pre>
</div>
</div>
</div>
<div id="plots" class="section level1">
<h1>Plots</h1>
<div id="degree-of-polarisation" class="section level2">
<h2>Degree of polarisation</h2>
<div class="sourceCode" id="cb234"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a>ReflByInd <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;Data/FromCode/ConsolidatedReflectivityInd.csv&quot;</span>))[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb234-2"><a href="#cb234-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-3"><a href="#cb234-3" aria-hidden="true" tabindex="-1"></a>AbsByInd0 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;Data/FromCode/ConsolidatedAbsorptivityInd.csv&quot;</span>))[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb234-4"><a href="#cb234-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-5"><a href="#cb234-5" aria-hidden="true" tabindex="-1"></a>AbsByInd0<span class="sc">$</span>A_Res <span class="ot">&lt;-</span> <span class="fu">residuals</span> ( <span class="fu">lm</span> (AbsByInd0<span class="sc">$</span>A_NIR<span class="sc">~</span>AbsByInd0<span class="sc">$</span>A_VIS))</span>
<span id="cb234-6"><a href="#cb234-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-7"><a href="#cb234-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Mean and sd per species Absorptivity</span></span>
<span id="cb234-8"><a href="#cb234-8" aria-hidden="true" tabindex="-1"></a>AbsByInd <span class="ot">&lt;-</span></span>
<span id="cb234-9"><a href="#cb234-9" aria-hidden="true" tabindex="-1"></a>AbsByInd0 <span class="sc">%&gt;%</span></span>
<span id="cb234-10"><a href="#cb234-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="st">&quot;spp&quot;</span> <span class="ot">=</span> <span class="fu">substr</span>(ind, <span class="dv">1</span>, <span class="dv">4</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb234-11"><a href="#cb234-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(spp, A_VIS, A_NIR, A_Res) <span class="sc">%&gt;%</span> </span>
<span id="cb234-12"><a href="#cb234-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(spp) <span class="sc">%&gt;%</span> </span>
<span id="cb234-13"><a href="#cb234-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(</span>
<span id="cb234-14"><a href="#cb234-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">meanVISA =</span> <span class="fu">mean</span>(A_VIS),</span>
<span id="cb234-15"><a href="#cb234-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">meanNIRA =</span> <span class="fu">mean</span>(A_NIR),</span>
<span id="cb234-16"><a href="#cb234-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">meanResA =</span> <span class="fu">mean</span>(A_Res),</span>
<span id="cb234-17"><a href="#cb234-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">sdVISA =</span> <span class="fu">sd</span>(A_VIS),</span>
<span id="cb234-18"><a href="#cb234-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">sdNIRA =</span> <span class="fu">sd</span>(A_NIR),</span>
<span id="cb234-19"><a href="#cb234-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">sdResA =</span> <span class="fu">sd</span>(A_Res),</span>
<span id="cb234-20"><a href="#cb234-20" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb234-21"><a href="#cb234-21" aria-hidden="true" tabindex="-1"></a>AbsByInd <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(AbsByInd)</span>
<span id="cb234-22"><a href="#cb234-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-23"><a href="#cb234-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-24"><a href="#cb234-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Mean and sd per species Reflectivity</span></span>
<span id="cb234-25"><a href="#cb234-25" aria-hidden="true" tabindex="-1"></a>ToPlotPolRefl <span class="ot">&lt;-</span></span>
<span id="cb234-26"><a href="#cb234-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">merge</span>(ReflByInd[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>)], PolByInd, <span class="at">by =</span> <span class="st">&quot;ind&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb234-27"><a href="#cb234-27" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>phylogeny_name) <span class="sc">%&gt;%</span></span>
<span id="cb234-28"><a href="#cb234-28" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(spp) <span class="sc">%&gt;%</span></span>
<span id="cb234-29"><a href="#cb234-29" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(</span>
<span id="cb234-30"><a href="#cb234-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">meanVIS =</span> <span class="fu">mean</span>(R_VIS),</span>
<span id="cb234-31"><a href="#cb234-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">meanNIR =</span> <span class="fu">mean</span>(R_NIR),</span>
<span id="cb234-32"><a href="#cb234-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">meanRes =</span> <span class="fu">mean</span>(Res),</span>
<span id="cb234-33"><a href="#cb234-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">meanPol =</span> <span class="fu">mean</span>(Polarization),</span>
<span id="cb234-34"><a href="#cb234-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">sdVIS =</span> <span class="fu">sd</span>(R_VIS),</span>
<span id="cb234-35"><a href="#cb234-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">sdNIR =</span> <span class="fu">sd</span>(R_NIR),</span>
<span id="cb234-36"><a href="#cb234-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">sdRes =</span> <span class="fu">sd</span>(Res),</span>
<span id="cb234-37"><a href="#cb234-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">sdPol =</span> <span class="fu">sd</span>(Polarization)</span>
<span id="cb234-38"><a href="#cb234-38" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb234-39"><a href="#cb234-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-40"><a href="#cb234-40" aria-hidden="true" tabindex="-1"></a>ToPlotPolRefl <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(ToPlotPolRefl)</span>
<span id="cb234-41"><a href="#cb234-41" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(ToPlotPolRefl) <span class="ot">&lt;-</span> ToPlotPolRefl<span class="sc">$</span>spp</span>
<span id="cb234-42"><a href="#cb234-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-43"><a href="#cb234-43" aria-hidden="true" tabindex="-1"></a>ToPlotPolAbs <span class="ot">&lt;-</span> <span class="fu">merge</span>(</span>
<span id="cb234-44"><a href="#cb234-44" aria-hidden="true" tabindex="-1"></a>  ToPlotPolRefl[,<span class="fu">c</span>(<span class="st">&quot;spp&quot;</span>, <span class="st">&quot;meanPol&quot;</span>, <span class="st">&quot;sdPol&quot;</span>)], AbsByInd)</span>
<span id="cb234-45"><a href="#cb234-45" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(ToPlotPolAbs) <span class="ot">&lt;-</span> ToPlotPolAbs<span class="sc">$</span>spp</span></code></pre></div>
<p>Subset for plotting</p>
<div class="sourceCode" id="cb235"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a>UnderlayRefl <span class="ot">&lt;-</span> ToPlotPolRefl <span class="sc">%&gt;%</span></span>
<span id="cb235-2"><a href="#cb235-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(spp <span class="sc">==</span> <span class="st">&quot;xyls&quot;</span> <span class="sc">|</span></span>
<span id="cb235-3"><a href="#cb235-3" aria-hidden="true" tabindex="-1"></a>                spp <span class="sc">==</span> <span class="st">&quot;xyle&quot;</span> <span class="sc">|</span> </span>
<span id="cb235-4"><a href="#cb235-4" aria-hidden="true" tabindex="-1"></a>                spp <span class="sc">==</span> <span class="st">&quot;pczo&quot;</span> <span class="sc">|</span></span>
<span id="cb235-5"><a href="#cb235-5" aria-hidden="true" tabindex="-1"></a>                spp <span class="sc">==</span> <span class="st">&quot;pczp&quot;</span> <span class="sc">|</span></span>
<span id="cb235-6"><a href="#cb235-6" aria-hidden="true" tabindex="-1"></a>                spp <span class="sc">==</span> <span class="st">&quot;pczv&quot;</span> <span class="sc">|</span></span>
<span id="cb235-7"><a href="#cb235-7" aria-hidden="true" tabindex="-1"></a>                spp <span class="sc">==</span> <span class="st">&quot;prsi&quot;</span>)</span>
<span id="cb235-8"><a href="#cb235-8" aria-hidden="true" tabindex="-1"></a>UnderlayAbs <span class="ot">&lt;-</span> ToPlotPolAbs <span class="sc">%&gt;%</span></span>
<span id="cb235-9"><a href="#cb235-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(spp <span class="sc">==</span> <span class="st">&quot;xyls&quot;</span> <span class="sc">|</span></span>
<span id="cb235-10"><a href="#cb235-10" aria-hidden="true" tabindex="-1"></a>                spp <span class="sc">==</span> <span class="st">&quot;xyle&quot;</span> <span class="sc">|</span> </span>
<span id="cb235-11"><a href="#cb235-11" aria-hidden="true" tabindex="-1"></a>                spp <span class="sc">==</span> <span class="st">&quot;pczo&quot;</span> <span class="sc">|</span></span>
<span id="cb235-12"><a href="#cb235-12" aria-hidden="true" tabindex="-1"></a>                spp <span class="sc">==</span> <span class="st">&quot;pczp&quot;</span> <span class="sc">|</span></span>
<span id="cb235-13"><a href="#cb235-13" aria-hidden="true" tabindex="-1"></a>                spp <span class="sc">==</span> <span class="st">&quot;pczv&quot;</span> <span class="sc">|</span></span>
<span id="cb235-14"><a href="#cb235-14" aria-hidden="true" tabindex="-1"></a>                spp <span class="sc">==</span> <span class="st">&quot;prsi&quot;</span>)</span>
<span id="cb235-15"><a href="#cb235-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-16"><a href="#cb235-16" aria-hidden="true" tabindex="-1"></a>NoUnderlayRefl <span class="ot">&lt;-</span> ToPlotPolRefl <span class="sc">%&gt;%</span></span>
<span id="cb235-17"><a href="#cb235-17" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(spp <span class="sc">!=</span> <span class="st">&quot;xyls&quot;</span> <span class="sc">|</span></span>
<span id="cb235-18"><a href="#cb235-18" aria-hidden="true" tabindex="-1"></a>                spp <span class="sc">!=</span> <span class="st">&quot;xyle&quot;</span> <span class="sc">|</span> </span>
<span id="cb235-19"><a href="#cb235-19" aria-hidden="true" tabindex="-1"></a>                spp <span class="sc">!=</span> <span class="st">&quot;pczo&quot;</span> <span class="sc">|</span></span>
<span id="cb235-20"><a href="#cb235-20" aria-hidden="true" tabindex="-1"></a>                spp <span class="sc">!=</span> <span class="st">&quot;pczp&quot;</span> <span class="sc">|</span></span>
<span id="cb235-21"><a href="#cb235-21" aria-hidden="true" tabindex="-1"></a>                spp <span class="sc">!=</span> <span class="st">&quot;pczv&quot;</span> <span class="sc">|</span></span>
<span id="cb235-22"><a href="#cb235-22" aria-hidden="true" tabindex="-1"></a>                spp <span class="sc">!=</span> <span class="st">&quot;prsi&quot;</span>)</span>
<span id="cb235-23"><a href="#cb235-23" aria-hidden="true" tabindex="-1"></a>NoUnderlayAbs <span class="ot">&lt;-</span> ToPlotPolAbs <span class="sc">%&gt;%</span></span>
<span id="cb235-24"><a href="#cb235-24" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(spp <span class="sc">!=</span> <span class="st">&quot;xyls&quot;</span> <span class="sc">|</span></span>
<span id="cb235-25"><a href="#cb235-25" aria-hidden="true" tabindex="-1"></a>                spp <span class="sc">!=</span> <span class="st">&quot;xyle&quot;</span> <span class="sc">|</span> </span>
<span id="cb235-26"><a href="#cb235-26" aria-hidden="true" tabindex="-1"></a>                spp <span class="sc">!=</span> <span class="st">&quot;pczo&quot;</span> <span class="sc">|</span></span>
<span id="cb235-27"><a href="#cb235-27" aria-hidden="true" tabindex="-1"></a>                spp <span class="sc">!=</span> <span class="st">&quot;pczp&quot;</span> <span class="sc">|</span></span>
<span id="cb235-28"><a href="#cb235-28" aria-hidden="true" tabindex="-1"></a>                spp <span class="sc">!=</span> <span class="st">&quot;pczv&quot;</span> <span class="sc">|</span></span>
<span id="cb235-29"><a href="#cb235-29" aria-hidden="true" tabindex="-1"></a>                spp <span class="sc">!=</span> <span class="st">&quot;prsi&quot;</span>)</span></code></pre></div>
<p>Predictions from PGLS for the NIR reflectivity and absorptivity</p>
<div class="sourceCode" id="cb236"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="do">## set values for predictors: </span></span>
<span id="cb236-2"><a href="#cb236-2" aria-hidden="true" tabindex="-1"></a>PolDeg <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">range</span>(ToPlotPolRefl<span class="sc">$</span>meanPol)[<span class="dv">1</span>],</span>
<span id="cb236-3"><a href="#cb236-3" aria-hidden="true" tabindex="-1"></a>             <span class="fu">range</span>(ToPlotPolRefl<span class="sc">$</span>meanPol)[<span class="dv">2</span>],<span class="fl">0.01</span>) <span class="co"># A range of Pol values</span></span>
<span id="cb236-4"><a href="#cb236-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-5"><a href="#cb236-5" aria-hidden="true" tabindex="-1"></a>new1<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="st">&quot;Pol&quot;</span> <span class="ot">=</span> PolDeg) <span class="co"># data frame</span></span>
<span id="cb236-6"><a href="#cb236-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-7"><a href="#cb236-7" aria-hidden="true" tabindex="-1"></a>RefDeg<span class="ot">&lt;-</span><span class="fu">predict</span>(pglsPDFRS, <span class="at">newdata =</span> new1, </span>
<span id="cb236-8"><a href="#cb236-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">type =</span> <span class="st">&quot;response&quot;</span>) <span class="co"># Expected reflectivity</span></span>
<span id="cb236-9"><a href="#cb236-9" aria-hidden="true" tabindex="-1"></a>trend1<span class="ot">&lt;-</span><span class="fu">data.frame</span>(PolDeg,RefDeg) <span class="co"># Pol values and expected reflectivity joint</span></span>
<span id="cb236-10"><a href="#cb236-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-11"><a href="#cb236-11" aria-hidden="true" tabindex="-1"></a>AbsDeg<span class="ot">&lt;-</span><span class="fu">predict</span>(pglsPDFRSAbs, <span class="at">newdata =</span> new1, </span>
<span id="cb236-12"><a href="#cb236-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">type =</span> <span class="st">&quot;response&quot;</span>) <span class="co"># Expected absorptivity</span></span>
<span id="cb236-13"><a href="#cb236-13" aria-hidden="true" tabindex="-1"></a>trend2<span class="ot">&lt;-</span><span class="fu">data.frame</span>(PolDeg,AbsDeg) <span class="co"># Pol values and expected reflectivity joint</span></span></code></pre></div>
<p>Predictions from PGLS for the NIR absorptivity</p>
<div class="sourceCode" id="cb237"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="do">## set values for predictors: </span></span>
<span id="cb237-2"><a href="#cb237-2" aria-hidden="true" tabindex="-1"></a>PolDeg <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">range</span>(ToPlotPolRefl<span class="sc">$</span>meanPol)[<span class="dv">1</span>],</span>
<span id="cb237-3"><a href="#cb237-3" aria-hidden="true" tabindex="-1"></a>             <span class="fu">range</span>(ToPlotPolRefl<span class="sc">$</span>meanPol)[<span class="dv">2</span>],<span class="fl">0.01</span>) <span class="co"># A range of Pol values</span></span>
<span id="cb237-4"><a href="#cb237-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5"><a href="#cb237-5" aria-hidden="true" tabindex="-1"></a>new1<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="st">&quot;Pol&quot;</span> <span class="ot">=</span> PolDeg) <span class="co"># data frame</span></span>
<span id="cb237-6"><a href="#cb237-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7"><a href="#cb237-7" aria-hidden="true" tabindex="-1"></a>RefDeg<span class="ot">&lt;-</span><span class="fu">predict</span>(pglsPDFRS, <span class="at">newdata =</span> new1, </span>
<span id="cb237-8"><a href="#cb237-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">type =</span> <span class="st">&quot;response&quot;</span>) <span class="co"># Expected reflectivity</span></span>
<span id="cb237-9"><a href="#cb237-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-10"><a href="#cb237-10" aria-hidden="true" tabindex="-1"></a>trend1<span class="ot">&lt;-</span><span class="fu">data.frame</span>(PolDeg,RefDeg) <span class="co"># Pol values and expected reflectivity joint</span></span></code></pre></div>
<div class="sourceCode" id="cb238"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a>NudgeXVal <span class="ot">=</span> <span class="fl">0.04</span></span>
<span id="cb238-2"><a href="#cb238-2" aria-hidden="true" tabindex="-1"></a>NudgeYVal <span class="ot">=</span> <span class="fl">0.9</span></span>
<span id="cb238-3"><a href="#cb238-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-4"><a href="#cb238-4" aria-hidden="true" tabindex="-1"></a>PVRPlot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> ToPlotPolRefl, <span class="fu">aes</span>(<span class="at">x =</span> meanPol, <span class="at">y =</span> meanVIS),</span>
<span id="cb238-5"><a href="#cb238-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">2.2</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb238-6"><a href="#cb238-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb238-7"><a href="#cb238-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">label=</span><span class="fu">rownames</span>(ToPlotPolRefl), </span>
<span id="cb238-8"><a href="#cb238-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">nudge_x =</span> NudgeXVal, <span class="at">nudge_y =</span> NudgeYVal, </span>
<span id="cb238-9"><a href="#cb238-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">col=</span><span class="st">&quot;gray&quot;</span>, <span class="at">size=</span><span class="dv">3</span></span>
<span id="cb238-10"><a href="#cb238-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb238-11"><a href="#cb238-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># error bars</span></span>
<span id="cb238-12"><a href="#cb238-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(</span>
<span id="cb238-13"><a href="#cb238-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">ymin =</span> meanVIS <span class="sc">-</span> sdVIS,</span>
<span id="cb238-14"><a href="#cb238-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">ymax =</span> meanVIS <span class="sc">+</span> sdVIS),</span>
<span id="cb238-15"><a href="#cb238-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;#cecec2&quot;</span></span>
<span id="cb238-16"><a href="#cb238-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb238-17"><a href="#cb238-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(</span>
<span id="cb238-18"><a href="#cb238-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmin =</span> meanPol <span class="sc">-</span> sdPol,</span>
<span id="cb238-19"><a href="#cb238-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmax =</span> meanPol <span class="sc">+</span> sdPol</span>
<span id="cb238-20"><a href="#cb238-20" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb238-21"><a href="#cb238-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;#cecec2&quot;</span></span>
<span id="cb238-22"><a href="#cb238-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb238-23"><a href="#cb238-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> NoUnderlayRefl, <span class="at">size =</span> <span class="fl">2.2</span>, <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&quot;#648fff&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb238-24"><a href="#cb238-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> UnderlayRefl, <span class="at">size =</span> <span class="fl">2.4</span>, <span class="at">pch =</span> <span class="dv">22</span>, <span class="at">fill =</span> <span class="st">&quot;#F7E949&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb238-25"><a href="#cb238-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb238-26"><a href="#cb238-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span> </span>
<span id="cb238-27"><a href="#cb238-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Degree of Polarisation (L - R)/(L + R)&quot;</span>)<span class="sc">+</span></span>
<span id="cb238-28"><a href="#cb238-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Visible reflectivity (%)&quot;</span>) <span class="sc">+</span></span>
<span id="cb238-29"><a href="#cb238-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">50</span>)</span>
<span id="cb238-30"><a href="#cb238-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-31"><a href="#cb238-31" aria-hidden="true" tabindex="-1"></a>PNRPlot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> ToPlotPolRefl, <span class="fu">aes</span>(<span class="at">x =</span> meanPol, <span class="at">y =</span> meanRes),</span>
<span id="cb238-32"><a href="#cb238-32" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">2.2</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb238-33"><a href="#cb238-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb238-34"><a href="#cb238-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">label=</span><span class="fu">rownames</span>(ToPlotPolRefl), </span>
<span id="cb238-35"><a href="#cb238-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">nudge_x =</span> NudgeXVal, <span class="at">nudge_y =</span> NudgeYVal, </span>
<span id="cb238-36"><a href="#cb238-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">col=</span><span class="st">&quot;gray&quot;</span>, <span class="at">size=</span><span class="dv">3</span></span>
<span id="cb238-37"><a href="#cb238-37" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb238-38"><a href="#cb238-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># error bars</span></span>
<span id="cb238-39"><a href="#cb238-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(</span>
<span id="cb238-40"><a href="#cb238-40" aria-hidden="true" tabindex="-1"></a>                <span class="at">ymin =</span> meanRes <span class="sc">-</span> sdRes,</span>
<span id="cb238-41"><a href="#cb238-41" aria-hidden="true" tabindex="-1"></a>                <span class="at">ymax =</span> meanRes <span class="sc">+</span> sdRes),</span>
<span id="cb238-42"><a href="#cb238-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;#cecec2&quot;</span></span>
<span id="cb238-43"><a href="#cb238-43" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb238-44"><a href="#cb238-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(</span>
<span id="cb238-45"><a href="#cb238-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmin =</span> meanPol <span class="sc">-</span> sdPol,</span>
<span id="cb238-46"><a href="#cb238-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmax =</span> meanPol <span class="sc">+</span> sdPol</span>
<span id="cb238-47"><a href="#cb238-47" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb238-48"><a href="#cb238-48" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;#cecec2&quot;</span></span>
<span id="cb238-49"><a href="#cb238-49" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb238-50"><a href="#cb238-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> NoUnderlayRefl, <span class="at">size =</span> <span class="fl">2.2</span>, <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&quot;#648fff&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb238-51"><a href="#cb238-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> UnderlayRefl, <span class="at">size =</span> <span class="fl">2.4</span>, <span class="at">pch =</span> <span class="dv">22</span>, <span class="at">fill =</span> <span class="st">&quot;#F7E949&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb238-52"><a href="#cb238-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data=</span>trend1, <span class="fu">aes</span>(<span class="at">x=</span> PolDeg, <span class="at">y=</span> RefDeg), <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb238-53"><a href="#cb238-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb238-54"><a href="#cb238-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span> </span>
<span id="cb238-55"><a href="#cb238-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Degree of Polarisation (L - R)/(L + R)&quot;</span>)<span class="sc">+</span></span>
<span id="cb238-56"><a href="#cb238-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;NIR (Res) reflectivity (%)&quot;</span>) </span>
<span id="cb238-57"><a href="#cb238-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-58"><a href="#cb238-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-59"><a href="#cb238-59" aria-hidden="true" tabindex="-1"></a>PVAPlot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> ToPlotPolAbs, <span class="fu">aes</span>(<span class="at">x =</span> meanPol, <span class="at">y =</span> meanVISA),</span>
<span id="cb238-60"><a href="#cb238-60" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">2.2</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb238-61"><a href="#cb238-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb238-62"><a href="#cb238-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">label=</span><span class="fu">rownames</span>(ToPlotPolAbs), </span>
<span id="cb238-63"><a href="#cb238-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">nudge_x =</span> NudgeXVal, <span class="at">nudge_y =</span> NudgeYVal, </span>
<span id="cb238-64"><a href="#cb238-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">col=</span><span class="st">&quot;gray&quot;</span>, <span class="at">size=</span><span class="dv">3</span></span>
<span id="cb238-65"><a href="#cb238-65" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb238-66"><a href="#cb238-66" aria-hidden="true" tabindex="-1"></a>  <span class="co"># error bars</span></span>
<span id="cb238-67"><a href="#cb238-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(</span>
<span id="cb238-68"><a href="#cb238-68" aria-hidden="true" tabindex="-1"></a>                <span class="at">ymin =</span> meanVISA <span class="sc">-</span> sdVISA,</span>
<span id="cb238-69"><a href="#cb238-69" aria-hidden="true" tabindex="-1"></a>                <span class="at">ymax =</span> meanVISA <span class="sc">+</span> sdVISA),</span>
<span id="cb238-70"><a href="#cb238-70" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;#cecec2&quot;</span></span>
<span id="cb238-71"><a href="#cb238-71" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb238-72"><a href="#cb238-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(</span>
<span id="cb238-73"><a href="#cb238-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmin =</span> meanPol <span class="sc">-</span> sdPol,</span>
<span id="cb238-74"><a href="#cb238-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmax =</span> meanPol <span class="sc">+</span> sdPol</span>
<span id="cb238-75"><a href="#cb238-75" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb238-76"><a href="#cb238-76" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;#cecec2&quot;</span></span>
<span id="cb238-77"><a href="#cb238-77" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb238-78"><a href="#cb238-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> NoUnderlayAbs, <span class="at">size =</span> <span class="fl">2.2</span>, <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&quot;#648fff&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb238-79"><a href="#cb238-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> UnderlayAbs, <span class="at">size =</span> <span class="fl">2.4</span>, <span class="at">pch =</span> <span class="dv">22</span>, <span class="at">fill =</span> <span class="st">&quot;#F7E949&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb238-80"><a href="#cb238-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb238-81"><a href="#cb238-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span> </span>
<span id="cb238-82"><a href="#cb238-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Degree of Polarisation (L - R)/(L + R)&quot;</span>)<span class="sc">+</span></span>
<span id="cb238-83"><a href="#cb238-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Visible absorptivity (%)&quot;</span>) <span class="sc">+</span></span>
<span id="cb238-84"><a href="#cb238-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">100</span>)</span>
<span id="cb238-85"><a href="#cb238-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-86"><a href="#cb238-86" aria-hidden="true" tabindex="-1"></a>PNAPlot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> ToPlotPolAbs, <span class="fu">aes</span>(<span class="at">x =</span> meanPol, <span class="at">y =</span> meanResA),</span>
<span id="cb238-87"><a href="#cb238-87" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">2.2</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb238-88"><a href="#cb238-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb238-89"><a href="#cb238-89" aria-hidden="true" tabindex="-1"></a>    <span class="at">label=</span><span class="fu">rownames</span>(ToPlotPolAbs), </span>
<span id="cb238-90"><a href="#cb238-90" aria-hidden="true" tabindex="-1"></a>    <span class="at">nudge_x =</span> NudgeXVal, <span class="at">nudge_y =</span> NudgeYVal, </span>
<span id="cb238-91"><a href="#cb238-91" aria-hidden="true" tabindex="-1"></a>    <span class="at">col=</span><span class="st">&quot;gray&quot;</span>, <span class="at">size=</span><span class="dv">3</span></span>
<span id="cb238-92"><a href="#cb238-92" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb238-93"><a href="#cb238-93" aria-hidden="true" tabindex="-1"></a>  <span class="co"># error bars</span></span>
<span id="cb238-94"><a href="#cb238-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(</span>
<span id="cb238-95"><a href="#cb238-95" aria-hidden="true" tabindex="-1"></a>                <span class="at">ymin =</span> meanResA <span class="sc">-</span> sdResA,</span>
<span id="cb238-96"><a href="#cb238-96" aria-hidden="true" tabindex="-1"></a>                <span class="at">ymax =</span> meanResA <span class="sc">+</span> sdResA),</span>
<span id="cb238-97"><a href="#cb238-97" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;#cecec2&quot;</span></span>
<span id="cb238-98"><a href="#cb238-98" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb238-99"><a href="#cb238-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(</span>
<span id="cb238-100"><a href="#cb238-100" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmin =</span> meanPol <span class="sc">-</span> sdPol,</span>
<span id="cb238-101"><a href="#cb238-101" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmax =</span> meanPol <span class="sc">+</span> sdPol</span>
<span id="cb238-102"><a href="#cb238-102" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb238-103"><a href="#cb238-103" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;#cecec2&quot;</span></span>
<span id="cb238-104"><a href="#cb238-104" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb238-105"><a href="#cb238-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> NoUnderlayAbs, <span class="at">size =</span> <span class="fl">2.2</span>, <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&quot;#648fff&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb238-106"><a href="#cb238-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> UnderlayAbs, <span class="at">size =</span> <span class="fl">2.4</span>, <span class="at">pch =</span> <span class="dv">22</span>, <span class="at">fill =</span> <span class="st">&quot;#F7E949&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb238-107"><a href="#cb238-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data=</span>trend2, <span class="fu">aes</span>(<span class="at">x=</span> PolDeg, <span class="at">y=</span> AbsDeg), <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb238-108"><a href="#cb238-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb238-109"><a href="#cb238-109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span> </span>
<span id="cb238-110"><a href="#cb238-110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Degree of Polarisation (L - R)/(L + R)&quot;</span>)<span class="sc">+</span></span>
<span id="cb238-111"><a href="#cb238-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;NIR (Res) absorptivity (%)&quot;</span>) </span>
<span id="cb238-112"><a href="#cb238-112" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb238-113"><a href="#cb238-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-114"><a href="#cb238-114" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(PVRPlot, PNRPlot, PVAPlot, PNAPlot, <span class="at">nrow =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 3 rows containing missing values (geom_errorbarh).
## Removed 3 rows containing missing values (geom_errorbarh).</code></pre>
<p><img src="MacroEcol_7_PolarisationStats_files/figure-html/unnamed-chunk-136-1.png" width="672" /></p>
</div>
<div id="right-handed-polarisation" class="section level2">
<h2>Right handed polarisation</h2>
<p>Setting up data frames by individual for plots</p>
<div class="sourceCode" id="cb240"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import equalised values for right handed polarisation</span></span>
<span id="cb240-2"><a href="#cb240-2" aria-hidden="true" tabindex="-1"></a>RHand0I<span class="ot">&lt;-</span><span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;Data/FromCode/PolarzElytra_LERGBValues.csv&quot;</span>))[<span class="sc">-</span><span class="dv">1</span>]<span class="sc">%&gt;%</span> </span>
<span id="cb240-3"><a href="#cb240-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Type <span class="sc">==</span> <span class="st">&quot;RCP&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb240-4"><a href="#cb240-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>Type) <span class="sc">%&gt;%</span> </span>
<span id="cb240-5"><a href="#cb240-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;RHPol&quot;</span> <span class="ot">=</span> RGB_ave)</span>
<span id="cb240-6"><a href="#cb240-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb240-7"><a href="#cb240-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Load degree of polarisation per individual</span></span>
<span id="cb240-8"><a href="#cb240-8" aria-hidden="true" tabindex="-1"></a>PolDeg0I <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;Data/FromCode/PolarzElytraByInd.csv&quot;</span>))[<span class="sc">-</span><span class="dv">1</span>] <span class="sc">%&gt;%</span> </span>
<span id="cb240-9"><a href="#cb240-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(ind, Polarization)</span>
<span id="cb240-10"><a href="#cb240-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb240-11"><a href="#cb240-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge RCP with degree of polarisation</span></span>
<span id="cb240-12"><a href="#cb240-12" aria-hidden="true" tabindex="-1"></a>RHandWPolDeg <span class="ot">&lt;-</span> <span class="fu">merge</span>(RHand0I, PolDeg0I)</span>
<span id="cb240-13"><a href="#cb240-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb240-14"><a href="#cb240-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Join them with the phylogeny names</span></span>
<span id="cb240-15"><a href="#cb240-15" aria-hidden="true" tabindex="-1"></a>SppNamesI<span class="ot">&lt;-</span><span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;Data/9_CodesAndSpecies.csv&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb240-16"><a href="#cb240-16" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;ind&quot;</span> <span class="ot">=</span> Ind)</span>
<span id="cb240-17"><a href="#cb240-17" aria-hidden="true" tabindex="-1"></a>RHandWPolDegByInd <span class="ot">&lt;-</span> <span class="fu">merge</span>(RHandWPolDeg, SppNamesI)</span>
<span id="cb240-18"><a href="#cb240-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb240-19"><a href="#cb240-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Add 4-letter spp code</span></span>
<span id="cb240-20"><a href="#cb240-20" aria-hidden="true" tabindex="-1"></a>RHandWPolDegByInd <span class="ot">&lt;-</span></span>
<span id="cb240-21"><a href="#cb240-21" aria-hidden="true" tabindex="-1"></a>  RHandWPolDegByInd <span class="sc">%&gt;%</span> </span>
<span id="cb240-22"><a href="#cb240-22" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">spp =</span> <span class="fu">substr</span>(ind, <span class="dv">1</span>, <span class="dv">4</span>))</span>
<span id="cb240-23"><a href="#cb240-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb240-24"><a href="#cb240-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine with visible reflectivity</span></span>
<span id="cb240-25"><a href="#cb240-25" aria-hidden="true" tabindex="-1"></a>RHandPolDegReflByInd <span class="ot">&lt;-</span> <span class="fu">merge</span>(RHandWPolDegByInd, ReflByInd) <span class="sc">%&gt;%</span> </span>
<span id="cb240-26"><a href="#cb240-26" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>R_ALL, <span class="sc">-</span>R_NIR, <span class="sc">-</span>Res, <span class="sc">-</span>size)</span></code></pre></div>
<p>And re order them to plot</p>
<div class="sourceCode" id="cb241"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a>ToPlotRHPolRefl <span class="ot">&lt;-</span></span>
<span id="cb241-2"><a href="#cb241-2" aria-hidden="true" tabindex="-1"></a>  RHandPolDegReflByInd <span class="sc">%&gt;%</span></span>
<span id="cb241-3"><a href="#cb241-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>phylogeny_name) <span class="sc">%&gt;%</span></span>
<span id="cb241-4"><a href="#cb241-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(spp) <span class="sc">%&gt;%</span> </span>
<span id="cb241-5"><a href="#cb241-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(</span>
<span id="cb241-6"><a href="#cb241-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">meanVIS =</span> <span class="fu">mean</span>(R_VIS),</span>
<span id="cb241-7"><a href="#cb241-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">meanRHPol =</span> <span class="fu">mean</span>(RHPol),</span>
<span id="cb241-8"><a href="#cb241-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">meanPol =</span> <span class="fu">mean</span>(Polarization),</span>
<span id="cb241-9"><a href="#cb241-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">sdVIS =</span> <span class="fu">sd</span>(R_VIS),</span>
<span id="cb241-10"><a href="#cb241-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">sdRHPol =</span> <span class="fu">sd</span>(RHPol),</span>
<span id="cb241-11"><a href="#cb241-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">sdPol =</span> <span class="fu">sd</span>(Polarization)</span>
<span id="cb241-12"><a href="#cb241-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb241-13"><a href="#cb241-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb241-14"><a href="#cb241-14" aria-hidden="true" tabindex="-1"></a>ToPlotRHPolRefl <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(ToPlotRHPolRefl)</span>
<span id="cb241-15"><a href="#cb241-15" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(ToPlotRHPolRefl) <span class="ot">&lt;-</span> ToPlotRHPolRefl<span class="sc">$</span>spp</span></code></pre></div>
<p>Predictions from PGLS for the VIS reflectivity</p>
<div class="sourceCode" id="cb242"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="do">## set values for predictors: </span></span>
<span id="cb242-2"><a href="#cb242-2" aria-hidden="true" tabindex="-1"></a>RHPolSeq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">range</span>(ToPlotRHPolRefl<span class="sc">$</span>meanRHPol)[<span class="dv">1</span>],</span>
<span id="cb242-3"><a href="#cb242-3" aria-hidden="true" tabindex="-1"></a>             <span class="fu">range</span>(ToPlotRHPolRefl<span class="sc">$</span>meanRHPol)[<span class="dv">2</span>],<span class="fl">0.01</span>) <span class="co"># A range of Pol values</span></span>
<span id="cb242-4"><a href="#cb242-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-5"><a href="#cb242-5" aria-hidden="true" tabindex="-1"></a>new1RH<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="st">&quot;Pol&quot;</span> <span class="ot">=</span> RHPolSeq) <span class="co"># data frame</span></span>
<span id="cb242-6"><a href="#cb242-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-7"><a href="#cb242-7" aria-hidden="true" tabindex="-1"></a>RefRHPolPred <span class="ot">&lt;-</span> <span class="fu">predict</span>(pglsPDVISRH, <span class="at">newdata =</span> new1RH, </span>
<span id="cb242-8"><a href="#cb242-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">type =</span> <span class="st">&quot;response&quot;</span>) <span class="co"># Expected reflectivity</span></span>
<span id="cb242-9"><a href="#cb242-9" aria-hidden="true" tabindex="-1"></a>trend1RH<span class="ot">&lt;-</span><span class="fu">data.frame</span>(RHPolSeq, RefRHPolPred) <span class="co"># Pol values and expected reflectivity joint</span></span></code></pre></div>
<p>Plots</p>
<div class="sourceCode" id="cb243"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a>NudgeXVal <span class="ot">=</span> <span class="fl">0.3</span></span>
<span id="cb243-2"><a href="#cb243-2" aria-hidden="true" tabindex="-1"></a>NudgeYVal <span class="ot">=</span> <span class="fl">0.7</span></span>
<span id="cb243-3"><a href="#cb243-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-4"><a href="#cb243-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-5"><a href="#cb243-5" aria-hidden="true" tabindex="-1"></a>RCPVRPlot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> ToPlotRHPolRefl, <span class="fu">aes</span>(<span class="at">x =</span> meanRHPol, <span class="at">y =</span> meanVIS),</span>
<span id="cb243-6"><a href="#cb243-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">2.2</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb243-7"><a href="#cb243-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb243-8"><a href="#cb243-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">label=</span><span class="fu">rownames</span>(ToPlotRHPolRefl), </span>
<span id="cb243-9"><a href="#cb243-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">nudge_x =</span> NudgeXVal, <span class="at">nudge_y =</span> NudgeYVal, </span>
<span id="cb243-10"><a href="#cb243-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">col=</span><span class="st">&quot;gray&quot;</span>, <span class="at">size=</span><span class="dv">3</span></span>
<span id="cb243-11"><a href="#cb243-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb243-12"><a href="#cb243-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># error bars</span></span>
<span id="cb243-13"><a href="#cb243-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(</span>
<span id="cb243-14"><a href="#cb243-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">ymin =</span> meanVIS <span class="sc">-</span> sdVIS,</span>
<span id="cb243-15"><a href="#cb243-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">ymax =</span> meanVIS <span class="sc">+</span> sdVIS),</span>
<span id="cb243-16"><a href="#cb243-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;#cecec2&quot;</span></span>
<span id="cb243-17"><a href="#cb243-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb243-18"><a href="#cb243-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(</span>
<span id="cb243-19"><a href="#cb243-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmin =</span> meanRHPol <span class="sc">-</span> sdRHPol,</span>
<span id="cb243-20"><a href="#cb243-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmax =</span> meanRHPol <span class="sc">+</span> sdRHPol</span>
<span id="cb243-21"><a href="#cb243-21" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb243-22"><a href="#cb243-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;#cecec2&quot;</span></span>
<span id="cb243-23"><a href="#cb243-23" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb243-24"><a href="#cb243-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> ToPlotRHPolRefl, <span class="at">size =</span> <span class="fl">2.2</span>, <span class="at">pch =</span> <span class="dv">21</span>, </span>
<span id="cb243-25"><a href="#cb243-25" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> <span class="st">&quot;#648fff&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb243-26"><a href="#cb243-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data=</span>trend1RH, <span class="fu">aes</span>(<span class="at">x=</span> RHPolSeq, <span class="at">y=</span> RefRHPolPred), <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb243-27"><a href="#cb243-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb243-28"><a href="#cb243-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span> </span>
<span id="cb243-29"><a href="#cb243-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Right Handed Polarisation (RGB mean)&quot;</span>)<span class="sc">+</span></span>
<span id="cb243-30"><a href="#cb243-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Visible reflectivity (%)&quot;</span>) <span class="sc">+</span></span>
<span id="cb243-31"><a href="#cb243-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">40</span>)</span></code></pre></div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4,h5",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
