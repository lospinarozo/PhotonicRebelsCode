<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Laura Ospina-Rozo" />


<title>Polarisation analysis without outliers</title>

<script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #ffffff;
    color: #a0a0a0;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
div.sourceCode
  { color: #1f1c1b; background-color: #ffffff; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #1f1c1b; } /* Normal */
code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
code span.an { color: #ca60ca; } /* Annotation */
code span.at { color: #0057ae; } /* Attribute */
code span.bn { color: #b08000; } /* BaseN */
code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
code span.ch { color: #924c9d; } /* Char */
code span.cn { color: #aa5500; } /* Constant */
code span.co { color: #898887; } /* Comment */
code span.cv { color: #0095ff; } /* CommentVar */
code span.do { color: #607880; } /* Documentation */
code span.dt { color: #0057ae; } /* DataType */
code span.dv { color: #b08000; } /* DecVal */
code span.er { color: #bf0303; text-decoration: underline; } /* Error */
code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
code span.fl { color: #b08000; } /* Float */
code span.fu { color: #644a9b; } /* Function */
code span.im { color: #ff5500; } /* Import */
code span.in { color: #b08000; } /* Information */
code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
code span.op { color: #1f1c1b; } /* Operator */
code span.ot { color: #006e28; } /* Other */
code span.pp { color: #006e28; } /* Preprocessor */
code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
code span.sc { color: #3daee9; } /* SpecialChar */
code span.ss { color: #ff5500; } /* SpecialString */
code span.st { color: #bf0303; } /* String */
code span.va { color: #0057ae; } /* Variable */
code span.vs { color: #bf0303; } /* VerbatimString */
code span.wa { color: #bf0303; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Photonic Rebels</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Main</a>
</li>
<li>
  <a href="MacroEcol_1_SettingUp.html">Setting up</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Extracting variables
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="MacroEcol_2_OpticalProperties.html">Reflectivity &amp; Absorptivity</a>
    </li>
    <li>
      <a href="MacroEcol_3_Polarisation.html">Polarisation</a>
    </li>
    <li>
      <a href="MacroEcol_4_EcologicalVariables.html">Ecology</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Analysis
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="MacroEcol_5_ReflectivityStats.html">Reflectivity</a>
    </li>
    <li>
      <a href="MacroEcol_6_AbsorptivityStats.html">Absorptivity</a>
    </li>
    <li>
      <a href="MacroEcol_7_PolarisationStats.html">Polarisation</a>
    </li>
    <li>
      <a href="MacroEcol_8_SizeStats.html">Size</a>
    </li>
    <li>
      <a href="MacroEcol_9_ReflectivityQC.html">Reflectivity no outliers</a>
    </li>
    <li>
      <a href="MacroEcol_10_AbsorptivityQC.html">Absorptivity no outliers</a>
    </li>
    <li>
      <a href="MacroEcol_10_AbsorptivityQC.html">Polarisation no outliers</a>
    </li>
  </ul>
</li>
<li>
  <a href="MacroEcol_12_ExtraFigures.html">Extra figures</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Polarisation analysis without outliers</h1>
<h4 class="author">Laura Ospina-Rozo</h4>

</div>


<p>We repeated the analysis for degree of polarisation and the raw RGB
value sin the right handed polarisation filter excluding the outliers:
A. prasinus and the species belonging to the genus Xylonichus,
Paraschizognathus because, unlike many scarabs, these species are known
to have a bilayered mechanism that is not chiral.</p>
<div id="setting-up" class="section level1">
<h1>Setting up</h1>
<div id="libraries" class="section level2">
<h2>Libraries</h2>
<p>Libraries sourced from an additional script.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;Scripts/MacroEcol_1_Libraries.R&quot;</span>))</span></code></pre></div>
</div>
<div id="data-sets" class="section level2">
<h2>Data sets</h2>
<p>Import polarisation data.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># elytra</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>PolBySpp <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;Data/FromCode/PolarzElytraBySpp.csv&quot;</span>))[<span class="sc">-</span><span class="dv">1</span>] <span class="sc">%&gt;%</span> </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(phylogeny_name) <span class="sc">%&gt;%</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">str_detect</span>(phylogeny_name, <span class="st">&quot;Xylonichus_sp&quot;</span>),</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">str_detect</span>(phylogeny_name, <span class="st">&quot;Anoplognathus_prasinus&quot;</span>),</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">str_detect</span>(phylogeny_name, <span class="st">&quot;Paraschizognathus_ocularis&quot;</span>),</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">str_detect</span>(phylogeny_name, <span class="st">&quot;Paraschizognathus_prasinus&quot;</span>),</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">str_detect</span>(phylogeny_name, <span class="st">&quot;Paraschizognathus_olivaceous&quot;</span>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>PolByInd <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;Data/FromCode/PolarzElytraByInd.csv&quot;</span>))[<span class="sc">-</span><span class="dv">1</span>] <span class="sc">%&gt;%</span> </span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">str_detect</span>(ind, <span class="st">&quot;xyls&quot;</span>),</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">str_detect</span>(ind, <span class="st">&quot;prsi&quot;</span>),</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">str_detect</span>(ind, <span class="st">&quot;xyle&quot;</span>),</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">str_detect</span>(ind, <span class="st">&quot;pczo&quot;</span>),</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">str_detect</span>(ind, <span class="st">&quot;pczp&quot;</span>),</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">str_detect</span>(ind, <span class="st">&quot;pczv&quot;</span>)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="co"># elytra and pronotum</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="co">#BeetlePol &lt;- read.csv(here::here(&quot;Data/FromCode/PolarzElytraPronot.csv&quot;))[-1]</span></span></code></pre></div>
<p>All statistical analysis were done at the species level (polarisation
data by species). Plots are produced with the polarisation data by
individual.</p>
<p>And we imported the phylogeny from a .nwk file which contains 2000
phylogenetic trees. This allows us to test our hypothesis in multiple
trees and not only on the MCC tree. This way, we account for any
uncertainty in unresolved tips of our phylogeny.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Phylogeny</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>trees <span class="ot">&lt;-</span> ape<span class="sc">::</span><span class="fu">read.tree</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;Data/XMAS_mat2b_bst2ef_set23nn2_pinct.nwk&quot;</span>))</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set subset limits</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>trees_subset_min<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>trees_subset_max<span class="ot">&lt;-</span><span class="dv">2000</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>MCCtree <span class="ot">&lt;-</span> </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  ape<span class="sc">::</span><span class="fu">read.nexus</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;Data/xmas_mat2b_bst2ef_set23nn2_pinct_med.tre&quot;</span>))</span></code></pre></div>
<p>To explore the correlations between ecological variables and
polarisation</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># PC Values</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>PCValuesF <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;Data/FromCode/PCsbySpp.csv&quot;</span>))[<span class="sc">-</span><span class="dv">1</span>] <span class="sc">%&gt;%</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;PC1&quot;</span> <span class="ot">=</span> PC1_1, <span class="st">&quot;PC2&quot;</span> <span class="ot">=</span> PC2_1) <span class="sc">%&gt;%</span> </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(phylogeny_name) <span class="sc">%&gt;%</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">str_detect</span>(phylogeny_name, <span class="st">&quot;Xylonichus_sp&quot;</span>),</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">str_detect</span>(phylogeny_name, <span class="st">&quot;Anoplognathus_prasinus&quot;</span>),</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">str_detect</span>(phylogeny_name, <span class="st">&quot;Paraschizognathus_ocularis&quot;</span>),</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">str_detect</span>(phylogeny_name, <span class="st">&quot;Paraschizognathus_prasinus&quot;</span>),</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">str_detect</span>(phylogeny_name, <span class="st">&quot;Paraschizognathus_olivaceous&quot;</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="co"># merge with polarisation</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>PolPCs <span class="ot">&lt;-</span> <span class="fu">merge</span>(PCValuesF, PolBySpp)</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="co"># adapt to merge with phylogeny</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>PolPCs2 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(PolPCs) <span class="co"># create new data frame</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(PolPCs2) <span class="ot">&lt;-</span> PolPCs2[, <span class="dv">1</span>] <span class="co"># make species the row names</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>PolPCsRows <span class="ot">&lt;-</span> PolPCs2[, <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(PolPCs2)] <span class="co"># eliminate spp name (redundant)</span></span></code></pre></div>
<p>To explore correlations with reflectivity</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reflectivity data consolidated by species</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>ReflBySpp <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;Data/FromCode/ConsolidatedReflectivitySpp.csv&quot;</span>))[<span class="sc">-</span><span class="dv">1</span>] <span class="sc">%&gt;%</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(phylogeny_name) <span class="sc">%&gt;%</span> </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">str_detect</span>(phylogeny_name, <span class="st">&quot;Xylonichus_sp&quot;</span>),</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">str_detect</span>(phylogeny_name, <span class="st">&quot;Anoplognathus_prasinus&quot;</span>),</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">str_detect</span>(phylogeny_name, <span class="st">&quot;Paraschizognathus_ocularis&quot;</span>),</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">str_detect</span>(phylogeny_name, <span class="st">&quot;Paraschizognathus_prasinus&quot;</span>),</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">str_detect</span>(phylogeny_name, <span class="st">&quot;Paraschizognathus_olivaceous&quot;</span>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge with polarisation</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>PolRefl <span class="ot">&lt;-</span> <span class="fu">merge</span>(ReflBySpp, PolBySpp)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co"># adapt to merge with phylogeny</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>PolRefl2 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(PolRefl) <span class="co"># create new data frame</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(PolRefl2) <span class="ot">&lt;-</span> PolRefl2[, <span class="dv">1</span>] <span class="co"># make species the row names</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>PolReflRows <span class="ot">&lt;-</span> PolRefl2[, <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(PolRefl2)] <span class="co"># eliminate spp name (redundant)</span></span></code></pre></div>
<p>To explore correlations with absorptivity</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>AbsBySpp <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;Data/FromCode/ConsolidatedAbsorptivitySpp.csv&quot;</span>))[<span class="sc">-</span><span class="dv">1</span>] <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(phylogeny_name) <span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">str_detect</span>(phylogeny_name, <span class="st">&quot;Xylonichus_sp&quot;</span>),</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">str_detect</span>(phylogeny_name, <span class="st">&quot;Anoplognathus_prasinus&quot;</span>),</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">str_detect</span>(phylogeny_name, <span class="st">&quot;Paraschizognathus_ocularis&quot;</span>),</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">str_detect</span>(phylogeny_name, <span class="st">&quot;Paraschizognathus_prasinus&quot;</span>),</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">str_detect</span>(phylogeny_name, <span class="st">&quot;Paraschizognathus_olivaceous&quot;</span>)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co"># merge with polarisation</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>PolAbs <span class="ot">&lt;-</span> <span class="fu">merge</span>(AbsBySpp, PolBySpp)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="co"># adapt to merge with phylogeny</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>PolAbs2 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(PolAbs) <span class="co"># create new data frame</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(PolAbs2) <span class="ot">&lt;-</span> PolAbs2[, <span class="dv">1</span>] <span class="co"># make species the row names</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>PolAbsRows <span class="ot">&lt;-</span> PolAbs2[, <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(PolAbs2)] <span class="co"># eliminate spp name (redundant)</span></span></code></pre></div>
<p>To explore correlations with reflectivity only in Right handed
polarisation (as a proxy of the amount of melanin/pigments)</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import equalised values for right handed polarisation</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>RHand0<span class="ot">&lt;-</span><span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;Data/FromCode/PolarzElytra_LERGBValues.csv&quot;</span>))[<span class="sc">-</span><span class="dv">1</span>]<span class="sc">%&gt;%</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Type <span class="sc">==</span> <span class="st">&quot;RCP&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>Type) <span class="sc">%&gt;%</span> </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">spp=</span> <span class="fu">substr</span>(ind,<span class="dv">1</span>,<span class="dv">4</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(spp) <span class="sc">%&gt;%</span> </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">meanRCP =</span> <span class="fu">mean</span>(RGB_ave),</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">sdRCP =</span> <span class="fu">sd</span>(RGB_ave),</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Join them with the phylogeny names</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>SppNames<span class="ot">&lt;-</span><span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;Data/9_CodesAndSpecies.csv&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="st">&quot;spp&quot;</span> <span class="ot">=</span> <span class="fu">substr</span>(Ind,<span class="dv">1</span>,<span class="dv">4</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>Ind) <span class="sc">%&gt;%</span> </span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>RHand <span class="ot">&lt;-</span> <span class="fu">merge</span>(RHand0[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)],SppNames) <span class="sc">%&gt;%</span> </span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a> dplyr<span class="sc">::</span><span class="fu">arrange</span>(phylogeny_name) <span class="sc">%&gt;%</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">str_detect</span>(phylogeny_name, <span class="st">&quot;Xylonichus_sp&quot;</span>),</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">str_detect</span>(phylogeny_name, <span class="st">&quot;Anoplognathus_prasinus&quot;</span>),</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">str_detect</span>(phylogeny_name, <span class="st">&quot;Paraschizognathus_ocularis&quot;</span>),</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">str_detect</span>(phylogeny_name, <span class="st">&quot;Paraschizognathus_prasinus&quot;</span>),</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">str_detect</span>(phylogeny_name, <span class="st">&quot;Paraschizognathus_olivaceous&quot;</span>)</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Name the right hand RGB &quot;pol&quot; to use the accessory scripts for multiple trees:</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>RHand <span class="ot">&lt;-</span> </span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>  RHand <span class="sc">%&gt;%</span> </span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Pol =</span> meanRCP) <span class="sc">%&gt;%</span> </span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(phylogeny_name) <span class="sc">%&gt;%</span> </span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">Pol=</span> <span class="fu">mean</span>(Pol))</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine with reflectivity</span></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>RHandRefl <span class="ot">&lt;-</span> <span class="fu">merge</span>(ReflBySpp, RHand) </span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>RHandRefl2 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(RHandRefl) <span class="co"># create new data frame</span></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(RHandRefl2) <span class="ot">&lt;-</span> RHandRefl2[, <span class="dv">1</span>] <span class="co"># make species the row names</span></span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>RHandReflRows <span class="ot">&lt;-</span> RHandRefl2[, <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(RHandRefl2)] <span class="co"># eliminate spp name </span></span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine with absorptivity</span></span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>RHandAbs <span class="ot">&lt;-</span> <span class="fu">merge</span>(AbsBySpp, RHand) </span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>RHandAbs2 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(RHandAbs) <span class="co"># create new data frame</span></span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(RHandAbs2) <span class="ot">&lt;-</span> RHandAbs2[, <span class="dv">1</span>] <span class="co"># make species the row names</span></span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a>RHandAbsRows <span class="ot">&lt;-</span> RHandAbs2[, <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(RHandAbs2)] <span class="co"># eliminate spp name </span></span></code></pre></div>
<p>We prune the species in the tree that are not present in the
dataset</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prune extra spp in the tree, not contain in the test sample</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>PolAbs.species.MCC <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">unique</span>(PolAbs2<span class="sc">$</span>phylogeny_name))</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>PolRefl.species.MCC <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">unique</span>(PolRefl2<span class="sc">$</span>phylogeny_name))</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to &quot;row names&quot; (required for following steps)</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(PolAbs.species.MCC) <span class="ot">&lt;-</span> PolAbs.species.MCC[, <span class="dv">1</span>] </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(PolRefl.species.MCC) <span class="ot">&lt;-</span> PolRefl.species.MCC[, <span class="dv">1</span>] </span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Make sure the names in data set and tree match</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>PolAbs.temp.MCC <span class="ot">&lt;-</span> <span class="fu">name.check</span>(MCCtree, PolAbs.species.MCC)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>PolRefl.temp.MCC <span class="ot">&lt;-</span> <span class="fu">name.check</span>(MCCtree, PolRefl.species.MCC)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="co"># This step is necessary because the tips are different.</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>MCCtreeAbs <span class="ot">&lt;-</span> <span class="fu">drop.tip</span>(MCCtree, PolAbs.temp.MCC<span class="sc">$</span>tree_not_data)</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>MCCtreeRefl <span class="ot">&lt;-</span> <span class="fu">drop.tip</span>(MCCtree, PolRefl.temp.MCC<span class="sc">$</span>tree_not_data)</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Test if the species are the same</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="fu">identical</span>(</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">length</span>(<span class="fu">name.check</span>(MCCtreeAbs, PolAbs2<span class="sc">$</span>phylogeny_name)<span class="sc">$</span>tree_not_data),</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">length</span>(PolAbs2<span class="sc">$</span>phylogeny_name)</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">identical</span>(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">length</span>(<span class="fu">name.check</span>(MCCtreeRefl, PolRefl2<span class="sc">$</span>phylogeny_name)<span class="sc">$</span>tree_not_data),</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">length</span>(PolRefl2<span class="sc">$</span>phylogeny_name)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
</div>
<div id="optical-properties" class="section level1">
<h1>Optical properties</h1>
<div id="pol-degree" class="section level2">
<h2>Pol Degree</h2>
<p>This is an indication of “how much of the colour is circularly
polarised to the left”. As a simplification, we assume that this is
equivalent to most of the reflections produced by a chiral mechanism</p>
<div id="reflectivity" class="section level3">
<h3>Reflectivity</h3>
<div id="vis" class="section level4">
<h4>VIS</h4>
<p style="color: #04C799">
<p><strong>Question</strong></p>
</p>
<p><strong>Can polarisation predict visible reflectivity?</strong></p>
<p style="color: #04C799">
<p><strong>Correlation</strong></p>
</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(PolRefl<span class="sc">$</span>VIS, PolRefl<span class="sc">$</span>Pol) <span class="co"># by spp</span></span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  PolRefl$VIS and PolRefl$Pol
## t = 1.3748, df = 40, p-value = 0.1768
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.09782853  0.48503581
## sample estimates:
##       cor 
## 0.2124187</code></pre>
<p style="color: #04C799">
<p><strong>Linear model</strong></p>
</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>ModL1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(PolRefl<span class="sc">$</span>VIS <span class="sc">~</span> PolRefl<span class="sc">$</span>Pol) <span class="co"># by spp</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ModL1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = PolRefl$VIS ~ PolRefl$Pol)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -10.4974  -4.9589   0.4319   3.2515  18.8216 
## 
## Coefficients:
##             Estimate Std. Error t value       Pr(&gt;|t|)    
## (Intercept)   13.374      1.308  10.228 0.000000000001 ***
## PolRefl$Pol   10.387      7.555   1.375          0.177    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 6.831 on 40 degrees of freedom
## Multiple R-squared:  0.04512,    Adjusted R-squared:  0.02125 
## F-statistic:  1.89 on 1 and 40 DF,  p-value: 0.1768</code></pre>
<p style="color: #04C799">
<p><strong>PGLS</strong></p>
</p>
<p>Create the data frame of comparative data</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>comp_data <span class="ot">&lt;-</span> <span class="fu">comparative.data</span>(</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">phy =</span> MCCtreeRefl,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> PolRefl, <span class="co"># aggregated data without the spp in the row names</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">names.col =</span> <span class="st">&quot;phylogeny_name&quot;</span>, <span class="co"># contains the column phylogeny name</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">vcv =</span> <span class="cn">TRUE</span>,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.omit =</span> <span class="cn">FALSE</span>, <span class="at">warn.dropped =</span> <span class="cn">TRUE</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Establish the model</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>pglsPDVIS <span class="ot">&lt;-</span> <span class="fu">pgls</span>(VIS <span class="sc">~</span> Pol,</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> comp_data, <span class="at">param.CI =</span> <span class="fl">0.95</span>, <span class="at">lambda =</span> <span class="st">&quot;ML&quot;</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pglsPDVIS)</span></code></pre></div>
<pre><code>## 
## Call:
## pgls(formula = VIS ~ Pol, data = comp_data, lambda = &quot;ML&quot;, param.CI = 0.95)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -6.9624 -0.4267  0.4518  1.6000  4.4077 
## 
## Branch length transformations:
## 
## kappa  [Fix]  : 1.000
## lambda [ ML]  : 0.875
##    lower bound : 0.000, p = 0.15335
##    upper bound : 1.000, p = 0.32073
##    95.0% CI   : (NA, NA)
## delta  [Fix]  : 1.000
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)   9.4574     5.9519  1.5890   0.1199
## Pol           9.3633    10.0150  0.9349   0.3554
## 
## Residual standard error: 2.514 on 40 degrees of freedom
## Multiple R-squared: 0.02138, Adjusted R-squared: -0.00308 
## F-statistic: 0.8741 on 1 and 40 DF,  p-value: 0.3554</code></pre>
<p style="color: #04C799">
<p><strong>PGLS multiple trees</strong></p>
</p>
<p>Function</p>
<p>Note that the function has to be modified for the predictors and data
frame that we are using</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;Scripts/6_multiple_pgls_function_A.R&quot;</span>)) <span class="co"># script A is for Polarization as a response</span></span></code></pre></div>
<p>Model</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>MuPGLSPol3 <span class="ot">&lt;-</span> Response <span class="sc">~</span> Pol</span></code></pre></div>
<p>Dataset</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>PolRefl3 <span class="ot">&lt;-</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    PolReflRows <span class="sc">%&gt;%</span> <span class="co"># phylogeny names in rows</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(Pol, VIS) <span class="sc">%&gt;%</span> </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;Response&quot;</span> <span class="ot">=</span> VIS)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>PolRefl3 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(PolRefl3)</span></code></pre></div>
<p>Apply</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>runsPol3 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(trees[trees_subset_min<span class="sc">:</span>trees_subset_max],</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>                   pgls_runA, <span class="at">model =</span> MuPGLSPol3, <span class="at">dataset =</span> PolRefl3)</span></code></pre></div>
<pre><code>## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>dfPol3 <span class="ot">&lt;-</span> <span class="fu">ldply</span>(runsPol3, data.frame)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(dfPol3[,<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 1000</code></pre>
<p>Get results</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">HPDinterval</span>(<span class="fu">as.mcmc</span>(dfPol3))</span></code></pre></div>
<pre><code>##                lower      upper
## estimateP1 3.1343929 13.3374537
## ts1        0.3411226  1.3949166
## ps1        0.1568928  0.7054531
## attr(,&quot;Probability&quot;)
## [1] 0.95</code></pre>
<p><span style="color: #04C799"><strong>Conclusion</strong></span>
<br/></p>
<p><strong>There’s no correlation between visible reflectivity and
polarisation at the species level.</strong></p>
<p><br> <br> <br></p>
</div>
<div id="nir" class="section level4">
<h4>NIR</h4>
<p style="color: #04C799">
<p><strong>Question</strong></p>
</p>
<p><strong>Is polarisation correlated with NIR
reflectivity?</strong></p>
<p style="color: #04C799">
<p><strong>Correlation</strong></p>
</p>
<p>Species level:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(PolRefl<span class="sc">$</span>NIR, PolRefl<span class="sc">$</span>Pol) <span class="co"># by spp</span></span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  PolRefl$NIR and PolRefl$Pol
## t = -0.98424, df = 40, p-value = 0.3309
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.4372662  0.1575225
## sample estimates:
##        cor 
## -0.1537708</code></pre>
<p style="color: #04C799">
<p><strong>Linear model</strong></p>
</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>ModL2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(PolRefl<span class="sc">$</span>NIR <span class="sc">~</span> PolRefl<span class="sc">$</span>Pol <span class="sc">+</span> PolRefl<span class="sc">$</span>VIS) <span class="co"># by spp</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ModL2)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = PolRefl$NIR ~ PolRefl$Pol + PolRefl$VIS)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -8.9085 -2.8564  0.3102  3.1581 11.5848 
## 
## Coefficients:
##             Estimate Std. Error t value             Pr(&gt;|t|)    
## (Intercept)   24.854      1.588  15.653 &lt; 0.0000000000000002 ***
## PolRefl$Pol  -20.238      4.938  -4.099             0.000204 ***
## PolRefl$VIS    1.063      0.101  10.531     0.00000000000058 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.363 on 39 degrees of freedom
## Multiple R-squared:  0.746,  Adjusted R-squared:  0.733 
## F-statistic: 57.26 on 2 and 39 DF,  p-value: 0.000000000002483</code></pre>
<p style="color: #04C799">
<p><strong>PGLS</strong></p>
</p>
<p>The data frame of comparative data is the same as for visible
light</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>pglsPDNIR <span class="ot">&lt;-</span> <span class="fu">pgls</span>(NIR <span class="sc">~</span> Pol <span class="sc">+</span> VIS,</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> comp_data, <span class="at">param.CI =</span> <span class="fl">0.95</span>, <span class="at">lambda =</span> <span class="st">&quot;ML&quot;</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pglsPDNIR)</span></code></pre></div>
<pre><code>## 
## Call:
## pgls(formula = NIR ~ Pol + VIS, data = comp_data, lambda = &quot;ML&quot;, 
##     param.CI = 0.95)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2.25566 -0.61317  0.05004  0.73500  2.58307 
## 
## Branch length transformations:
## 
## kappa  [Fix]  : 1.000
## lambda [ ML]  : 0.000
##    lower bound : 0.000, p = 1    
##    upper bound : 1.000, p = 0.00023001
##    95.0% CI   : (NA, 0.832)
## delta  [Fix]  : 1.000
## 
## Coefficients:
##              Estimate Std. Error t value              Pr(&gt;|t|)    
## (Intercept)  24.85385    1.58780 15.6530 &lt; 0.00000000000000022 ***
## Pol         -20.23845    4.93766 -4.0988             0.0002036 ***
## VIS           1.06337    0.10098 10.5309    0.0000000000005795 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.048 on 39 degrees of freedom
## Multiple R-squared: 0.746,   Adjusted R-squared: 0.733 
## F-statistic: 57.26 on 2 and 39 DF,  p-value: 0.000000000002483</code></pre>
<p style="color: #04C799">
<p><strong>PGLS multiple trees</strong></p>
</p>
<p>Function</p>
<p>Note that the function has to be modified for the predictors and data
frame that we are using</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;Scripts/13_multiple_pgls_function_H.R&quot;</span>)) <span class="co"># script H is for Polarization as a predictor</span></span></code></pre></div>
<p>Model</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>MuPGLSPol4 <span class="ot">&lt;-</span> Response <span class="sc">~</span> Pol <span class="sc">+</span> VIS</span></code></pre></div>
<p>Dataset</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>PolRefl4 <span class="ot">&lt;-</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    PolReflRows <span class="sc">%&gt;%</span> <span class="co"># phylogeny names in rows</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(Pol, VIS, NIR) <span class="sc">%&gt;%</span> </span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;Response&quot;</span> <span class="ot">=</span> NIR)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>PolRefl4 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(PolRefl4)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(PolRefl4<span class="sc">$</span>Pol)</span></code></pre></div>
<pre><code>## [1] 42</code></pre>
<p>Apply</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>runsPol4 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(trees[trees_subset_min<span class="sc">:</span>trees_subset_max],</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>                   pgls_runH, <span class="at">model =</span> MuPGLSPol4, <span class="at">dataset =</span> PolRefl4)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>dfPol4 <span class="ot">&lt;-</span> <span class="fu">ldply</span>(runsPol4, data.frame)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(dfPol4[,<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 1001</code></pre>
<p>Get results</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">HPDinterval</span>(<span class="fu">as.mcmc</span>(dfPol4))</span></code></pre></div>
<pre><code>##                              lower                   upper
## estimateP1 -20.2384529413432687761 -19.0080070342819738016
## ts1         -4.0987982503145756752  -3.3330352524410287174
## ps1          0.0002035776028979086   0.0018902982560042858
## estimateP2   1.0446033217726025111   1.0633688517341663982
## tP2         10.3421952599614090929  10.5308729889663279522
## pP2          0.0000000000005795364   0.0000000000009783285
## attr(,&quot;Probability&quot;)
## [1] 0.95005</code></pre>
</div>
<div id="frs" class="section level4">
<h4>FRS</h4>
<p style="color: #04C799">
<p><strong>Question</strong></p>
</p>
<p><strong>Is polarisation correlated with the NIR residuals corrected
by phylogeny?</strong></p>
<p style="color: #04C799">
<p><strong>Correlation</strong></p>
</p>
<p>Species level:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(PolRefl<span class="sc">$</span>FRS, PolRefl<span class="sc">$</span>Pol) <span class="co"># by spp</span></span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  PolRefl$FRS and PolRefl$Pol
## t = -4.2365, df = 40, p-value = 0.0001296
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.7359742 -0.3040243
## sample estimates:
##        cor 
## -0.5565308</code></pre>
<p style="color: #04C799">
<p><strong>Linear model</strong></p>
</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>ModL3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(PolRefl<span class="sc">$</span>FRS <span class="sc">~</span> PolRefl<span class="sc">$</span>Pol) <span class="co"># by spp</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ModL3)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = PolRefl$FRS ~ PolRefl$Pol)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -8.9032 -2.7627  0.3213  3.1546 11.6020 
## 
## Coefficients:
##             Estimate Std. Error t value     Pr(&gt;|t|)    
## (Intercept)  -5.4607     0.8246  -6.622 0.0000000632 ***
## PolRefl$Pol -20.1846     4.7644  -4.237      0.00013 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.308 on 40 degrees of freedom
## Multiple R-squared:  0.3097, Adjusted R-squared:  0.2925 
## F-statistic: 17.95 on 1 and 40 DF,  p-value: 0.0001296</code></pre>
<p style="color: #04C799">
<p><strong>PGLS</strong></p>
</p>
<p>The data frame of comparative data is the same as for visible
light</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>pglsPDFRS <span class="ot">&lt;-</span> <span class="fu">pgls</span>(FRS <span class="sc">~</span> Pol,</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> comp_data, <span class="at">param.CI =</span> <span class="fl">0.95</span>, <span class="at">lambda =</span> <span class="st">&quot;ML&quot;</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pglsPDFRS)</span></code></pre></div>
<pre><code>## 
## Call:
## pgls(formula = FRS ~ Pol, data = comp_data, lambda = &quot;ML&quot;, param.CI = 0.95)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2.26105 -0.61368  0.05559  0.72304  2.58064 
## 
## Branch length transformations:
## 
## kappa  [Fix]  : 1.000
## lambda [ ML]  : 0.000
##    lower bound : 0.000, p = 1    
##    upper bound : 1.000, p = 0.00021248
##    95.0% CI   : (NA, 0.826)
## delta  [Fix]  : 1.000
## 
## Coefficients:
##              Estimate Std. Error t value      Pr(&gt;|t|)    
## (Intercept)  -5.46072    0.82461 -6.6222 0.00000006321 ***
## Pol         -20.18460    4.76444 -4.2365     0.0001296 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.035 on 40 degrees of freedom
## Multiple R-squared: 0.3097,  Adjusted R-squared: 0.2925 
## F-statistic: 17.95 on 1 and 40 DF,  p-value: 0.0001296</code></pre>
<p style="color: #04C799">
<p><strong>PGLS multiple trees</strong></p>
</p>
<p>Dataset</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>PolRefl5 <span class="ot">&lt;-</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>    PolReflRows <span class="sc">%&gt;%</span> <span class="co"># phylogeny names in rows</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(Pol, FRS) <span class="sc">%&gt;%</span> </span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;Response&quot;</span> <span class="ot">=</span> FRS)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>PolRefl5 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(PolRefl5)</span></code></pre></div>
<p>Apply</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>runsPol5 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(trees[trees_subset_min<span class="sc">:</span>trees_subset_max],</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>                   pgls_runA, <span class="at">model =</span> MuPGLSPol3, <span class="at">dataset =</span> PolRefl5)</span></code></pre></div>
<pre><code>## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>dfPol5 <span class="ot">&lt;-</span> <span class="fu">ldply</span>(runsPol5, data.frame)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(dfPol5[,<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 1000</code></pre>
<p>Get results</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">HPDinterval</span>(<span class="fu">as.mcmc</span>(dfPol5))</span></code></pre></div>
<pre><code>##                     lower        upper
## estimateP1 -20.1846083423 -19.44409171
## ts1         -4.2365125038  -3.54355037
## ps1          0.0001295554   0.00102159
## attr(,&quot;Probability&quot;)
## [1] 0.95</code></pre>
</div>
</div>
<div id="absorptivity" class="section level3">
<h3>Absorptivity</h3>
<div id="vis-1" class="section level4">
<h4>VIS</h4>
<p style="color: #04C799">
<p><strong>Question</strong></p>
</p>
<p><strong>Can polarisation predict visible absorptivity?</strong></p>
<p style="color: #04C799">
<p><strong>Correlation</strong></p>
</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(PolAbs<span class="sc">$</span>VIS, PolAbs<span class="sc">$</span>Pol) <span class="co"># by spp</span></span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  PolAbs$VIS and PolAbs$Pol
## t = -0.012444, df = 19, p-value = 0.9902
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.4340068  0.4293611
## sample estimates:
##          cor 
## -0.002854879</code></pre>
<p style="color: #04C799">
<p><strong>Linear model</strong></p>
</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>ModL1Abs <span class="ot">&lt;-</span> <span class="fu">lm</span>(PolAbs<span class="sc">$</span>VIS <span class="sc">~</span> PolAbs<span class="sc">$</span>Pol) <span class="co"># by spp</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ModL1Abs)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = PolAbs$VIS ~ PolAbs$Pol)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -23.6026  -3.7674  -0.0883   8.9576  14.7073 
## 
## Coefficients:
##             Estimate Std. Error t value            Pr(&gt;|t|)    
## (Intercept)   79.571      3.206  24.816 0.00000000000000061 ***
## PolAbs$Pol    -0.190     15.270  -0.012                0.99    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 11.05 on 19 degrees of freedom
## Multiple R-squared:  8.15e-06,   Adjusted R-squared:  -0.05262 
## F-statistic: 0.0001549 on 1 and 19 DF,  p-value: 0.9902</code></pre>
<p style="color: #04C799">
<p><strong>PGLS</strong></p>
</p>
<p>Create the data frame of comparative data</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>CompDataAbs <span class="ot">&lt;-</span> <span class="fu">comparative.data</span>(</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">phy =</span> MCCtreeAbs,</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> PolAbs, <span class="co"># aggregated data without the spp in the row names</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">names.col =</span> <span class="st">&quot;phylogeny_name&quot;</span>, <span class="co"># contains the column phylogeny name</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">vcv =</span> <span class="cn">TRUE</span>,</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.omit =</span> <span class="cn">FALSE</span>, <span class="at">warn.dropped =</span> <span class="cn">TRUE</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Establish the model</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>pglsPDVISAbs <span class="ot">&lt;-</span> <span class="fu">pgls</span>(VIS <span class="sc">~</span> Pol,</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> CompDataAbs, <span class="at">param.CI =</span> <span class="fl">0.95</span>, <span class="at">lambda =</span> <span class="st">&quot;ML&quot;</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pglsPDVISAbs)</span></code></pre></div>
<pre><code>## 
## Call:
## pgls(formula = VIS ~ Pol, data = CompDataAbs, lambda = &quot;ML&quot;, 
##     param.CI = 0.95)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -6.6510 -0.7746  0.5707  2.7049  9.7865 
## 
## Branch length transformations:
## 
## kappa  [Fix]  : 1.000
## lambda [ ML]  : 0.973
##    lower bound : 0.000, p = 0.14709
##    upper bound : 1.000, p = 0.55963
##    95.0% CI   : (NA, NA)
## delta  [Fix]  : 1.000
## 
## Coefficients:
##             Estimate Std. Error t value     Pr(&gt;|t|)    
## (Intercept)  80.0709    10.8307  7.3929 0.0000005301 ***
## Pol           8.5603    19.3596  0.4422       0.6634    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.134 on 19 degrees of freedom
## Multiple R-squared: 0.01019, Adjusted R-squared: -0.04191 
## F-statistic: 0.1955 on 1 and 19 DF,  p-value: 0.6634</code></pre>
<p style="color: #04C799">
<p><strong>PGLS multiple trees</strong></p>
</p>
<p>Dataset</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>PolAbs3 <span class="ot">&lt;-</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>    PolAbsRows <span class="sc">%&gt;%</span> <span class="co"># phylogeny names in rows</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(Pol, VIS) <span class="sc">%&gt;%</span> </span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;Response&quot;</span> <span class="ot">=</span> VIS)</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>PolAbs3 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(PolAbs3)</span></code></pre></div>
<p>Apply</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>runsPol6 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(trees[trees_subset_min<span class="sc">:</span>trees_subset_max],</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>                   pgls_runA, <span class="at">model =</span> MuPGLSPol3, <span class="at">dataset =</span> PolAbs3)</span></code></pre></div>
<pre><code>## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>dfPol6 <span class="ot">&lt;-</span> <span class="fu">ldply</span>(runsPol6, data.frame)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(dfPol6[,<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 960</code></pre>
<p>Get results</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">HPDinterval</span>(<span class="fu">as.mcmc</span>(dfPol6))</span></code></pre></div>
<pre><code>##                  lower      upper
## estimateP1 -0.19004396 17.5596701
## ts1        -0.01244528  0.9539945
## ps1         0.35206704  0.9902008
## attr(,&quot;Probability&quot;)
## [1] 0.95</code></pre>
<p><span style="color: #04C799"><strong>Conclusion</strong></span>
<br/></p>
<p><strong>There’s no correlation between visible absorptivity and
polarisation at the species level.</strong></p>
<p><br> <br> <br></p>
</div>
<div id="nir-1" class="section level4">
<h4>NIR</h4>
<p style="color: #04C799">
<p><strong>Question</strong></p>
</p>
<p><strong>Is polarisation correlated with NIR
absorptivity?</strong></p>
<p style="color: #04C799">
<p><strong>Correlation</strong></p>
</p>
<p>Species level:</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(PolAbs<span class="sc">$</span>NIR, PolAbs<span class="sc">$</span>Pol) <span class="co"># by spp</span></span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  PolAbs$NIR and PolAbs$Pol
## t = 0.33542, df = 19, p-value = 0.741
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.3671231  0.4921109
## sample estimates:
##        cor 
## 0.07672295</code></pre>
<p style="color: #04C799">
<p><strong>Linear model</strong></p>
</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>ModL2Abs <span class="ot">&lt;-</span> <span class="fu">lm</span>(PolAbs<span class="sc">$</span>NIR <span class="sc">~</span> PolAbs<span class="sc">$</span>Pol <span class="sc">+</span> PolAbs<span class="sc">$</span>VIS) <span class="co"># by spp</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ModL2Abs)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = PolAbs$NIR ~ PolAbs$Pol + PolAbs$VIS)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -13.0173  -1.0129   0.6361   2.4295  11.9533 
## 
## Coefficients:
##             Estimate Std. Error t value      Pr(&gt;|t|)    
## (Intercept) -69.4722    10.2698  -6.765 0.00000244642 ***
## PolAbs$Pol    7.6601     8.4612   0.905         0.377    
## PolAbs$VIS    1.3414     0.1271  10.553 0.00000000388 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 6.123 on 18 degrees of freedom
## Multiple R-squared:  0.8617, Adjusted R-squared:  0.8463 
## F-statistic: 56.06 on 2 and 18 DF,  p-value: 0.00000001855</code></pre>
<p style="color: #04C799">
<p><strong>PGLS</strong></p>
</p>
<p>The data frame of comparative data is the same as for visible
light</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>pglsPDNIRAbs <span class="ot">&lt;-</span> <span class="fu">pgls</span>(NIR <span class="sc">~</span> Pol <span class="sc">+</span> VIS,</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> CompDataAbs, <span class="at">param.CI =</span> <span class="fl">0.95</span>, <span class="at">lambda =</span> <span class="st">&quot;ML&quot;</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pglsPDNIRAbs)</span></code></pre></div>
<pre><code>## 
## Call:
## pgls(formula = NIR ~ Pol + VIS, data = CompDataAbs, lambda = &quot;ML&quot;, 
##     param.CI = 0.95)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2.2818 -1.1367 -0.7468  0.7005  2.1609 
## 
## Branch length transformations:
## 
## kappa  [Fix]  : 1.000
## lambda [ ML]  : 0.000
##    lower bound : 0.000, p = 1    
##    upper bound : 1.000, p = 0.025945
##    95.0% CI   : (NA, 0.932)
## delta  [Fix]  : 1.000
## 
## Coefficients:
##              Estimate Std. Error t value       Pr(&gt;|t|)    
## (Intercept) -69.47219   10.26976 -6.7647 0.000002446418 ***
## Pol           7.66009    8.46123  0.9053         0.3773    
## VIS           1.34142    0.12712 10.5526 0.000000003879 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.47 on 18 degrees of freedom
## Multiple R-squared: 0.8617,  Adjusted R-squared: 0.8463 
## F-statistic: 56.06 on 2 and 18 DF,  p-value: 0.00000001855</code></pre>
<p style="color: #04C799">
<p><strong>PGLS multiple trees</strong></p>
</p>
<p>Dataset</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>PolAbs4 <span class="ot">&lt;-</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>    PolAbsRows <span class="sc">%&gt;%</span> <span class="co"># phylogeny names in rows</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(Pol, VIS, NIR) <span class="sc">%&gt;%</span> </span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;Response&quot;</span> <span class="ot">=</span> NIR)</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>PolAbs4 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(PolAbs4)</span></code></pre></div>
<p>Apply</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>runsPol7 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(trees[trees_subset_min<span class="sc">:</span>trees_subset_max],</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>                   pgls_runH, <span class="at">model =</span> MuPGLSPol4, <span class="at">dataset =</span> PolAbs4)</span></code></pre></div>
<pre><code>## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>dfPol7 <span class="ot">&lt;-</span> <span class="fu">ldply</span>(runsPol7, data.frame)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(dfPol7[,<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 1000</code></pre>
<p>Get results</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">HPDinterval</span>(<span class="fu">as.mcmc</span>(dfPol7))</span></code></pre></div>
<pre><code>##                         lower              upper
## estimateP1  7.660094914901437  7.660099409000678
## ts1         0.905317536902053  0.905318037132289
## ps1         0.377255765964919  0.377256023817372
## estimateP2  1.341424192136824  1.341424236910118
## tP2        10.552631804039306 10.552633288832789
## pP2         0.000000003878582  0.000000003878591
## attr(,&quot;Probability&quot;)
## [1] 0.95</code></pre>
</div>
<div id="frs-1" class="section level4">
<h4>FRS</h4>
<p style="color: #04C799">
<p><strong>Question</strong></p>
</p>
<p><strong>Is polarisation correlated with the NIR residuals corrected
by phylogeny?</strong></p>
<p style="color: #04C799">
<p><strong>Correlation</strong></p>
</p>
<p>Species level:</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(PolAbs<span class="sc">$</span>FRS, PolAbs<span class="sc">$</span>Pol) <span class="co"># by spp</span></span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  PolAbs$FRS and PolAbs$Pol
## t = 0.93021, df = 19, p-value = 0.3639
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.2450606  0.5874641
## sample estimates:
##      cor 
## 0.208705</code></pre>
<p style="color: #04C799">
<p><strong>Linear model</strong></p>
</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>ModL3Abs <span class="ot">&lt;-</span> <span class="fu">lm</span>(PolAbs<span class="sc">$</span>FRS <span class="sc">~</span> PolAbs<span class="sc">$</span>Pol) <span class="co"># by spp</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ModL3Abs)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = PolAbs$FRS ~ PolAbs$Pol)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -13.0703  -0.8889   0.6560   2.5562  11.8883 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    8.352      1.729   4.829 0.000116 ***
## PolAbs$Pol     7.661      8.236   0.930 0.363932    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.96 on 19 degrees of freedom
## Multiple R-squared:  0.04356,    Adjusted R-squared:  -0.006781 
## F-statistic: 0.8653 on 1 and 19 DF,  p-value: 0.3639</code></pre>
<p style="color: #04C799">
<p><strong>PGLS</strong></p>
</p>
<p>The data frame of comparative data is the same as for visible
light</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>pglsPDFRSAbs <span class="ot">&lt;-</span> <span class="fu">pgls</span>(FRS <span class="sc">~</span> Pol,</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> CompDataAbs, <span class="at">param.CI =</span> <span class="fl">0.95</span>, <span class="at">lambda =</span> <span class="st">&quot;ML&quot;</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pglsPDFRSAbs)</span></code></pre></div>
<pre><code>## 
## Call:
## pgls(formula = FRS ~ Pol, data = CompDataAbs, lambda = &quot;ML&quot;, 
##     param.CI = 0.95)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2.2452 -1.1255 -0.7412  0.6997  2.1831 
## 
## Branch length transformations:
## 
## kappa  [Fix]  : 1.000
## lambda [ ML]  : 0.000
##    lower bound : 0.000, p = 1    
##    upper bound : 1.000, p = 0.024803
##    95.0% CI   : (NA, 0.931)
## delta  [Fix]  : 1.000
## 
## Coefficients:
##             Estimate Std. Error t value  Pr(&gt;|t|)    
## (Intercept)   8.3518     1.7294  4.8294 0.0001165 ***
## Pol           7.6612     8.2360  0.9302 0.3639322    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.431 on 19 degrees of freedom
## Multiple R-squared: 0.04356, Adjusted R-squared: -0.006781 
## F-statistic: 0.8653 on 1 and 19 DF,  p-value: 0.3639</code></pre>
<p style="color: #04C799">
<p><strong>PGLS multiple trees</strong></p>
</p>
<p>Dataset</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>PolAbs5 <span class="ot">&lt;-</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>    PolAbsRows <span class="sc">%&gt;%</span> <span class="co"># phylogeny names in rows</span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(Pol, FRS) <span class="sc">%&gt;%</span> </span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;Response&quot;</span> <span class="ot">=</span> FRS)</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>PolAbs5 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(PolAbs5)</span></code></pre></div>
<p>Apply</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>runsPol8 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(trees[trees_subset_min<span class="sc">:</span>trees_subset_max],</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>                   pgls_runA, <span class="at">model =</span> MuPGLSPol3, <span class="at">dataset =</span> PolAbs5)</span></code></pre></div>
<pre><code>## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>dfPol8 <span class="ot">&lt;-</span> <span class="fu">ldply</span>(runsPol8, data.frame)</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(dfPol8[,<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 1000</code></pre>
<p>Get results</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">HPDinterval</span>(<span class="fu">as.mcmc</span>(dfPol8))</span></code></pre></div>
<pre><code>##                lower     upper
## estimateP1 7.6612072 7.6612117
## ts1        0.9302082 0.9302088
## ps1        0.3639320 0.3639323
## attr(,&quot;Probability&quot;)
## [1] 0.95</code></pre>
</div>
</div>
</div>
<div id="right-handed-pol" class="section level2">
<h2>Right handed Pol</h2>
<div id="reflectivity-1" class="section level3">
<h3>Reflectivity</h3>
<div id="vis-2" class="section level4">
<h4>VIS</h4>
<p style="color: #04C799">
<p><strong>Question</strong></p>
</p>
<p><strong>Can the darkness in the underlaying pigment affect the
visible reflectivity?</strong></p>
<p style="color: #04C799">
<p><strong>Correlation</strong></p>
</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(RHandRefl<span class="sc">$</span>VIS, RHandRefl<span class="sc">$</span>Pol) <span class="co"># by spp</span></span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  RHandRefl$VIS and RHandRefl$Pol
## t = 4.3441, df = 40, p-value = 0.00009303
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.3167468 0.7423607
## sample estimates:
##       cor 
## 0.5661731</code></pre>
<p style="color: #04C799">
<p><strong>Linear model</strong></p>
</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>ModL1RH <span class="ot">&lt;-</span> <span class="fu">lm</span>(RHandRefl<span class="sc">$</span>VIS <span class="sc">~</span> RHandRefl<span class="sc">$</span>Pol) <span class="co"># by spp</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ModL1RH)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = RHandRefl$VIS ~ RHandRefl$Pol)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -7.168 -3.737 -1.561  1.309 21.874 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)     2.5867     2.8693   0.901    0.373    
## RHandRefl$Pol   2.6162     0.6022   4.344 0.000093 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.762 on 40 degrees of freedom
## Multiple R-squared:  0.3206, Adjusted R-squared:  0.3036 
## F-statistic: 18.87 on 1 and 40 DF,  p-value: 0.00009303</code></pre>
<p style="color: #04C799">
<p><strong>PGLS</strong></p>
</p>
<p>Create the data frame of comparative data</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>comp_dataRH <span class="ot">&lt;-</span> <span class="fu">comparative.data</span>(</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">phy =</span> MCCtreeRefl,</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> RHandRefl, <span class="co"># aggregated data without the spp in the row names</span></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">names.col =</span> <span class="st">&quot;phylogeny_name&quot;</span>, <span class="co"># contains the column phylogeny name</span></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">vcv =</span> <span class="cn">TRUE</span>,</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.omit =</span> <span class="cn">FALSE</span>, <span class="at">warn.dropped =</span> <span class="cn">TRUE</span></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Establish the model</p>
<div class="sourceCode" id="cb100"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>pglsPDVISRH <span class="ot">&lt;-</span> <span class="fu">pgls</span>(VIS <span class="sc">~</span> Pol,</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> comp_dataRH, <span class="at">param.CI =</span> <span class="fl">0.95</span>, <span class="at">lambda =</span> <span class="st">&quot;ML&quot;</span></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pglsPDVISRH)</span></code></pre></div>
<pre><code>## 
## Call:
## pgls(formula = VIS ~ Pol, data = comp_dataRH, lambda = &quot;ML&quot;, 
##     param.CI = 0.95)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.2417 -0.7503  0.3467  1.3058  6.4072 
## 
## Branch length transformations:
## 
## kappa  [Fix]  : 1.000
## lambda [ ML]  : 0.948
##    lower bound : 0.000, p = 0.0007746
##    upper bound : 1.000, p = 0.14876
##    95.0% CI   : (0.719, NA)
## delta  [Fix]  : 1.000
## 
## Coefficients:
##             Estimate Std. Error t value    Pr(&gt;|t|)    
## (Intercept)  1.06687    5.25844  0.2029      0.8403    
## Pol          2.57717    0.45862  5.6194 0.000001619 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.112 on 40 degrees of freedom
## Multiple R-squared: 0.4412,  Adjusted R-squared: 0.4272 
## F-statistic: 31.58 on 1 and 40 DF,  p-value: 0.000001619</code></pre>
<p style="color: #04C799">
<p><strong>PGLS multiple trees</strong></p>
</p>
<p>Function</p>
<p>Note that the function has to be modified for the predictors and data
frame that we are using</p>
<div class="sourceCode" id="cb102"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;Scripts/6_multiple_pgls_function_A.R&quot;</span>)) <span class="co"># script A is for Polarization as a response</span></span></code></pre></div>
<p>Model</p>
<div class="sourceCode" id="cb103"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>MuPGLSPol3 <span class="ot">&lt;-</span> Response <span class="sc">~</span> Pol</span></code></pre></div>
<p>Dataset</p>
<div class="sourceCode" id="cb104"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>RHandRefl3 <span class="ot">&lt;-</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>    RHandReflRows <span class="sc">%&gt;%</span> <span class="co"># phylogeny names in rows</span></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(Pol, VIS) <span class="sc">%&gt;%</span> </span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;Response&quot;</span> <span class="ot">=</span> VIS)</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>RHandRefl3 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(RHandRefl3)</span></code></pre></div>
<p>Apply</p>
<div class="sourceCode" id="cb105"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>runsRHPol3 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(trees[trees_subset_min<span class="sc">:</span>trees_subset_max],</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>                   pgls_runA, <span class="at">model =</span> MuPGLSPol3, <span class="at">dataset =</span> RHandRefl3)</span></code></pre></div>
<pre><code>## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH</code></pre>
<div class="sourceCode" id="cb107"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>dfRHPol3 <span class="ot">&lt;-</span> <span class="fu">ldply</span>(runsRHPol3, data.frame)</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(dfRHPol3[,<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 989</code></pre>
<p>Get results</p>
<div class="sourceCode" id="cb109"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">HPDinterval</span>(<span class="fu">as.mcmc</span>(dfRHPol3))</span></code></pre></div>
<pre><code>##                       lower          upper
## estimateP1 2.38593639691057 2.815684962779
## ts1        5.18844277798936 6.317166520323
## ps1        0.00000003188983 0.000005007898
## attr(,&quot;Probability&quot;)
## [1] 0.950455</code></pre>
<p><span style="color: #04C799"><strong>Conclusion</strong></span>
<br/></p>
<p><strong>PENDING.</strong></p>
<p><br> <br> <br></p>
</div>
<div id="nir-2" class="section level4">
<h4>NIR</h4>
<p style="color: #04C799">
<p><strong>Question</strong></p>
</p>
<p><strong>Can the darkness in the underlaying pigment affect the NIR
reflectivity?</strong></p>
<p style="color: #04C799">
<p><strong>Correlation</strong></p>
</p>
<p>Species level:</p>
<div class="sourceCode" id="cb111"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(RHandRefl<span class="sc">$</span>NIR, RHandRefl<span class="sc">$</span>Pol) <span class="co"># by spp</span></span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  RHandRefl$NIR and RHandRefl$Pol
## t = 5.5789, df = 40, p-value = 0.000001846
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.4475682 0.8038311
## sample estimates:
##       cor 
## 0.6615138</code></pre>
<p style="color: #04C799">
<p><strong>Linear model</strong></p>
</p>
<div class="sourceCode" id="cb113"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>ModL2RH <span class="ot">&lt;-</span> <span class="fu">lm</span>(RHandRefl<span class="sc">$</span>NIR <span class="sc">~</span> RHandRefl<span class="sc">$</span>Pol <span class="sc">+</span> RHandRefl<span class="sc">$</span>VIS) <span class="co"># by spp</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ModL2RH)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = RHandRefl$NIR ~ RHandRefl$Pol + RHandRefl$VIS)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -8.1608 -3.3970  0.2871  3.4140  8.9805 
## 
## Coefficients:
##               Estimate Std. Error t value       Pr(&gt;|t|)    
## (Intercept)    19.2340     2.3793   8.084 0.000000000732 ***
## RHandRefl$Pol   1.7444     0.5998   2.908        0.00597 ** 
## RHandRefl$VIS   0.7617     0.1298   5.868 0.000000789023 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.73 on 39 degrees of freedom
## Multiple R-squared:  0.7013, Adjusted R-squared:  0.686 
## F-statistic: 45.79 on 2 and 39 DF,  p-value: 0.00000000005837</code></pre>
<p style="color: #04C799">
<p><strong>PGLS</strong></p>
</p>
<p>The data frame of comparative data is the same as for visible
light</p>
<div class="sourceCode" id="cb115"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>pglsPDNIRRH <span class="ot">&lt;-</span> <span class="fu">pgls</span>(NIR <span class="sc">~</span> Pol <span class="sc">+</span> VIS,</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> comp_dataRH, <span class="at">param.CI =</span> <span class="fl">0.95</span>, <span class="at">lambda =</span> <span class="st">&quot;ML&quot;</span></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pglsPDNIRRH)</span></code></pre></div>
<pre><code>## 
## Call:
## pgls(formula = NIR ~ Pol + VIS, data = comp_dataRH, lambda = &quot;ML&quot;, 
##     param.CI = 0.95)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2.9031 -0.9867 -0.5800  0.4416  3.1376 
## 
## Branch length transformations:
## 
## kappa  [Fix]  : 1.000
## lambda [ ML]  : 0.547
##    lower bound : 0.000, p = 0.32623
##    upper bound : 1.000, p = 0.0027707
##    95.0% CI   : (NA, 0.933)
## delta  [Fix]  : 1.000
## 
## Coefficients:
##             Estimate Std. Error t value     Pr(&gt;|t|)    
## (Intercept) 20.98072    3.29190  6.3734 0.0000001570 ***
## Pol          1.23339    0.60744  2.0305      0.04917 *  
## VIS          0.80997    0.13593  5.9589 0.0000005907 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.356 on 39 degrees of freedom
## Multiple R-squared: 0.6922,  Adjusted R-squared: 0.6764 
## F-statistic: 43.85 on 2 and 39 DF,  p-value: 0.000000000105</code></pre>
<p style="color: #04C799">
<p><strong>PGLS multiple trees</strong></p>
</p>
<p>Function</p>
<p>Note that the function has to be modified for the predictors and data
frame that we are using</p>
<div class="sourceCode" id="cb117"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;Scripts/13_multiple_pgls_function_H.R&quot;</span>)) <span class="co"># script A is for Polarization as a response</span></span></code></pre></div>
<p>Model</p>
<div class="sourceCode" id="cb118"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>MuPGLSPol4 <span class="ot">&lt;-</span> Response <span class="sc">~</span> Pol <span class="sc">+</span> VIS</span></code></pre></div>
<p>Dataset</p>
<div class="sourceCode" id="cb119"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>RHandRefl4 <span class="ot">&lt;-</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>    RHandReflRows <span class="sc">%&gt;%</span> <span class="co"># phylogeny names in rows</span></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(Pol, VIS, NIR) <span class="sc">%&gt;%</span> </span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;Response&quot;</span> <span class="ot">=</span> NIR)</span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>RHandRefl4 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(RHandRefl4)</span></code></pre></div>
<p>Apply</p>
<div class="sourceCode" id="cb120"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>runsRHPol4 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(trees[trees_subset_min<span class="sc">:</span>trees_subset_max],</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>                   pgls_runH, <span class="at">model =</span> MuPGLSPol4, <span class="at">dataset =</span> RHandRefl4)</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>dfRHPol4 <span class="ot">&lt;-</span> <span class="fu">ldply</span>(runsRHPol4, data.frame)</span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(dfRHPol4[,<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 1001</code></pre>
<p>Get results</p>
<div class="sourceCode" id="cb122"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">HPDinterval</span>(<span class="fu">as.mcmc</span>(dfRHPol4))</span></code></pre></div>
<pre><code>##                     lower          upper
## estimateP1 1.094772337238 1.399996461732
## ts1        1.787603918459 2.288182630668
## ps1        0.024712922809 0.075434993034
## estimateP2 0.772205679303 0.835260771457
## tP2        5.603581786223 6.172203061114
## pP2        0.000000199416 0.000001658501
## attr(,&quot;Probability&quot;)
## [1] 0.95005</code></pre>
</div>
<div id="frs-2" class="section level4">
<h4>FRS</h4>
<p style="color: #04C799">
<p><strong>Question</strong></p>
</p>
<p><strong>Can the darkness in the underlaying pigment affect the NIR
reflectivity?</strong></p>
<p style="color: #04C799">
<p><strong>Correlation</strong></p>
</p>
<p>Species level:</p>
<div class="sourceCode" id="cb124"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(RHandRefl<span class="sc">$</span>FRS, RHandRefl<span class="sc">$</span>Pol) <span class="co"># by spp</span></span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  RHandRefl$FRS and RHandRefl$Pol
## t = 1.8638, df = 40, p-value = 0.0697
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.02325426  0.54019604
## sample estimates:
##      cor 
## 0.282675</code></pre>
<p style="color: #04C799">
<p><strong>Linear model</strong></p>
</p>
<div class="sourceCode" id="cb126"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>ModL3RH <span class="ot">&lt;-</span> <span class="fu">lm</span>(RHandRefl<span class="sc">$</span>FRS <span class="sc">~</span> RHandRefl<span class="sc">$</span>Pol) <span class="co"># by spp</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ModL3RH)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = RHandRefl$FRS ~ RHandRefl$Pol)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -9.0141 -4.1551  0.1555  4.2004  9.2638 
## 
## Coefficients:
##               Estimate Std. Error t value  Pr(&gt;|t|)    
## (Intercept)   -11.9167     2.4766  -4.812 0.0000215 ***
## RHandRefl$Pol   0.9688     0.5198   1.864    0.0697 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.973 on 40 degrees of freedom
## Multiple R-squared:  0.07991,    Adjusted R-squared:  0.0569 
## F-statistic: 3.474 on 1 and 40 DF,  p-value: 0.0697</code></pre>
<p style="color: #04C799">
<p><strong>PGLS</strong></p>
</p>
<p>The data frame of comparative data is the same as for visible
light</p>
<div class="sourceCode" id="cb128"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>pglsPDFRSRH <span class="ot">&lt;-</span> <span class="fu">pgls</span>(FRS <span class="sc">~</span> Pol,</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> comp_dataRH, <span class="at">param.CI =</span> <span class="fl">0.95</span>, <span class="at">lambda =</span> <span class="st">&quot;ML&quot;</span></span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pglsPDFRSRH)</span></code></pre></div>
<pre><code>## 
## Call:
## pgls(formula = FRS ~ Pol, data = comp_dataRH, lambda = &quot;ML&quot;, 
##     param.CI = 0.95)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.2256 -0.8717 -0.1577  0.5700  3.2353 
## 
## Branch length transformations:
## 
## kappa  [Fix]  : 1.000
## lambda [ ML]  : 0.693
##    lower bound : 0.000, p = 0.081072
##    upper bound : 1.000, p = 0.0086855
##    95.0% CI   : (NA, 0.967)
## delta  [Fix]  : 1.000
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept) -9.11035    3.75985 -2.4231  0.02001 *
## Pol          0.44772    0.48340  0.9262  0.35990  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.525 on 40 degrees of freedom
## Multiple R-squared: 0.021,   Adjusted R-squared: -0.00348 
## F-statistic: 0.8578 on 1 and 40 DF,  p-value: 0.3599</code></pre>
<p style="color: #04C799">
<p><strong>PGLS multiple trees</strong></p>
</p>
<p>Dataset</p>
<div class="sourceCode" id="cb130"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>RHandRefl5 <span class="ot">&lt;-</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>    RHandReflRows <span class="sc">%&gt;%</span> <span class="co"># phylogeny names in rows</span></span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(Pol, FRS) <span class="sc">%&gt;%</span> </span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;Response&quot;</span> <span class="ot">=</span> FRS)</span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a>RHandRefl5 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(RHandRefl5)</span></code></pre></div>
<p>Apply</p>
<div class="sourceCode" id="cb131"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>runsRHPol5 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(trees[trees_subset_min<span class="sc">:</span>trees_subset_max],</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>                   pgls_runA, <span class="at">model =</span> MuPGLSPol3, <span class="at">dataset =</span> RHandRefl5)</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>dfRHPol5 <span class="ot">&lt;-</span> <span class="fu">ldply</span>(runsRHPol5, data.frame)</span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(dfRHPol5[,<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 1001</code></pre>
<p>Get results</p>
<div class="sourceCode" id="cb133"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">HPDinterval</span>(<span class="fu">as.mcmc</span>(dfRHPol5))</span></code></pre></div>
<pre><code>##                lower     upper
## estimateP1 0.3552530 0.5722316
## ts1        0.7702818 1.1862122
## ps1        0.2425368 0.4456585
## attr(,&quot;Probability&quot;)
## [1] 0.95005</code></pre>
</div>
</div>
<div id="absorptivity-1" class="section level3">
<h3>Absorptivity</h3>
<div id="vis-3" class="section level4">
<h4>VIS</h4>
<p style="color: #04C799">
<p><strong>Question</strong></p>
</p>
<p><strong>Can polarisation predict visible absorptivity?</strong></p>
<p style="color: #04C799">
<p><strong>Correlation</strong></p>
</p>
<div class="sourceCode" id="cb135"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(RHandAbs<span class="sc">$</span>VIS, RHandAbs<span class="sc">$</span>Pol) <span class="co"># by spp</span></span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  RHandAbs$VIS and RHandAbs$Pol
## t = -0.92958, df = 19, p-value = 0.3643
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.5873711  0.2451940
## sample estimates:
##        cor 
## -0.2085692</code></pre>
<p style="color: #04C799">
<p><strong>Linear model</strong></p>
</p>
<div class="sourceCode" id="cb137"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>ModL1AbsRH <span class="ot">&lt;-</span> <span class="fu">lm</span>(RHandAbs<span class="sc">$</span>VIS <span class="sc">~</span> RHandAbs<span class="sc">$</span>Pol) <span class="co"># by spp</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ModL1AbsRH)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = RHandAbs$VIS ~ RHandAbs$Pol)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -24.1117  -5.4171   0.0063   8.3618  12.1358 
## 
## Coefficients:
##              Estimate Std. Error t value      Pr(&gt;|t|)    
## (Intercept)    86.056      7.390   11.64 0.00000000043 ***
## RHandAbs$Pol   -1.594      1.715   -0.93         0.364    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 10.81 on 19 degrees of freedom
## Multiple R-squared:  0.0435, Adjusted R-squared:  -0.006841 
## F-statistic: 0.8641 on 1 and 19 DF,  p-value: 0.3643</code></pre>
<p style="color: #04C799">
<p><strong>PGLS</strong></p>
</p>
<p>Create the data frame of comparative data</p>
<div class="sourceCode" id="cb139"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>CompDataAbsRH <span class="ot">&lt;-</span> <span class="fu">comparative.data</span>(</span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">phy =</span> MCCtreeAbs,</span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> RHandAbs, <span class="co"># aggregated data without the spp in the row names</span></span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">names.col =</span> <span class="st">&quot;phylogeny_name&quot;</span>, <span class="co"># contains the column phylogeny name</span></span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">vcv =</span> <span class="cn">TRUE</span>,</span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.omit =</span> <span class="cn">FALSE</span>, <span class="at">warn.dropped =</span> <span class="cn">TRUE</span></span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Establish the model</p>
<div class="sourceCode" id="cb140"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>pglsPDVISAbsRH <span class="ot">&lt;-</span> <span class="fu">pgls</span>(VIS <span class="sc">~</span> Pol,</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> CompDataAbsRH, <span class="at">param.CI =</span> <span class="fl">0.95</span>, <span class="at">lambda =</span> <span class="st">&quot;ML&quot;</span></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pglsPDVISAbsRH)</span></code></pre></div>
<pre><code>## 
## Call:
## pgls(formula = VIS ~ Pol, data = CompDataAbsRH, lambda = &quot;ML&quot;, 
##     param.CI = 0.95)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -6.3940 -2.5260 -0.6372  2.3659 10.9601 
## 
## Branch length transformations:
## 
## kappa  [Fix]  : 1.000
## lambda [ ML]  : 0.960
##    lower bound : 0.000, p = 0.30126
##    upper bound : 1.000, p = 0.44529
##    95.0% CI   : (NA, NA)
## delta  [Fix]  : 1.000
## 
## Coefficients:
##             Estimate Std. Error t value     Pr(&gt;|t|)    
## (Intercept) 83.23122   11.24337  7.4027 0.0000005202 ***
## Pol         -0.44213    1.38708 -0.3188       0.7534    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.061 on 19 degrees of freedom
## Multiple R-squared: 0.005319,    Adjusted R-squared: -0.04703 
## F-statistic: 0.1016 on 1 and 19 DF,  p-value: 0.7534</code></pre>
<p style="color: #04C799">
<p><strong>PGLS multiple trees</strong></p>
</p>
<p>Dataset</p>
<div class="sourceCode" id="cb142"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>RHandAbs3 <span class="ot">&lt;-</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>    RHandAbsRows <span class="sc">%&gt;%</span> <span class="co"># phylogeny names in rows</span></span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(Pol, VIS) <span class="sc">%&gt;%</span> </span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;Response&quot;</span> <span class="ot">=</span> VIS)</span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a>RHandAbs3 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(RHandAbs3)</span></code></pre></div>
<p>Apply</p>
<div class="sourceCode" id="cb143"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>runsRHPol6 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(trees[trees_subset_min<span class="sc">:</span>trees_subset_max],</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>                   pgls_runA, <span class="at">model =</span> MuPGLSPol3, <span class="at">dataset =</span> RHandAbs3)</span></code></pre></div>
<pre><code>## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH</code></pre>
<div class="sourceCode" id="cb145"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>dfRHPol6 <span class="ot">&lt;-</span> <span class="fu">ldply</span>(runsRHPol6, data.frame)</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(dfRHPol6[,<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 965</code></pre>
<p>Get results</p>
<div class="sourceCode" id="cb147"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">HPDinterval</span>(<span class="fu">as.mcmc</span>(dfRHPol6))</span></code></pre></div>
<pre><code>##                 lower      upper
## estimateP1 -1.5940794 0.06334685
## ts1        -0.9295755 0.05191069
## ps1         0.3642516 0.95914174
## attr(,&quot;Probability&quot;)
## [1] 0.9502591</code></pre>
<p><span style="color: #04C799"><strong>Conclusion</strong></span>
<br/></p>
<p><strong>There’s no correlation between visible absorptivity and
polarisation at the species level.</strong></p>
<p><br> <br> <br></p>
</div>
<div id="nir-3" class="section level4">
<h4>NIR</h4>
<p style="color: #04C799">
<p><strong>Question</strong></p>
</p>
<p><strong>Is polarisation correlated with NIR
absorptivity?</strong></p>
<p style="color: #04C799">
<p><strong>Correlation</strong></p>
</p>
<p>Species level:</p>
<div class="sourceCode" id="cb149"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(RHandAbs<span class="sc">$</span>NIR, RHandAbs<span class="sc">$</span>Pol) <span class="co"># by spp</span></span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  RHandAbs$NIR and RHandAbs$Pol
## t = -0.69617, df = 19, p-value = 0.4948
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.5518296  0.2939895
## sample estimates:
##        cor 
## -0.1577128</code></pre>
<p style="color: #04C799">
<p><strong>Linear model</strong></p>
</p>
<div class="sourceCode" id="cb151"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>ModL2AbsRH <span class="ot">&lt;-</span> <span class="fu">lm</span>(RHandAbs<span class="sc">$</span>NIR <span class="sc">~</span> RHandAbs<span class="sc">$</span>Pol <span class="sc">+</span> RHandAbs<span class="sc">$</span>VIS) <span class="co"># by spp</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ModL2AbsRH)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = RHandAbs$NIR ~ RHandAbs$Pol + RHandAbs$VIS)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -12.4573  -1.9427   0.5778   2.7432  14.0929 
## 
## Coefficients:
##              Estimate Std. Error t value      Pr(&gt;|t|)    
## (Intercept)  -70.9359    12.1572  -5.835 0.00001583165 ***
## RHandAbs$Pol   0.4077     1.0112   0.403         0.692    
## RHandAbs$VIS   1.3522     0.1323  10.220 0.00000000638 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 6.233 on 18 degrees of freedom
## Multiple R-squared:  0.8567, Adjusted R-squared:  0.8407 
## F-statistic: 53.79 on 2 and 18 DF,  p-value: 0.00000002554</code></pre>
<p style="color: #04C799">
<p><strong>PGLS</strong></p>
</p>
<p>The data frame of comparative data is the same as for visible
light</p>
<div class="sourceCode" id="cb153"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>pglsPDNIRAbsRH <span class="ot">&lt;-</span> <span class="fu">pgls</span>(NIR <span class="sc">~</span> Pol <span class="sc">+</span> VIS,</span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> CompDataAbsRH, <span class="at">param.CI =</span> <span class="fl">0.95</span>, <span class="at">lambda =</span> <span class="st">&quot;ML&quot;</span></span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pglsPDNIRAbsRH)</span></code></pre></div>
<pre><code>## 
## Call:
## pgls(formula = NIR ~ Pol + VIS, data = CompDataAbsRH, lambda = &quot;ML&quot;, 
##     param.CI = 0.95)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2.3577 -1.2376 -0.5185  0.7095  2.5628 
## 
## Branch length transformations:
## 
## kappa  [Fix]  : 1.000
## lambda [ ML]  : 0.000
##    lower bound : 0.000, p = 1    
##    upper bound : 1.000, p = 0.060342
##    95.0% CI   : (NA, NA)
## delta  [Fix]  : 1.000
## 
## Coefficients:
##              Estimate Std. Error t value       Pr(&gt;|t|)    
## (Intercept) -70.93587   12.15716 -5.8349 0.000015831622 ***
## Pol           0.40768    1.01120  0.4032         0.6916    
## VIS           1.35222    0.13231 10.2204 0.000000006378 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.497 on 18 degrees of freedom
## Multiple R-squared: 0.8567,  Adjusted R-squared: 0.8407 
## F-statistic: 53.79 on 2 and 18 DF,  p-value: 0.00000002554</code></pre>
<p style="color: #04C799">
<p><strong>PGLS multiple trees</strong></p>
</p>
<p>Dataset</p>
<div class="sourceCode" id="cb155"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>RHandAbs4 <span class="ot">&lt;-</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>    RHandAbsRows <span class="sc">%&gt;%</span> <span class="co"># phylogeny names in rows</span></span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(Pol, VIS, NIR) <span class="sc">%&gt;%</span> </span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;Response&quot;</span> <span class="ot">=</span> NIR)</span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a>RHandAbs4 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(RHandAbs4)</span></code></pre></div>
<p>Apply</p>
<div class="sourceCode" id="cb156"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>runsRHPol7 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(trees[trees_subset_min<span class="sc">:</span>trees_subset_max],</span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>                   pgls_runH, <span class="at">model =</span> MuPGLSPol4, <span class="at">dataset =</span> RHandAbs4)</span></code></pre></div>
<pre><code>## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH</code></pre>
<div class="sourceCode" id="cb158"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>dfRHPol7 <span class="ot">&lt;-</span> <span class="fu">ldply</span>(runsRHPol7, data.frame)</span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(dfRHPol7[,<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 994</code></pre>
<p>Get results</p>
<div class="sourceCode" id="cb160"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="fu">HPDinterval</span>(<span class="fu">as.mcmc</span>(dfRHPol7))</span></code></pre></div>
<pre><code>##                         lower              upper
## estimateP1  0.407675987360903  0.407676342898483
## ts1         0.403159649045050  0.403159984140517
## ps1         0.691579037712050  0.691579279810262
## estimateP2  1.352220773403229  1.352220816847392
## tP2        10.220434063137793 10.220435396596766
## pP2         0.000000006378462  0.000000006378475
## attr(,&quot;Probability&quot;)
## [1] 0.9496982</code></pre>
</div>
<div id="frs-3" class="section level4">
<h4>FRS</h4>
<p style="color: #04C799">
<p><strong>Question</strong></p>
</p>
<p><strong>Is polarisation correlated with the NIR residuals corrected
by phylogeny?</strong></p>
<p style="color: #04C799">
<p><strong>Correlation</strong></p>
</p>
<p>Species level:</p>
<div class="sourceCode" id="cb162"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(RHandAbs<span class="sc">$</span>FRS, RHandAbs<span class="sc">$</span>Pol) <span class="co"># by spp</span></span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  RHandAbs$FRS and RHandAbs$Pol
## t = 0.41542, df = 19, p-value = 0.6825
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.3511961  0.5058437
## sample estimates:
##        cor 
## 0.09487424</code></pre>
<p style="color: #04C799">
<p><strong>Linear model</strong></p>
</p>
<div class="sourceCode" id="cb164"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a>ModL3AbsRH <span class="ot">&lt;-</span> <span class="fu">lm</span>(RHandAbs<span class="sc">$</span>FRS <span class="sc">~</span> RHandAbs<span class="sc">$</span>Pol) <span class="co"># by spp</span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ModL3AbsRH)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = RHandAbs$FRS ~ RHandAbs$Pol)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -12.4229  -1.9535   0.4778   2.7771  14.1443 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)    7.7789     4.1484   1.875   0.0762 .
## RHandAbs$Pol   0.3999     0.9626   0.415   0.6825  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 6.067 on 19 degrees of freedom
## Multiple R-squared:  0.009001,   Adjusted R-squared:  -0.04316 
## F-statistic: 0.1726 on 1 and 19 DF,  p-value: 0.6825</code></pre>
<p style="color: #04C799">
<p><strong>PGLS</strong></p>
</p>
<p>The data frame of comparative data is the same as for visible
light</p>
<div class="sourceCode" id="cb166"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>pglsPDFRSAbsRH <span class="ot">&lt;-</span> <span class="fu">pgls</span>(FRS <span class="sc">~</span> Pol,</span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> CompDataAbsRH, <span class="at">param.CI =</span> <span class="fl">0.95</span>, <span class="at">lambda =</span> <span class="st">&quot;ML&quot;</span></span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb166-4"><a href="#cb166-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-5"><a href="#cb166-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pglsPDFRSAbsRH)</span></code></pre></div>
<pre><code>## 
## Call:
## pgls(formula = FRS ~ Pol, data = CompDataAbsRH, lambda = &quot;ML&quot;, 
##     param.CI = 0.95)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -2.361 -1.223 -0.529  0.710  2.545 
## 
## Branch length transformations:
## 
## kappa  [Fix]  : 1.000
## lambda [ ML]  : 0.000
##    lower bound : 0.000, p = 1    
##    upper bound : 1.000, p = 0.059965
##    95.0% CI   : (NA, NA)
## delta  [Fix]  : 1.000
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)  7.77892    4.14840  1.8752  0.07623 .
## Pol          0.39989    0.96262  0.4154  0.68249  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.457 on 19 degrees of freedom
## Multiple R-squared: 0.009001,    Adjusted R-squared: -0.04316 
## F-statistic: 0.1726 on 1 and 19 DF,  p-value: 0.6825</code></pre>
<p style="color: #04C799">
<p><strong>PGLS multiple trees</strong></p>
</p>
<p>Dataset</p>
<div class="sourceCode" id="cb168"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>RHandAbs5 <span class="ot">&lt;-</span></span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a>    RHandAbsRows <span class="sc">%&gt;%</span> <span class="co"># phylogeny names in rows</span></span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(Pol, FRS) <span class="sc">%&gt;%</span> </span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;Response&quot;</span> <span class="ot">=</span> FRS)</span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-6"><a href="#cb168-6" aria-hidden="true" tabindex="-1"></a>RHandAbs5 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(RHandAbs5)</span></code></pre></div>
<p>Apply</p>
<div class="sourceCode" id="cb169"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a>runsRHPol8 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(trees[trees_subset_min<span class="sc">:</span>trees_subset_max],</span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a>                   pgls_runA, <span class="at">model =</span> MuPGLSPol3, <span class="at">dataset =</span> RHandAbs5)</span></code></pre></div>
<pre><code>## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH</code></pre>
<div class="sourceCode" id="cb171"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>dfRHPol8 <span class="ot">&lt;-</span> <span class="fu">ldply</span>(runsRHPol8, data.frame)</span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(dfRHPol8[,<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 994</code></pre>
<p>Get results</p>
<div class="sourceCode" id="cb173"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="fu">HPDinterval</span>(<span class="fu">as.mcmc</span>(dfRHPol8))</span></code></pre></div>
<pre><code>##                lower     upper
## estimateP1 0.3998936 0.3998940
## ts1        0.4154209 0.4154212
## ps1        0.6824874 0.6824877
## attr(,&quot;Probability&quot;)
## [1] 0.9496982</code></pre>
</div>
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4,h5",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
