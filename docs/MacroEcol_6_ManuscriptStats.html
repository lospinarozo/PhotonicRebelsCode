<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Reflectivity PGLS</title>

<script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #ffffff;
    color: #a0a0a0;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
div.sourceCode
  { color: #1f1c1b; background-color: #ffffff; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #1f1c1b; } /* Normal */
code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
code span.an { color: #ca60ca; } /* Annotation */
code span.at { color: #0057ae; } /* Attribute */
code span.bn { color: #b08000; } /* BaseN */
code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
code span.ch { color: #924c9d; } /* Char */
code span.cn { color: #aa5500; } /* Constant */
code span.co { color: #898887; } /* Comment */
code span.cv { color: #0095ff; } /* CommentVar */
code span.do { color: #607880; } /* Documentation */
code span.dt { color: #0057ae; } /* DataType */
code span.dv { color: #b08000; } /* DecVal */
code span.er { color: #bf0303; text-decoration: underline; } /* Error */
code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
code span.fl { color: #b08000; } /* Float */
code span.fu { color: #644a9b; } /* Function */
code span.im { color: #ff5500; } /* Import */
code span.in { color: #b08000; } /* Information */
code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
code span.op { color: #1f1c1b; } /* Operator */
code span.ot { color: #006e28; } /* Other */
code span.pp { color: #006e28; } /* Preprocessor */
code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
code span.sc { color: #3daee9; } /* SpecialChar */
code span.ss { color: #ff5500; } /* SpecialString */
code span.st { color: #bf0303; } /* String */
code span.va { color: #0057ae; } /* Variable */
code span.vs { color: #bf0303; } /* VerbatimString */
code span.wa { color: #bf0303; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Shady Xmas Beetles</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="MacroEcol_1_SettingUp.html">Setting up</a>
</li>
<li>
  <a href="MacroEcol_2_OpticalProperties.html">Optical properties</a>
</li>
<li>
  <a href="MacroEcol_3_EcologicalVariables.html">Ecological variables</a>
</li>
<li>
  <a href="MacroEcol_5_Polarization.html">Polarisation</a>
</li>
<li>
  <a href="MacroEcol_5_Polarization2.html">Polarisation PGLS</a>
</li>
<li>
  <a href="MacroEcol_6_ManuscriptStats.html">Reflectivity PGLS</a>
</li>
<li>
  <a href="MacroEcol_7_Summary.html">Summary</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Reflectivity PGLS</h1>

</div>


<div id="libraries" class="section level1">
<h1>Libraries</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;./MacroEcol_1_Libraries.R&quot;</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>trees_subset_min<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>trees_subset_max<span class="ot">&lt;-</span><span class="dv">2000</span></span></code></pre></div>
</div>
<div id="data-sets" class="section level1">
<h1>Data Sets</h1>
<p>Reflectivity by Individual</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>Cons1 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;../Data/FromCode/ConsReflEcolInd.csv&quot;</span>)[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>Cons1agg <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;../Data/FromCode/ConsolidatedReflectivitySpp.csv&quot;</span>)[<span class="sc">-</span><span class="dv">1</span>]</span></code></pre></div>
<p>Phylogeny (multiple trees)</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>trees <span class="ot">&lt;-</span> ape<span class="sc">::</span><span class="fu">read.tree</span>(<span class="st">&quot;../Data/XMAS_mat2b_bst2ef_set23nn2_pinct.nwk&quot;</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>MCCtree <span class="ot">&lt;-</span> </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  ape<span class="sc">::</span><span class="fu">read.nexus</span>(<span class="st">&quot;../Data/xmas_mat2b_bst2ef_set23nn2_pinct_med.tre&quot;</span>)</span></code></pre></div>
<div id="aggregate" class="section level2">
<h2>Aggregate</h2>
<p>In this analysis we will consider interspecific instead of
intraspecific variability.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modify to make it compatible with tree tips</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>Cons1agg <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(Cons1agg) <span class="co"># convert to a data frame</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(Cons1agg) <span class="ot">&lt;-</span> Cons1agg[, <span class="dv">1</span>] <span class="co"># make species the row names </span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co">#ConsAgg &lt;- Cons1agg [,2:length(Cons1agg)] # eliminate spp name (redundant)</span></span></code></pre></div>
</div>
<div id="match" class="section level2">
<h2>Match</h2>
<p>Make sure that the phylogeny names are consistent in the data frame
and the phylogenetic trees</p>
<p>Read and prune the MCC tree</p>
<p>The MCC (Maximum clade credibility) tree used here is the BEAST MCC
tree. We did not need to prun the tree. The equivalence between specie
sin the tree and data frame was tested in previous steps (tab optical
properties).</p>
<p>The names between data and tree tips match:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test if the species are the same</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">identical</span>(</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">length</span>(<span class="fu">name.check</span>(MCCtree, Cons1agg<span class="sc">$</span>phylogeny_name)<span class="sc">$</span>tree_not_data),</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">length</span>(Cons1agg<span class="sc">$</span>phylogeny_name)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="subset" class="section level2">
<h2>Subset</h2>
<p>Create subsets for each waveband</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>ALLDataSet <span class="ot">&lt;-</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  Cons1agg <span class="sc">%&gt;%</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span> (<span class="sc">-</span>VIS, <span class="sc">-</span>NIR, <span class="sc">-</span> Res, <span class="sc">-</span>FRS) <span class="sc">%&gt;%</span> </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span> (<span class="st">&quot;Reflectance&quot;</span> <span class="ot">=</span> TOT) </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>NIRDataSet <span class="ot">&lt;-</span> </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  Cons1agg <span class="sc">%&gt;%</span> </span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span> (<span class="sc">-</span>TOT, <span class="sc">-</span>VIS, <span class="sc">-</span> Res, <span class="sc">-</span>FRS) <span class="sc">%&gt;%</span> </span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span> (<span class="st">&quot;Reflectance&quot;</span> <span class="ot">=</span> NIR) </span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>VISDataSet <span class="ot">&lt;-</span> </span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  Cons1agg <span class="sc">%&gt;%</span> </span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span> (<span class="sc">-</span>TOT, <span class="sc">-</span>NIR, <span class="sc">-</span> Res, <span class="sc">-</span>FRS) <span class="sc">%&gt;%</span> </span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span> (<span class="st">&quot;Reflectance&quot;</span> <span class="ot">=</span> VIS) </span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>ResDataSet <span class="ot">&lt;-</span> </span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  Cons1agg <span class="sc">%&gt;%</span> </span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span> (<span class="sc">-</span>TOT, <span class="sc">-</span>NIR, <span class="sc">-</span>VIS, <span class="sc">-</span>FRS) <span class="sc">%&gt;%</span> </span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span> (<span class="st">&quot;Reflectance&quot;</span> <span class="ot">=</span> Res)</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>NmoDataSet <span class="ot">&lt;-</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>  Cons1agg <span class="sc">%&gt;%</span> </span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span> (<span class="sc">-</span>TOT, <span class="sc">-</span> Res, <span class="sc">-</span>FRS) <span class="sc">%&gt;%</span> </span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span> (<span class="st">&quot;Reflectance&quot;</span> <span class="ot">=</span> NIR) </span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>FRSDataSet <span class="ot">&lt;-</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>  Cons1agg <span class="sc">%&gt;%</span> </span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span> (<span class="sc">-</span>TOT, <span class="sc">-</span>NIR, <span class="sc">-</span>VIS, <span class="sc">-</span>Res) <span class="sc">%&gt;%</span> </span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span> (<span class="st">&quot;Reflectance&quot;</span> <span class="ot">=</span> FRS)</span></code></pre></div>
</div>
</div>
<div id="setting-up-models" class="section level1">
<h1>Setting up models</h1>
<p>note that the function has to be adapted to the data frame and model
on each case</p>
<div id="model-1" class="section level2">
<h2>Model 1</h2>
<p>PGLS in the MCC</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>comp_data <span class="ot">&lt;-</span> <span class="fu">comparative.data</span>(</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">phy =</span> MCCtree, <span class="at">data =</span> Cons1agg,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">names.col =</span> <span class="st">&quot;phylogeny_name&quot;</span>, <span class="at">vcv =</span> <span class="cn">TRUE</span>,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.omit =</span> <span class="cn">FALSE</span>, <span class="at">warn.dropped =</span> <span class="cn">TRUE</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="model-2" class="section level2">
<h2>Model 2</h2>
<p>PGLS Multiple Trees with 5 predictors + intercept</p>
<p>Source function</p>
<p>note that this function has to be adapted to the data frame and model
on each case</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;8_multiple_pgls_function_C.R&quot;</span>)<span class="co"># function C is for reflectance as response</span></span></code></pre></div>
<p>Define model</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>MuPGLSMod2 <span class="ot">&lt;-</span> Reflectance <span class="sc">~</span> PC1 <span class="sc">+</span> PC2 <span class="sc">+</span> size <span class="sc">+</span> PC1<span class="sc">*</span>size <span class="sc">+</span> PC2<span class="sc">*</span>size</span></code></pre></div>
</div>
<div id="model-3" class="section level2">
<h2>Model 3</h2>
<p>PGLS in multiple trees for NIR contains 6 predictors + intercept. The
extra predictor here is the “VIS” reflectance to account for the
correlation of these two variables.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;9_multiple_pgls_function_D.R&quot;</span>)<span class="co"># function D is NIR explained by PCs and VIS</span></span></code></pre></div>
<p>Define model</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>MuPGLSMod3 <span class="ot">&lt;-</span> Reflectance <span class="sc">~</span> PC1 <span class="sc">+</span> PC2 <span class="sc">+</span> size <span class="sc">+</span> PC1<span class="sc">*</span>size <span class="sc">+</span> PC2<span class="sc">*</span>size <span class="sc">+</span> VIS</span></code></pre></div>
</div>
<div id="model-4" class="section level2">
<h2>Model 4</h2>
<p>PGLS Multiple Trees with 3 predictors + intercept</p>
<p>We run simplified models with only one pc for each spectral band
including only the predictors that were signifficant in the full model.
(because the visible reflectance seems to be more correlated to PC1 and
the NIR to PC2)</p>
<p>Source function</p>
<p>note that this function has to be adapted to the data frame and model
on each case</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;10_multiple_pgls_function_E.R&quot;</span>)<span class="co"># function C is for reflectance as response</span></span></code></pre></div>
<p>Define model</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>MuPGLSMod4 <span class="ot">&lt;-</span> Reflectance <span class="sc">~</span> PC <span class="sc">+</span> size <span class="sc">+</span> PC<span class="sc">*</span>size </span></code></pre></div>
</div>
<div id="model-5" class="section level2">
<h2>Model 5</h2>
<p>PGLS Multiple Trees with 4 predictors + intercept</p>
<p>We run simplified models with only one pc for each spectral band
including only the predictors that were signifficant in the full model
(because the visible reflectance seems to be more correlated to PC1 and
the NIR to PC2). However, for NIR we need to include VIS reflectance as
a predictor</p>
<p>Source function</p>
<p>note that this function has to be adapted to the data frame and model
on each case</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;11_multiple_pgls_function_F.R&quot;</span>)<span class="co"># function C is for reflectance as response</span></span></code></pre></div>
<p>Define model</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>MuPGLSMod5 <span class="ot">&lt;-</span> Reflectance <span class="sc">~</span> PC <span class="sc">+</span> size <span class="sc">+</span> PC<span class="sc">*</span>size <span class="sc">+</span> VIS</span></code></pre></div>
</div>
</div>
<div id="results-per-spectral-band" class="section level1">
<h1>Results per spectral band</h1>
<p>The PGLS model tests if the correlations we found in the previous
step remain after correcting by phylogeny. This model does not consider
instraspecific variation. We averaged both location and reflectivity and
obtained only one value per species.</p>
<div id="tot" class="section level2">
<h2>TOT</h2>
<div id="mcc-tree" class="section level3">
<h3>MCC Tree</h3>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>pglsmodTOT <span class="ot">&lt;-</span> <span class="fu">pgls</span>(TOT <span class="sc">~</span> PC1 <span class="sc">+</span> PC2 <span class="sc">+</span> size <span class="sc">+</span> PC1<span class="sc">*</span>size <span class="sc">+</span> PC2<span class="sc">*</span>size,</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> comp_data, <span class="at">param.CI =</span> <span class="fl">0.95</span>, <span class="at">lambda =</span> <span class="st">&quot;ML&quot;</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>FinMccTotc <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">round</span>(<span class="fu">summary</span>(pglsmodTOT)<span class="sc">$</span>coefficients[,<span class="dv">1</span>],<span class="dv">3</span>))</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>FinMccTotp <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">round</span>(<span class="fu">summary</span>(pglsmodTOT)<span class="sc">$</span>coefficients[,<span class="dv">4</span>],<span class="dv">3</span>)) </span></code></pre></div>
<p>None of the variables has an effect in the total reflectance</p>
<p>Test phylogenetic signal using Pagel’s lambda:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>pagelTOTRefl <span class="ot">&lt;-</span> Cons1agg<span class="sc">$</span>TOT <span class="co"># Define which trait you want to test</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(pagelTOTRefl) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(Cons1agg) <span class="co"># Row names = tree tips</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">phylosig</span>(MCCtree, pagelTOTRefl, <span class="at">method =</span> <span class="st">&quot;lambda&quot;</span>, <span class="at">test =</span> <span class="cn">TRUE</span>, <span class="at">nsim =</span> <span class="dv">999</span>)</span></code></pre></div>
<pre><code>## 
## Phylogenetic signal lambda : 0.819728 
## logL(lambda) : -162.013 
## LR(lambda=0) : 0.319604 
## P-value (based on LR test) : 0.571846</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># nsim = 999 means testing with 999 randomizations</span></span></code></pre></div>
<p>Phylogenetic signal is high.</p>
</div>
<div id="multiple-trees" class="section level3">
<h3>multiple trees</h3>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>runsTOT<span class="ot">&lt;-</span><span class="fu">lapply</span>(trees[trees_subset_min<span class="sc">:</span>trees_subset_max],</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>                pgls_runC,</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">model=</span>MuPGLSMod2,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">dataset=</span>ALLDataSet) </span></code></pre></div>
<pre><code>## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>dfTOT <span class="ot">&lt;-</span> <span class="fu">ldply</span> (runsTOT, data.frame)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(dfTOT,<span class="st">&quot;../Data/FromCode/MuTPglsResultsTOT.csv&quot;</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>FinTotM <span class="ot">&lt;-</span> <span class="fu">HPDinterval</span>(<span class="fu">as.mcmc</span>(dfTOT))</span></code></pre></div>
</div>
</div>
<div id="vis" class="section level2">
<h2>VIS</h2>
<div id="full-model" class="section level3">
<h3>full model</h3>
<div id="mcc-tree-1" class="section level4">
<h4>MCC Tree</h4>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>pglsmodVIS <span class="ot">&lt;-</span> <span class="fu">pgls</span>(VIS <span class="sc">~</span> PC1 <span class="sc">+</span> PC2 <span class="sc">+</span> size <span class="sc">+</span> PC1<span class="sc">*</span>size <span class="sc">+</span> PC2<span class="sc">*</span>size,</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> comp_data, <span class="at">param.CI =</span> <span class="fl">0.95</span>, <span class="at">lambda =</span> <span class="st">&quot;ML&quot;</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>FinMccVisc <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">round</span>(<span class="fu">summary</span>(pglsmodVIS)<span class="sc">$</span>coefficients[,<span class="dv">1</span>],<span class="dv">3</span>)) </span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>FinMccVisp <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">round</span>(<span class="fu">summary</span>(pglsmodVIS)<span class="sc">$</span>coefficients[,<span class="dv">4</span>],<span class="dv">3</span>))</span></code></pre></div>
<p>Test phylogenetic signal using Pagel’s lambda:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>pagelVISRefl <span class="ot">&lt;-</span> Cons1agg<span class="sc">$</span>VIS <span class="co"># Define which trait you want to test</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(pagelVISRefl) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(Cons1agg) <span class="co"># Row names = tree tips</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">phylosig</span>(MCCtree, pagelVISRefl, <span class="at">method =</span> <span class="st">&quot;lambda&quot;</span>, <span class="at">test =</span> <span class="cn">TRUE</span>, <span class="at">nsim =</span> <span class="dv">999</span>)</span></code></pre></div>
<pre><code>## 
## Phylogenetic signal lambda : 0.882589 
## logL(lambda) : -154.422 
## LR(lambda=0) : 1.87652 
## P-value (based on LR test) : 0.17073</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># nsim = 999 means testing with 999 randomizations</span></span></code></pre></div>
<p>Phylogenetic signal is high.</p>
</div>
<div id="multiple-trees-1" class="section level4">
<h4>multiple trees</h4>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>runsVIS<span class="ot">&lt;-</span><span class="fu">lapply</span>(trees[trees_subset_min<span class="sc">:</span>trees_subset_max],</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>                pgls_runC,</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">model=</span>MuPGLSMod2,</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">dataset=</span>VISDataSet) </span></code></pre></div>
<pre><code>## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>dfVIS <span class="ot">&lt;-</span> <span class="fu">ldply</span> (runsVIS, data.frame)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(dfVIS,<span class="st">&quot;../Data/FromCode/MuTPglsResultsVIS.csv&quot;</span>)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>FinVisM <span class="ot">&lt;-</span> <span class="fu">HPDinterval</span>(<span class="fu">as.mcmc</span>(dfVIS))</span></code></pre></div>
</div>
</div>
<div id="simple-model" class="section level3">
<h3>simple model</h3>
<div id="mcc-tree-2" class="section level4">
<h4>MCC Tree</h4>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>spglsmodVIS <span class="ot">&lt;-</span> <span class="fu">pgls</span>(VIS <span class="sc">~</span> PC1 <span class="sc">+</span> size <span class="sc">+</span> PC1<span class="sc">*</span>size,</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> comp_data, <span class="at">param.CI =</span> <span class="fl">0.95</span>, <span class="at">lambda =</span> <span class="st">&quot;ML&quot;</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(spglsmodVIS) </span></code></pre></div>
<pre><code>## 
## Call:
## pgls(formula = VIS ~ PC1 + size + PC1 * size, data = comp_data, 
##     lambda = &quot;ML&quot;, param.CI = 0.95)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -8.6512 -1.7936 -0.2704  0.7772  4.5344 
## 
## Branch length transformations:
## 
## kappa  [Fix]  : 1.000
## lambda [ ML]  : 1.000
##    lower bound : 0.000, p = 0.042871
##    upper bound : 1.000, p = 1    
##    95.0% CI   : (0.497, NA)
## delta  [Fix]  : 1.000
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept) -0.70206    8.81776 -0.0796  0.93691  
## PC1         -6.05598    2.49214 -2.4300  0.01935 *
## size         5.31159    2.42002  2.1949  0.03362 *
## PC1:size     2.55291    1.03493  2.4667  0.01770 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.867 on 43 degrees of freedom
## Multiple R-squared: 0.169,   Adjusted R-squared: 0.111 
## F-statistic: 2.915 on 3 and 43 DF,  p-value: 0.04498</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>sFinMccVisc <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">round</span>(<span class="fu">summary</span>(spglsmodVIS)<span class="sc">$</span>coefficients[,<span class="dv">1</span>],<span class="dv">3</span>)) </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>sFinMccVisp <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">round</span>(<span class="fu">summary</span>(spglsmodVIS)<span class="sc">$</span>coefficients[,<span class="dv">4</span>],<span class="dv">3</span>))</span></code></pre></div>
</div>
<div id="multiple-trees-2" class="section level4">
<h4>multiple trees</h4>
<p>First step is to modify the data frame.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>SimpleVIS <span class="ot">&lt;-</span> </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  VISDataSet <span class="sc">%&gt;%</span> </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(phylogeny_name, Reflectance, size, PC1) <span class="sc">%&gt;%</span> </span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">PC =</span> PC1)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>SimpleVIS <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(SimpleVIS)</span></code></pre></div>
<p>Now run the model</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>runsVISsimple<span class="ot">&lt;-</span><span class="fu">lapply</span>(trees[trees_subset_min<span class="sc">:</span>trees_subset_max],</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>                      pgls_runE,</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">model=</span>MuPGLSMod4,</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">dataset=</span>SimpleVIS) </span></code></pre></div>
<pre><code>## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>dfVISsimple <span class="ot">&lt;-</span> <span class="fu">ldply</span> (runsVISsimple, data.frame)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>FinVisS <span class="ot">&lt;-</span> <span class="fu">HPDinterval</span>(<span class="fu">as.mcmc</span>(dfVISsimple))</span></code></pre></div>
</div>
</div>
</div>
<div id="nir" class="section level2">
<h2>NIR</h2>
<div id="full-model-1" class="section level3">
<h3>Full model</h3>
<div id="mcc-tree-3" class="section level4">
<h4>MCC Tree</h4>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>pglsmodNIR <span class="ot">&lt;-</span> <span class="fu">pgls</span>(NIR <span class="sc">~</span> PC1 <span class="sc">+</span> PC2 <span class="sc">+</span> size <span class="sc">+</span> PC1<span class="sc">*</span>size <span class="sc">+</span> PC2<span class="sc">*</span>size <span class="sc">+</span> VIS,</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> comp_data, <span class="at">param.CI =</span> <span class="fl">0.95</span>, <span class="at">lambda =</span> <span class="st">&quot;ML&quot;</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>FinMccNirc <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">round</span>(<span class="fu">summary</span>(pglsmodNIR)<span class="sc">$</span>coefficients[,<span class="dv">1</span>],<span class="dv">3</span>)) </span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>FinMccNirp <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">round</span>(<span class="fu">summary</span>(pglsmodNIR)<span class="sc">$</span>coefficients[,<span class="dv">4</span>],<span class="dv">3</span>))</span></code></pre></div>
<p>Results after correcting by phylogeny:</p>
<p>None of the variables has an effect in the NIR reflectance</p>
<p>Test phylogenetic signal using Pagel’s lambda:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>pagelNIRRefl <span class="ot">&lt;-</span> Cons1agg<span class="sc">$</span>NIR <span class="co"># Define which trait you want to test</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(pagelNIRRefl) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(Cons1agg) <span class="co"># Row names = tree tips</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="fu">phylosig</span>(MCCtree, pagelNIRRefl, <span class="at">method =</span> <span class="st">&quot;lambda&quot;</span>, <span class="at">test =</span> <span class="cn">TRUE</span>, <span class="at">nsim =</span> <span class="dv">999</span>)</span></code></pre></div>
<pre><code>## 
## Phylogenetic signal lambda : 0.816089 
## logL(lambda) : -173.55 
## LR(lambda=0) : 1.47387 
## P-value (based on LR test) : 0.224736</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># nsim = 999 means testing with 999 randomizations</span></span></code></pre></div>
<p>Phylogenetic signal is high.</p>
</div>
<div id="multiple-trees-3" class="section level4">
<h4>multiple trees</h4>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>runsNIR<span class="ot">&lt;-</span><span class="fu">lapply</span>(trees[trees_subset_min<span class="sc">:</span>trees_subset_max],</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>                pgls_runD,</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">model=</span>MuPGLSMod3,</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">dataset=</span>NmoDataSet) </span></code></pre></div>
<pre><code>## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>dfNIR <span class="ot">&lt;-</span> <span class="fu">ldply</span> (runsNIR, data.frame)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(dfNIR,<span class="st">&quot;../Data/FromCode/MuTPglsResultsNmo.csv&quot;</span>)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>FinNirM <span class="ot">&lt;-</span> <span class="fu">HPDinterval</span>(<span class="fu">as.mcmc</span>(dfNIR))</span></code></pre></div>
</div>
</div>
<div id="simple-model-1" class="section level3">
<h3>Simple model</h3>
<div id="mcc-tree-4" class="section level4">
<h4>MCC Tree</h4>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>spglsmodNIR <span class="ot">&lt;-</span> <span class="fu">pgls</span>(NIR <span class="sc">~</span> PC2 <span class="sc">+</span> size <span class="sc">+</span> PC2<span class="sc">*</span>size <span class="sc">+</span> VIS,</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> comp_data, <span class="at">param.CI =</span> <span class="fl">0.95</span>, <span class="at">lambda =</span> <span class="st">&quot;ML&quot;</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>sFinMccNirc <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">round</span>(<span class="fu">summary</span>(spglsmodNIR)<span class="sc">$</span>coefficients[,<span class="dv">1</span>],<span class="dv">3</span>)) </span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>sFinMccNirp <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">round</span>(<span class="fu">summary</span>(spglsmodNIR)<span class="sc">$</span>coefficients[,<span class="dv">4</span>],<span class="dv">3</span>))</span></code></pre></div>
</div>
<div id="multiple-trees-4" class="section level4">
<h4>multiple trees</h4>
<p>First step is to modify the data frame.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>SimpleNIR <span class="ot">&lt;-</span> </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  NmoDataSet <span class="sc">%&gt;%</span> </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(phylogeny_name, Reflectance, size, VIS, PC2) <span class="sc">%&gt;%</span> </span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">PC =</span> PC2)</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>SimpleNIR <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(SimpleNIR)</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(SimpleNIR)</span></code></pre></div>
<pre><code>##                                      phylogeny_name Reflectance   size      VIS
## Anomala_antigua                     Anomala_antigua    28.27315 1.7660  4.54861
## Anoplognathus_abnormis       Anoplognathus_abnormis    36.64233 1.5755 16.53003
## Anoplognathus_aeneus           Anoplognathus_aeneus    32.27222 3.1125 10.40414
## Anoplognathus_aureus           Anoplognathus_aureus    54.20353 1.7140 34.33124
## Anoplognathus_boisduvalii Anoplognathus_boisduvalii    43.21203 2.6054 17.30305
## Anoplognathus_brevicollis Anoplognathus_brevicollis    40.14934 2.5140 12.86929
##                                   PC
## Anomala_antigua           -1.9015325
## Anoplognathus_abnormis     0.1161986
## Anoplognathus_aeneus       0.4191886
## Anoplognathus_aureus      -0.4118618
## Anoplognathus_boisduvalii -0.9220386
## Anoplognathus_brevicollis -3.6269193</code></pre>
<p>Now run the model</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>runsNIRsimple<span class="ot">&lt;-</span><span class="fu">lapply</span>(trees[trees_subset_min<span class="sc">:</span>trees_subset_max],</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>                      pgls_runF,</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">model=</span>MuPGLSMod5,</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">dataset=</span>SimpleNIR) </span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>dfNIRsimple <span class="ot">&lt;-</span> <span class="fu">ldply</span> (runsNIRsimple, data.frame)</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>FinNirS <span class="ot">&lt;-</span> <span class="fu">HPDinterval</span>(<span class="fu">as.mcmc</span>(dfNIRsimple))</span></code></pre></div>
</div>
</div>
</div>
<div id="res" class="section level2">
<h2>Res</h2>
<p>(i.e. residuals between NIR ~ VIS)</p>
<div id="full-model-2" class="section level3">
<h3>Full model</h3>
<div id="mcc-tree-5" class="section level4">
<h4>MCC Tree</h4>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>pglsmodRes <span class="ot">&lt;-</span> <span class="fu">pgls</span>(Res <span class="sc">~</span> PC1 <span class="sc">+</span> PC2 <span class="sc">+</span> size <span class="sc">+</span> PC1<span class="sc">*</span>size <span class="sc">+</span> PC2<span class="sc">*</span>size,</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> comp_data, <span class="at">param.CI =</span> <span class="fl">0.95</span>, <span class="at">lambda =</span> <span class="st">&quot;ML&quot;</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>FinMccResc <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">round</span>(<span class="fu">summary</span>(pglsmodRes)<span class="sc">$</span>coefficients[,<span class="dv">1</span>],<span class="dv">3</span>)) </span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>FinMccResp <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">round</span>(<span class="fu">summary</span>(pglsmodRes)<span class="sc">$</span>coefficients[,<span class="dv">4</span>],<span class="dv">3</span>))</span></code></pre></div>
<p>Test phylogenetic signal using Pagel’s lambda:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>pagelRes <span class="ot">&lt;-</span> Cons1agg<span class="sc">$</span>Res <span class="co"># Define which trait you want to test</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(pagelRes) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(Cons1agg) <span class="co"># Row names = tree tips</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="fu">phylosig</span>(MCCtree, pagelRes, <span class="at">method =</span> <span class="st">&quot;lambda&quot;</span>, <span class="at">test =</span> <span class="cn">TRUE</span>, <span class="at">nsim =</span> <span class="dv">999</span>)</span></code></pre></div>
<pre><code>## 
## Phylogenetic signal lambda : 0.931743 
## logL(lambda) : -157.838 
## LR(lambda=0) : 7.25432 
## P-value (based on LR test) : 0.00707307</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># nsim = 999 means testing with 999 randomizations</span></span></code></pre></div>
<p>Phylogenetic signal is very high</p>
</div>
<div id="multiple-trees-5" class="section level4">
<h4>multiple trees</h4>
<p>(i.e. residuals between NIR ~ VIS)</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>runsRes<span class="ot">&lt;-</span><span class="fu">lapply</span>(trees[trees_subset_min<span class="sc">:</span>trees_subset_max],</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>                pgls_runC,</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">model=</span>MuPGLSMod2,</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">dataset=</span>ResDataSet) </span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>dfRes <span class="ot">&lt;-</span> <span class="fu">ldply</span> (runsRes, data.frame)</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(dfRes,<span class="st">&quot;../Data/FromCode/MuTPglsResultsRes.csv&quot;</span>)</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>FinResM <span class="ot">&lt;-</span> <span class="fu">HPDinterval</span>(<span class="fu">as.mcmc</span>(dfRes))</span></code></pre></div>
</div>
</div>
<div id="simple-model-2" class="section level3">
<h3>Simple model</h3>
<div id="mcc-tree-6" class="section level4">
<h4>MCC Tree</h4>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>spglsmodRes <span class="ot">&lt;-</span> <span class="fu">pgls</span>(Res <span class="sc">~</span> PC2 <span class="sc">+</span> size <span class="sc">+</span> PC2<span class="sc">*</span>size,</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> comp_data, <span class="at">param.CI =</span> <span class="fl">0.95</span>, <span class="at">lambda =</span> <span class="st">&quot;ML&quot;</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>sFinMccResc <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">round</span>(<span class="fu">summary</span>(spglsmodRes)<span class="sc">$</span>coefficients[,<span class="dv">1</span>],<span class="dv">3</span>)) </span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>sFinMccResp <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">round</span>(<span class="fu">summary</span>(spglsmodRes)<span class="sc">$</span>coefficients[,<span class="dv">4</span>],<span class="dv">3</span>))</span></code></pre></div>
</div>
<div id="multiple-trees-6" class="section level4">
<h4>multiple trees</h4>
<p>First step is to modify the data frame.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>SimpleRes <span class="ot">&lt;-</span> </span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  ResDataSet <span class="sc">%&gt;%</span> </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(phylogeny_name, Reflectance, size, PC2) <span class="sc">%&gt;%</span> </span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">PC =</span> PC2)</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>SimpleRes <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(SimpleRes)</span></code></pre></div>
<p>Now run the model</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>runsRessimple<span class="ot">&lt;-</span><span class="fu">lapply</span>(trees[trees_subset_min<span class="sc">:</span>trees_subset_max],</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>                      pgls_runE,</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">model=</span>MuPGLSMod4,</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">dataset=</span>SimpleRes) </span></code></pre></div>
<pre><code>## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>dfRessimple <span class="ot">&lt;-</span> <span class="fu">ldply</span> (runsRessimple, data.frame)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>FinResS <span class="ot">&lt;-</span><span class="fu">HPDinterval</span>(<span class="fu">as.mcmc</span>(dfRessimple))</span></code></pre></div>
</div>
</div>
</div>
<div id="frs" class="section level2">
<h2>FRS</h2>
<p>(i.e. residuals between NIR ~ VIS corrected by phylogeny)</p>
<div id="full-model-3" class="section level3">
<h3>Full model</h3>
<div id="mcc-tree-7" class="section level4">
<h4>MCC Tree</h4>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>pglsmodFRS <span class="ot">&lt;-</span> <span class="fu">pgls</span>(FRS <span class="sc">~</span> PC1 <span class="sc">+</span> PC2 <span class="sc">+</span> size <span class="sc">+</span> PC1<span class="sc">*</span>size <span class="sc">+</span> PC2<span class="sc">*</span>size,</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> comp_data, <span class="at">param.CI =</span> <span class="fl">0.95</span>, <span class="at">lambda =</span> <span class="st">&quot;ML&quot;</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>FinMccFRSc <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">round</span>(<span class="fu">summary</span>(pglsmodFRS)<span class="sc">$</span>coefficients[,<span class="dv">1</span>],<span class="dv">3</span>)) </span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>FinMccFRSp <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">round</span>(<span class="fu">summary</span>(pglsmodFRS)<span class="sc">$</span>coefficients[,<span class="dv">4</span>],<span class="dv">3</span>))</span></code></pre></div>
<p>Test phylogenetic signal using Pagel’s lambda:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>pagelFRS <span class="ot">&lt;-</span> Cons1agg<span class="sc">$</span>FRS <span class="co"># Define which trait you want to test</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(pagelFRS) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(Cons1agg) <span class="co"># Row names = tree tips</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="fu">phylosig</span>(MCCtree, pagelFRS, <span class="at">method =</span> <span class="st">&quot;lambda&quot;</span>, <span class="at">test =</span> <span class="cn">TRUE</span>, <span class="at">nsim =</span> <span class="dv">999</span>)</span></code></pre></div>
<pre><code>## 
## Phylogenetic signal lambda : 0.937918 
## logL(lambda) : -157.725 
## LR(lambda=0) : 7.75308 
## P-value (based on LR test) : 0.00536211</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># nsim = 999 means testing with 999 randomizations</span></span></code></pre></div>
<p>Phylogenetic signal is very high</p>
</div>
<div id="multiple-trees-7" class="section level4">
<h4>multiple trees</h4>
<p>(i.e. Residuals between NIR ~ VIS corrected by phylogeny)</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>runsFRS<span class="ot">&lt;-</span><span class="fu">lapply</span>(trees[trees_subset_min<span class="sc">:</span>trees_subset_max],</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>                pgls_runC,</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">model=</span>MuPGLSMod2,</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">dataset=</span>FRSDataSet) </span></code></pre></div>
<pre><code>## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>dfFRS <span class="ot">&lt;-</span> <span class="fu">ldply</span> (runsFRS, data.frame)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(dfFRS,<span class="st">&quot;../Data/FromCode/MuTPglsFRSultsFRS.csv&quot;</span>)</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>FinFRSM <span class="ot">&lt;-</span> <span class="fu">HPDinterval</span>(<span class="fu">as.mcmc</span>(dfFRS))</span></code></pre></div>
</div>
</div>
<div id="simple-model-3" class="section level3">
<h3>Simple model</h3>
<div id="mcc-tree-8" class="section level4">
<h4>MCC Tree</h4>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>spglsmodFRS <span class="ot">&lt;-</span> <span class="fu">pgls</span>(FRS <span class="sc">~</span> PC2 <span class="sc">+</span> size <span class="sc">+</span> PC2<span class="sc">*</span>size,</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> comp_data, <span class="at">param.CI =</span> <span class="fl">0.95</span>, <span class="at">lambda =</span> <span class="st">&quot;ML&quot;</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>sFinMccFRSc <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">round</span>(<span class="fu">summary</span>(spglsmodFRS)<span class="sc">$</span>coefficients[,<span class="dv">1</span>],<span class="dv">3</span>)) </span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>sFinMccFRSp <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">round</span>(<span class="fu">summary</span>(spglsmodFRS)<span class="sc">$</span>coefficients[,<span class="dv">4</span>],<span class="dv">3</span>))</span></code></pre></div>
</div>
<div id="multiple-trees-8" class="section level4">
<h4>multiple trees</h4>
<p>First step is to modify the data frame.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>SimpleFRS <span class="ot">&lt;-</span> </span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  FRSDataSet <span class="sc">%&gt;%</span> </span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(phylogeny_name, Reflectance, size, PC2) <span class="sc">%&gt;%</span> </span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">PC =</span> PC2)</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>SimpleFRS <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(SimpleFRS)</span></code></pre></div>
<p>Now run the model</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>runsFRSsimple<span class="ot">&lt;-</span><span class="fu">lapply</span>(trees[trees_subset_min<span class="sc">:</span>trees_subset_max],</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>                      pgls_runE,</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">model=</span>MuPGLSMod4,</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">dataset=</span>SimpleFRS) </span></code></pre></div>
<pre><code>## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>dfFRSsimple <span class="ot">&lt;-</span> <span class="fu">ldply</span> (runsFRSsimple, data.frame)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>FinFRSS <span class="ot">&lt;-</span><span class="fu">HPDinterval</span>(<span class="fu">as.mcmc</span>(dfFRSsimple))</span></code></pre></div>
</div>
</div>
</div>
</div>
<div id="final-results" class="section level1">
<h1>Final results</h1>
<div id="full-models" class="section level2">
<h2>Full models</h2>
<div id="mcc-tree-9" class="section level3">
<h3>MCC Tree</h3>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>Predictor <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;PC1&quot;</span>,<span class="st">&quot;PC1 p-val&quot;</span> , </span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;PC2&quot;</span>, <span class="st">&quot;PC2 p-val&quot;</span>, </span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;Size&quot;</span>, <span class="st">&quot;Size p-val&quot;</span>,</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;VIS&quot;</span>, <span class="st">&quot;VIS p-val&quot;</span>,</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;PC1:size&quot;</span>, <span class="st">&quot;PC1:size p-val&quot;</span>, </span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;PC2:size&quot;</span>, <span class="st">&quot;PC2:size p-val&quot;</span>)</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Arrange the vectors to build the data frame</span></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a><span class="co"># New vectors alternate coefficient and p-values to match &quot;predictors&quot;</span></span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>Toti <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rbind</span>((<span class="fu">c</span>(</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>            FinMccTotc[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>],<span class="st">&quot;NA&quot;</span>,FinMccTotc[<span class="dv">5</span><span class="sc">:</span><span class="dv">6</span>])),</span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>                (<span class="fu">c</span>(FinMccTotp[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>],<span class="st">&quot;NA&quot;</span>,FinMccTotp[<span class="dv">5</span><span class="sc">:</span><span class="dv">6</span>]))))))</span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a>Visi <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rbind</span>((<span class="fu">c</span>(</span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a>            FinMccVisc[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>],<span class="st">&quot;NA&quot;</span>,FinMccVisc[<span class="dv">5</span><span class="sc">:</span><span class="dv">6</span>])),</span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a>                (<span class="fu">c</span>(FinMccVisp[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>],<span class="st">&quot;NA&quot;</span>,FinMccVisp[<span class="dv">5</span><span class="sc">:</span><span class="dv">6</span>]))))))</span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true" tabindex="-1"></a>Niri <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rbind</span>(</span>
<span id="cb71-20"><a href="#cb71-20" aria-hidden="true" tabindex="-1"></a>            FinMccNirc[<span class="dv">2</span><span class="sc">:</span><span class="dv">7</span>], FinMccNirp[<span class="dv">2</span><span class="sc">:</span><span class="dv">7</span>]))))</span>
<span id="cb71-21"><a href="#cb71-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-22"><a href="#cb71-22" aria-hidden="true" tabindex="-1"></a>FRSi <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rbind</span>((<span class="fu">c</span>(</span>
<span id="cb71-23"><a href="#cb71-23" aria-hidden="true" tabindex="-1"></a>            FinMccFRSc[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>],<span class="st">&quot;NA&quot;</span>,FinMccFRSc[<span class="dv">5</span><span class="sc">:</span><span class="dv">6</span>])),</span>
<span id="cb71-24"><a href="#cb71-24" aria-hidden="true" tabindex="-1"></a>                (<span class="fu">c</span>(FinMccFRSp[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>],<span class="st">&quot;NA&quot;</span>,FinMccFRSp[<span class="dv">5</span><span class="sc">:</span><span class="dv">6</span>]))))))</span>
<span id="cb71-25"><a href="#cb71-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb71-26"><a href="#cb71-26" aria-hidden="true" tabindex="-1"></a><span class="co"># This section colours the signifficant p-values and their coefficients</span></span>
<span id="cb71-27"><a href="#cb71-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-28"><a href="#cb71-28" aria-hidden="true" tabindex="-1"></a>Visi[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(Visi[<span class="dv">1</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb71-29"><a href="#cb71-29" aria-hidden="true" tabindex="-1"></a>Visi[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(Visi[<span class="dv">2</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb71-30"><a href="#cb71-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-31"><a href="#cb71-31" aria-hidden="true" tabindex="-1"></a>Visi[<span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(Visi[<span class="dv">5</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb71-32"><a href="#cb71-32" aria-hidden="true" tabindex="-1"></a>Visi[<span class="dv">6</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(Visi[<span class="dv">6</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb71-33"><a href="#cb71-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-34"><a href="#cb71-34" aria-hidden="true" tabindex="-1"></a>Visi[<span class="dv">9</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(Visi[<span class="dv">9</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb71-35"><a href="#cb71-35" aria-hidden="true" tabindex="-1"></a>Visi[<span class="dv">10</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(Visi[<span class="dv">10</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb71-36"><a href="#cb71-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-37"><a href="#cb71-37" aria-hidden="true" tabindex="-1"></a>Niri[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(Niri[<span class="dv">3</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb71-38"><a href="#cb71-38" aria-hidden="true" tabindex="-1"></a>Niri[<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(Niri[<span class="dv">4</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb71-39"><a href="#cb71-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-40"><a href="#cb71-40" aria-hidden="true" tabindex="-1"></a>Niri[<span class="dv">7</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(Niri[<span class="dv">7</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb71-41"><a href="#cb71-41" aria-hidden="true" tabindex="-1"></a>Niri[<span class="dv">8</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(Niri[<span class="dv">8</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb71-42"><a href="#cb71-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-43"><a href="#cb71-43" aria-hidden="true" tabindex="-1"></a>Niri[<span class="dv">11</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(Niri[<span class="dv">11</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb71-44"><a href="#cb71-44" aria-hidden="true" tabindex="-1"></a>Niri[<span class="dv">12</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(Niri[<span class="dv">12</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb71-45"><a href="#cb71-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-46"><a href="#cb71-46" aria-hidden="true" tabindex="-1"></a>FRSi[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(FRSi[<span class="dv">3</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb71-47"><a href="#cb71-47" aria-hidden="true" tabindex="-1"></a>FRSi[<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(FRSi[<span class="dv">4</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb71-48"><a href="#cb71-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-49"><a href="#cb71-49" aria-hidden="true" tabindex="-1"></a>FRSi[<span class="dv">11</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(FRSi[<span class="dv">11</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb71-50"><a href="#cb71-50" aria-hidden="true" tabindex="-1"></a>FRSi[<span class="dv">12</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(FRSi[<span class="dv">12</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb71-51"><a href="#cb71-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-52"><a href="#cb71-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Assemble the table</span></span>
<span id="cb71-53"><a href="#cb71-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-54"><a href="#cb71-54" aria-hidden="true" tabindex="-1"></a>Resultspgls <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Predictor,  </span>
<span id="cb71-55"><a href="#cb71-55" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;TOT&quot;</span> <span class="ot">=</span> Toti,</span>
<span id="cb71-56"><a href="#cb71-56" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;VIS&quot;</span> <span class="ot">=</span> Visi,</span>
<span id="cb71-57"><a href="#cb71-57" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;NIR&quot;</span> <span class="ot">=</span> Niri,</span>
<span id="cb71-58"><a href="#cb71-58" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;Res&quot;</span> <span class="ot">=</span> FRSi) </span>
<span id="cb71-59"><a href="#cb71-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-60"><a href="#cb71-60" aria-hidden="true" tabindex="-1"></a>Resultspgls <span class="sc">%&gt;%</span> </span>
<span id="cb71-61"><a href="#cb71-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">align =</span><span class="st">&quot;c&quot;</span>, <span class="at">escape =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb71-62"><a href="#cb71-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb71-63"><a href="#cb71-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_indent</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">9</span>)) </span></code></pre></div>
<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
Predictor
</th>
<th style="text-align:center;">
TOT
</th>
<th style="text-align:center;">
VIS
</th>
<th style="text-align:center;">
NIR
</th>
<th style="text-align:center;">
Res
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;padding-left: 2em;" indentlevel="1">
PC1
</td>
<td style="text-align:center;">
-5.708
</td>
<td style="text-align:center;">
<span
style=" font-weight: bold;    color: #D40481 !important;">-6.177</span>
</td>
<td style="text-align:center;">
2.081
</td>
<td style="text-align:center;">
1.376
</td>
</tr>
<tr>
<td style="text-align:center;">
PC1 p-val
</td>
<td style="text-align:center;">
0.146
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    ">0.057</span>
</td>
<td style="text-align:center;">
0.566
</td>
<td style="text-align:center;">
0.688
</td>
</tr>
<tr>
<td style="text-align:center;padding-left: 2em;" indentlevel="1">
PC2
</td>
<td style="text-align:center;">
-0.927
</td>
<td style="text-align:center;">
-6.831
</td>
<td style="text-align:center;">
<span
style=" font-weight: bold;    color: #D40481 !important;">12.647</span>
</td>
<td style="text-align:center;">
<span
style=" font-weight: bold;    color: #D40481 !important;">11.781</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
PC2 p-val
</td>
<td style="text-align:center;">
0.846
</td>
<td style="text-align:center;">
0.086
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    ">0.007</span>
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    ">0.008</span>
</td>
</tr>
<tr>
<td style="text-align:center;padding-left: 2em;" indentlevel="1">
Size
</td>
<td style="text-align:center;">
5.998
</td>
<td style="text-align:center;">
<span
style=" font-weight: bold;    color: #D40481 !important;">7.075</span>
</td>
<td style="text-align:center;">
-3.652
</td>
<td style="text-align:center;">
-2.772
</td>
</tr>
<tr>
<td style="text-align:center;">
Size p-val
</td>
<td style="text-align:center;">
0.116
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    ">0.026</span>
</td>
<td style="text-align:center;">
0.311
</td>
<td style="text-align:center;">
0.407
</td>
</tr>
<tr>
<td style="text-align:center;padding-left: 2em;" indentlevel="1">
VIS
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
<span
style=" font-weight: bold;    color: #D40481 !important;">1.163</span>
</td>
<td style="text-align:center;">
NA
</td>
</tr>
<tr>
<td style="text-align:center;">
VIS p-val
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    ">0</span>
</td>
<td style="text-align:center;">
NA
</td>
</tr>
<tr>
<td style="text-align:center;padding-left: 2em;" indentlevel="1">
PC1:size
</td>
<td style="text-align:center;">
2.653
</td>
<td style="text-align:center;">
<span
style=" font-weight: bold;    color: #D40481 !important;">2.723</span>
</td>
<td style="text-align:center;">
-0.691
</td>
<td style="text-align:center;">
-0.371
</td>
</tr>
<tr>
<td style="text-align:center;">
PC1:size p-val
</td>
<td style="text-align:center;">
0.113
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    ">0.049</span>
</td>
<td style="text-align:center;">
0.656
</td>
<td style="text-align:center;">
0.8
</td>
</tr>
<tr>
<td style="text-align:center;">
PC2:size
</td>
<td style="text-align:center;">
0.302
</td>
<td style="text-align:center;">
2.563
</td>
<td style="text-align:center;">
<span
style=" font-weight: bold;    color: #D40481 !important;">-4.866</span>
</td>
<td style="text-align:center;">
<span
style=" font-weight: bold;    color: #D40481 !important;">-4.531</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
PC2:size p-val
</td>
<td style="text-align:center;">
0.874
</td>
<td style="text-align:center;">
0.105
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    ">0.009</span>
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    ">0.01</span>
</td>
</tr>
</tbody>
</table>
</div>
<div id="multiple-trees-9" class="section level3">
<h3>multiple trees</h3>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>rvTOTl <span class="ot">&lt;-</span> <span class="fu">as.character</span>(</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="fu">c</span>(</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>              FinTotM[<span class="dv">1</span>,<span class="dv">1</span>],FinTotM[<span class="dv">3</span>,<span class="dv">1</span>],FinTotM[<span class="dv">4</span>,<span class="dv">1</span>],FinTotM[<span class="dv">6</span>,<span class="dv">1</span>],</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>              FinTotM[<span class="dv">7</span>,<span class="dv">1</span>],FinTotM[<span class="dv">9</span>,<span class="dv">1</span>],<span class="st">&quot;NA&quot;</span>,<span class="st">&quot;NA&quot;</span>,</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>              FinTotM[<span class="dv">10</span>,<span class="dv">1</span>],FinTotM[<span class="dv">12</span>,<span class="dv">1</span>],</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>              FinTotM[<span class="dv">13</span>,<span class="dv">1</span>],FinTotM[<span class="dv">15</span>,<span class="dv">1</span>])),<span class="dv">3</span>))</span></code></pre></div>
<pre><code>## Warning: NAs introduced by coercion</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>rvTOTu <span class="ot">&lt;-</span> <span class="fu">as.character</span>(</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">format</span>(<span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="fu">c</span>(</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>              FinTotM[<span class="dv">1</span>,<span class="dv">2</span>],FinTotM[<span class="dv">3</span>,<span class="dv">2</span>],FinTotM[<span class="dv">4</span>,<span class="dv">2</span>],FinTotM[<span class="dv">6</span>,<span class="dv">2</span>],</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>              FinTotM[<span class="dv">7</span>,<span class="dv">2</span>],FinTotM[<span class="dv">9</span>,<span class="dv">2</span>],<span class="st">&quot;NA&quot;</span>,<span class="st">&quot;NA&quot;</span>,</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>              FinTotM[<span class="dv">10</span>,<span class="dv">2</span>],FinTotM[<span class="dv">12</span>,<span class="dv">2</span>],</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>              FinTotM[<span class="dv">13</span>,<span class="dv">2</span>],FinTotM[<span class="dv">15</span>,<span class="dv">2</span>])),<span class="dv">3</span>),<span class="at">nsmall=</span><span class="dv">3</span>))</span></code></pre></div>
<pre><code>## Warning in format(round(as.numeric(c(FinTotM[1, 2], FinTotM[3, 2], FinTotM[4, :
## NAs introduced by coercion</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>rvVISl <span class="ot">&lt;-</span> <span class="fu">as.character</span>(</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>          <span class="fu">format</span>(<span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="fu">c</span>(</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>              FinVisM[<span class="dv">1</span>,<span class="dv">1</span>],FinVisM[<span class="dv">3</span>,<span class="dv">1</span>],FinVisM[<span class="dv">4</span>,<span class="dv">1</span>],FinVisM[<span class="dv">6</span>,<span class="dv">1</span>],</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>              FinVisM[<span class="dv">7</span>,<span class="dv">1</span>],FinVisM[<span class="dv">9</span>,<span class="dv">1</span>],<span class="st">&quot;NA&quot;</span>,<span class="st">&quot;NA&quot;</span>,</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>              FinVisM[<span class="dv">10</span>,<span class="dv">1</span>],FinVisM[<span class="dv">12</span>,<span class="dv">1</span>],</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>              FinVisM[<span class="dv">13</span>,<span class="dv">1</span>],FinVisM[<span class="dv">15</span>,<span class="dv">1</span>])),<span class="dv">3</span>),<span class="at">nsmall=</span><span class="dv">3</span>))</span></code></pre></div>
<pre><code>## Warning in format(round(as.numeric(c(FinVisM[1, 1], FinVisM[3, 1], FinVisM[4, :
## NAs introduced by coercion</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>rvVISu <span class="ot">&lt;-</span> <span class="fu">as.character</span>(</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">format</span>(<span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="fu">c</span>(</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>              FinVisM[<span class="dv">1</span>,<span class="dv">2</span>],FinVisM[<span class="dv">3</span>,<span class="dv">2</span>],FinVisM[<span class="dv">4</span>,<span class="dv">2</span>],FinVisM[<span class="dv">6</span>,<span class="dv">2</span>],</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>              FinVisM[<span class="dv">7</span>,<span class="dv">2</span>],FinVisM[<span class="dv">9</span>,<span class="dv">2</span>],<span class="st">&quot;NA&quot;</span>,<span class="st">&quot;NA&quot;</span>,</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>              FinVisM[<span class="dv">10</span>,<span class="dv">2</span>],FinVisM[<span class="dv">12</span>,<span class="dv">2</span>],</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>              FinVisM[<span class="dv">13</span>,<span class="dv">2</span>],FinVisM[<span class="dv">15</span>,<span class="dv">2</span>])),<span class="dv">3</span>),<span class="at">nsmall=</span><span class="dv">3</span>))</span></code></pre></div>
<pre><code>## Warning in format(round(as.numeric(c(FinVisM[1, 2], FinVisM[3, 2], FinVisM[4, :
## NAs introduced by coercion</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>rvNIRl <span class="ot">&lt;-</span> <span class="fu">as.character</span>(</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">format</span>(<span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="fu">c</span>(</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>              FinNirM[<span class="dv">1</span>,<span class="dv">1</span>],FinNirM[<span class="dv">3</span>,<span class="dv">1</span>],FinNirM[<span class="dv">4</span>,<span class="dv">1</span>],FinNirM[<span class="dv">6</span>,<span class="dv">1</span>],</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>              FinNirM[<span class="dv">7</span>,<span class="dv">1</span>],FinNirM[<span class="dv">9</span>,<span class="dv">1</span>],FinNirM[<span class="dv">10</span>,<span class="dv">1</span>],FinNirM[<span class="dv">12</span>,<span class="dv">1</span>],</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>              FinNirM[<span class="dv">13</span>,<span class="dv">1</span>],FinNirM[<span class="dv">15</span>,<span class="dv">1</span>], FinNirM[<span class="dv">16</span>,<span class="dv">1</span>],FinNirM[<span class="dv">18</span>,<span class="dv">1</span>]</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>              )),<span class="dv">3</span>),<span class="at">nsmall=</span><span class="dv">3</span>))</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>rvNIRu <span class="ot">&lt;-</span> <span class="fu">as.character</span>(</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>           <span class="fu">format</span>(<span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="fu">c</span>(</span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>              FinNirM[<span class="dv">1</span>,<span class="dv">2</span>],FinNirM[<span class="dv">3</span>,<span class="dv">2</span>],FinNirM[<span class="dv">4</span>,<span class="dv">2</span>],FinNirM[<span class="dv">6</span>,<span class="dv">2</span>],</span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>              FinNirM[<span class="dv">7</span>,<span class="dv">2</span>],FinNirM[<span class="dv">9</span>,<span class="dv">2</span>],FinNirM[<span class="dv">10</span>,<span class="dv">2</span>],FinNirM[<span class="dv">12</span>,<span class="dv">2</span>],</span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a>              FinNirM[<span class="dv">13</span>,<span class="dv">2</span>],FinNirM[<span class="dv">15</span>,<span class="dv">2</span>], FinNirM[<span class="dv">16</span>,<span class="dv">2</span>],FinNirM[<span class="dv">18</span>,<span class="dv">2</span>]</span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a>              )),<span class="dv">3</span>),<span class="at">nsmall=</span><span class="dv">3</span>))</span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a>rvFRSl <span class="ot">&lt;-</span> <span class="fu">as.character</span>(</span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a>            <span class="fu">format</span>(<span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="fu">c</span>(</span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a>              FinFRSM[<span class="dv">1</span>,<span class="dv">1</span>],FinFRSM[<span class="dv">3</span>,<span class="dv">1</span>],FinFRSM[<span class="dv">4</span>,<span class="dv">1</span>],FinFRSM[<span class="dv">6</span>,<span class="dv">1</span>],</span>
<span id="cb80-18"><a href="#cb80-18" aria-hidden="true" tabindex="-1"></a>              FinFRSM[<span class="dv">7</span>,<span class="dv">1</span>],FinFRSM[<span class="dv">9</span>,<span class="dv">1</span>],<span class="st">&quot;NA&quot;</span>,<span class="st">&quot;NA&quot;</span>,</span>
<span id="cb80-19"><a href="#cb80-19" aria-hidden="true" tabindex="-1"></a>              FinFRSM[<span class="dv">10</span>,<span class="dv">1</span>],FinFRSM[<span class="dv">12</span>,<span class="dv">1</span>],</span>
<span id="cb80-20"><a href="#cb80-20" aria-hidden="true" tabindex="-1"></a>              FinFRSM[<span class="dv">13</span>,<span class="dv">1</span>],FinFRSM[<span class="dv">15</span>,<span class="dv">1</span>])),<span class="dv">3</span>),<span class="at">nsmall=</span><span class="dv">3</span>))</span></code></pre></div>
<pre><code>## Warning in format(round(as.numeric(c(FinFRSM[1, 1], FinFRSM[3, 1], FinFRSM[4, :
## NAs introduced by coercion</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>rvFRSu <span class="ot">&lt;-</span> <span class="fu">as.character</span>(</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">format</span>(<span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="fu">c</span>(</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>              FinFRSM[<span class="dv">1</span>,<span class="dv">2</span>],FinFRSM[<span class="dv">3</span>,<span class="dv">2</span>],FinFRSM[<span class="dv">4</span>,<span class="dv">2</span>],FinFRSM[<span class="dv">6</span>,<span class="dv">2</span>],</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>              FinFRSM[<span class="dv">7</span>,<span class="dv">2</span>],FinFRSM[<span class="dv">9</span>,<span class="dv">2</span>],<span class="st">&quot;NA&quot;</span>,<span class="st">&quot;NA&quot;</span>,</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>              FinFRSM[<span class="dv">10</span>,<span class="dv">2</span>],FinFRSM[<span class="dv">12</span>,<span class="dv">2</span>],</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>              FinFRSM[<span class="dv">13</span>,<span class="dv">2</span>],FinFRSM[<span class="dv">15</span>,<span class="dv">2</span>])),<span class="dv">3</span>),<span class="at">nsmall=</span><span class="dv">3</span>))</span></code></pre></div>
<pre><code>## Warning in format(round(as.numeric(c(FinFRSM[1, 2], FinFRSM[3, 2], FinFRSM[4, :
## NAs introduced by coercion</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>rvTOTi<span class="ot">&lt;-</span><span class="fu">paste</span>(rvTOTl,rvTOTu, <span class="at">sep =</span> <span class="st">&quot; ; &quot;</span>)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>rvVISi<span class="ot">&lt;-</span><span class="fu">paste</span>(rvVISl,rvVISu, <span class="at">sep =</span> <span class="st">&quot; ; &quot;</span>)</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>rvNIRi<span class="ot">&lt;-</span><span class="fu">paste</span>(rvNIRl,rvNIRu, <span class="at">sep =</span> <span class="st">&quot; ; &quot;</span>)</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>rvFRSi<span class="ot">&lt;-</span><span class="fu">paste</span>(rvFRSl,rvFRSu, <span class="at">sep =</span> <span class="st">&quot; ; &quot;</span>)</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>rvVISi[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(rvVISi[<span class="dv">1</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#367D91&quot;</span>)</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>rvVISi[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(rvVISi[<span class="dv">2</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#B2B9BF&quot;</span>)</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>rvVISi[<span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(rvVISi[<span class="dv">5</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>rvVISi[<span class="dv">6</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(rvVISi[<span class="dv">6</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a>rvVISi[<span class="dv">9</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(rvVISi[<span class="dv">9</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#367D91&quot;</span>)</span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a>rvVISi[<span class="dv">10</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(rvVISi[<span class="dv">10</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>,  <span class="at">color=</span><span class="st">&quot;#B2B9BF&quot;</span>)</span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a>rvNIRi[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(rvNIRi[<span class="dv">3</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a>rvNIRi[<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(rvNIRi[<span class="dv">4</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a>rvNIRi[<span class="dv">7</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(rvNIRi[<span class="dv">7</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a>rvNIRi[<span class="dv">8</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(rvNIRi[<span class="dv">8</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-21"><a href="#cb84-21" aria-hidden="true" tabindex="-1"></a>rvNIRi[<span class="dv">11</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(rvNIRi[<span class="dv">11</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb84-22"><a href="#cb84-22" aria-hidden="true" tabindex="-1"></a>rvNIRi[<span class="dv">12</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(rvNIRi[<span class="dv">12</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb84-23"><a href="#cb84-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-24"><a href="#cb84-24" aria-hidden="true" tabindex="-1"></a>rvFRSi[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(rvFRSi[<span class="dv">3</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb84-25"><a href="#cb84-25" aria-hidden="true" tabindex="-1"></a>rvFRSi[<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(rvFRSi[<span class="dv">4</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb84-26"><a href="#cb84-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-27"><a href="#cb84-27" aria-hidden="true" tabindex="-1"></a>rvFRSi[<span class="dv">11</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(rvFRSi[<span class="dv">11</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb84-28"><a href="#cb84-28" aria-hidden="true" tabindex="-1"></a>rvFRSi[<span class="dv">12</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(rvFRSi[<span class="dv">12</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb84-29"><a href="#cb84-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-30"><a href="#cb84-30" aria-hidden="true" tabindex="-1"></a>Resultspgls <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Predictor,  </span>
<span id="cb84-31"><a href="#cb84-31" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;TOT&quot;</span> <span class="ot">=</span> rvTOTi,</span>
<span id="cb84-32"><a href="#cb84-32" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;VIS&quot;</span> <span class="ot">=</span> rvVISi,</span>
<span id="cb84-33"><a href="#cb84-33" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;NIR&quot;</span> <span class="ot">=</span> rvNIRi,</span>
<span id="cb84-34"><a href="#cb84-34" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;Res&quot;</span> <span class="ot">=</span> rvFRSi) </span>
<span id="cb84-35"><a href="#cb84-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-36"><a href="#cb84-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-37"><a href="#cb84-37" aria-hidden="true" tabindex="-1"></a>Resultspgls <span class="sc">%&gt;%</span> </span>
<span id="cb84-38"><a href="#cb84-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">align =</span><span class="st">&quot;c&quot;</span>, <span class="at">escape =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb84-39"><a href="#cb84-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb84-40"><a href="#cb84-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_indent</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">9</span>)) </span></code></pre></div>
<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
Predictor
</th>
<th style="text-align:center;">
TOT
</th>
<th style="text-align:center;">
VIS
</th>
<th style="text-align:center;">
NIR
</th>
<th style="text-align:center;">
Res
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;padding-left: 2em;" indentlevel="1">
PC1
</td>
<td style="text-align:center;">
-7.355 ; -4.786
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    color: #367D91 !important;">-7.737 ;
-5.307</span>
</td>
<td style="text-align:center;">
0.869 ; 3.144
</td>
<td style="text-align:center;">
0.212 ; 2.294
</td>
</tr>
<tr>
<td style="text-align:center;">
PC1 p-val
</td>
<td style="text-align:center;">
0.056 ; 0.248
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    color: #B2B9BF !important;"> 0.017 ;
0.093</span>
</td>
<td style="text-align:center;">
0.404 ; 0.808
</td>
<td style="text-align:center;">
0.502 ; 0.940
</td>
</tr>
<tr>
<td style="text-align:center;padding-left: 2em;" indentlevel="1">
PC2
</td>
<td style="text-align:center;">
-2.871 ; 1.017
</td>
<td style="text-align:center;">
-8.333 ; -5.344
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    color: #D40481 !important;">10.375 ;
15.124</span>
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    color: #D40481 !important;"> 9.576 ;
14.173</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
PC2 p-val
</td>
<td style="text-align:center;">
0.605 ; 1.000
</td>
<td style="text-align:center;">
0.029 ; 0.166
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    "> 0.000 ; 0.023</span>
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    "> 0.000 ; 0.026</span>
</td>
</tr>
<tr>
<td style="text-align:center;padding-left: 2em;" indentlevel="1">
Size
</td>
<td style="text-align:center;">
4.106 ; 7.896
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    color: #D40481 !important;"> 6.080 ;
8.428</span>
</td>
<td style="text-align:center;">
-5.348 ; -1.774
</td>
<td style="text-align:center;">
-4.388 ; -1.084
</td>
</tr>
<tr>
<td style="text-align:center;">
Size p-val
</td>
<td style="text-align:center;">
0.039 ; 0.307
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    "> 0.008 ; 0.053</span>
</td>
<td style="text-align:center;">
0.145 ; 0.599
</td>
<td style="text-align:center;">
0.207 ; 0.707
</td>
</tr>
<tr>
<td style="text-align:center;padding-left: 2em;" indentlevel="1">
VIS
</td>
<td style="text-align:center;">
NA ; NA
</td>
<td style="text-align:center;">
NA ; NA
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    color: #D40481 !important;"> 1.113 ;
1.219</span>
</td>
<td style="text-align:center;">
NA ; NA
</td>
</tr>
<tr>
<td style="text-align:center;">
VIS p-val
</td>
<td style="text-align:center;">
NA ; NA
</td>
<td style="text-align:center;">
NA ; NA
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    "> 0.000 ; 0.000</span>
</td>
<td style="text-align:center;">
NA ; NA
</td>
</tr>
<tr>
<td style="text-align:center;padding-left: 2em;" indentlevel="1">
PC1:size
</td>
<td style="text-align:center;">
2.237 ; 3.326
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    color: #367D91 !important;"> 2.388 ;
3.364</span>
</td>
<td style="text-align:center;">
-1.253 ; -0.152
</td>
<td style="text-align:center;">
-0.900 ; 0.138
</td>
</tr>
<tr>
<td style="text-align:center;">
PC1:size p-val
</td>
<td style="text-align:center;">
0.039 ; 0.221
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    color: #B2B9BF !important;"> 0.014 ;
0.082</span>
</td>
<td style="text-align:center;">
0.439 ; 0.925
</td>
<td style="text-align:center;">
0.597 ; 0.999
</td>
</tr>
<tr>
<td style="text-align:center;">
PC2:size
</td>
<td style="text-align:center;">
-0.489 ; 1.083
</td>
<td style="text-align:center;">
1.939 ; 3.163
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    color: #D40481 !important;">-5.888 ;
-3.974</span>
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    color: #D40481 !important;">-5.544 ;
-3.718</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
PC2:size p-val
</td>
<td style="text-align:center;">
0.614 ; 1.000
</td>
<td style="text-align:center;">
0.041 ; 0.195
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    "> 0.001 ; 0.026</span>
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    "> 0.001 ; 0.029</span>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="simple-models" class="section level2">
<h2>Simple models</h2>
<div id="mcc-tree-10" class="section level3">
<h3>MCC Tree</h3>
<p>We run reduced models with the predictors that were signifficant in
the MCC tree to confirm the patterns and to reduce issues with the
abnormal termination in some trees (because in larger models some
parameters can’t be calculated when using particular trees)</p>
<p>In this table PC represents the relevant PC for each band: For VIS it
is PC1 and for NIR/Res it is PC2. This is also true for the
correspondent interactions.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>sPredictor <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;PC&quot;</span>,<span class="st">&quot;PC p-val&quot;</span> , </span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;Size&quot;</span>, <span class="st">&quot;Size p-val&quot;</span>,</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;VIS&quot;</span>, <span class="st">&quot;VIS p-val&quot;</span>, </span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;PC:size&quot;</span>, <span class="st">&quot;PC:size p-val&quot;</span>)</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Arrange the vectors to build the data frame</span></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a><span class="co"># New vectors alternate coefficient and p-values to match &quot;predictors&quot;</span></span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>sVisi <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rbind</span>((<span class="fu">c</span>(</span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>            sFinMccVisc[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>],<span class="st">&quot;NA&quot;</span>,sFinMccVisc[<span class="dv">4</span>])),</span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>                (<span class="fu">c</span>(sFinMccVisp[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>],<span class="st">&quot;NA&quot;</span>,sFinMccVisp[<span class="dv">4</span>]))))))</span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a>sNiri <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rbind</span>(</span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a>            sFinMccNirc[<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>], sFinMccNirp[<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>]))))</span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-16"><a href="#cb85-16" aria-hidden="true" tabindex="-1"></a>sFRSi <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rbind</span>((<span class="fu">c</span>(</span>
<span id="cb85-17"><a href="#cb85-17" aria-hidden="true" tabindex="-1"></a>            sFinMccFRSc[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>],<span class="st">&quot;NA&quot;</span>,sFinMccFRSc[<span class="dv">4</span>])),</span>
<span id="cb85-18"><a href="#cb85-18" aria-hidden="true" tabindex="-1"></a>                (<span class="fu">c</span>(sFinMccFRSp[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>],<span class="st">&quot;NA&quot;</span>,sFinMccFRSp[<span class="dv">4</span>]))))))</span>
<span id="cb85-19"><a href="#cb85-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb85-20"><a href="#cb85-20" aria-hidden="true" tabindex="-1"></a><span class="co"># This section colours the signifficant p-values and their coefficients</span></span>
<span id="cb85-21"><a href="#cb85-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-22"><a href="#cb85-22" aria-hidden="true" tabindex="-1"></a>sVisi[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(sVisi[<span class="dv">1</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb85-23"><a href="#cb85-23" aria-hidden="true" tabindex="-1"></a>sVisi[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(sVisi[<span class="dv">2</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb85-24"><a href="#cb85-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-25"><a href="#cb85-25" aria-hidden="true" tabindex="-1"></a>sVisi[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(sVisi[<span class="dv">3</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb85-26"><a href="#cb85-26" aria-hidden="true" tabindex="-1"></a>sVisi[<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(sVisi[<span class="dv">4</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb85-27"><a href="#cb85-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-28"><a href="#cb85-28" aria-hidden="true" tabindex="-1"></a>sVisi[<span class="dv">7</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(sVisi[<span class="dv">7</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb85-29"><a href="#cb85-29" aria-hidden="true" tabindex="-1"></a>sVisi[<span class="dv">8</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(sVisi[<span class="dv">8</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb85-30"><a href="#cb85-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-31"><a href="#cb85-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-32"><a href="#cb85-32" aria-hidden="true" tabindex="-1"></a>sNiri[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(sNiri[<span class="dv">1</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb85-33"><a href="#cb85-33" aria-hidden="true" tabindex="-1"></a>sNiri[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(sNiri[<span class="dv">2</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb85-34"><a href="#cb85-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-35"><a href="#cb85-35" aria-hidden="true" tabindex="-1"></a>sNiri[<span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(sNiri[<span class="dv">5</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb85-36"><a href="#cb85-36" aria-hidden="true" tabindex="-1"></a>sNiri[<span class="dv">6</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(sNiri[<span class="dv">6</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb85-37"><a href="#cb85-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-38"><a href="#cb85-38" aria-hidden="true" tabindex="-1"></a>sNiri[<span class="dv">7</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(sNiri[<span class="dv">7</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb85-39"><a href="#cb85-39" aria-hidden="true" tabindex="-1"></a>sNiri[<span class="dv">8</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(sNiri[<span class="dv">8</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb85-40"><a href="#cb85-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-41"><a href="#cb85-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-42"><a href="#cb85-42" aria-hidden="true" tabindex="-1"></a>sFRSi[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(sFRSi[<span class="dv">1</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb85-43"><a href="#cb85-43" aria-hidden="true" tabindex="-1"></a>sFRSi[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(sFRSi[<span class="dv">2</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb85-44"><a href="#cb85-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-45"><a href="#cb85-45" aria-hidden="true" tabindex="-1"></a>sFRSi[<span class="dv">7</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(sFRSi[<span class="dv">7</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb85-46"><a href="#cb85-46" aria-hidden="true" tabindex="-1"></a>sFRSi[<span class="dv">8</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(sFRSi[<span class="dv">8</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb85-47"><a href="#cb85-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-48"><a href="#cb85-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Assemble the table</span></span>
<span id="cb85-49"><a href="#cb85-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-50"><a href="#cb85-50" aria-hidden="true" tabindex="-1"></a>sResultspgls <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(sPredictor,  </span>
<span id="cb85-51"><a href="#cb85-51" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;VIS&quot;</span> <span class="ot">=</span> sVisi,</span>
<span id="cb85-52"><a href="#cb85-52" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;NIR&quot;</span> <span class="ot">=</span> sNiri,</span>
<span id="cb85-53"><a href="#cb85-53" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;Res&quot;</span> <span class="ot">=</span> sFRSi) </span>
<span id="cb85-54"><a href="#cb85-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-55"><a href="#cb85-55" aria-hidden="true" tabindex="-1"></a>sResultspgls <span class="sc">%&gt;%</span> </span>
<span id="cb85-56"><a href="#cb85-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">align =</span><span class="st">&quot;c&quot;</span>, <span class="at">escape =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb85-57"><a href="#cb85-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb85-58"><a href="#cb85-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_indent</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>)) </span></code></pre></div>
<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
sPredictor
</th>
<th style="text-align:center;">
VIS
</th>
<th style="text-align:center;">
NIR
</th>
<th style="text-align:center;">
Res
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;padding-left: 2em;" indentlevel="1">
PC
</td>
<td style="text-align:center;">
<span
style=" font-weight: bold;    color: #D40481 !important;">-6.056</span>
</td>
<td style="text-align:center;">
<span
style=" font-weight: bold;    color: #D40481 !important;">13.192</span>
</td>
<td style="text-align:center;">
<span
style=" font-weight: bold;    color: #D40481 !important;">12.737</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
PC p-val
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    ">0.019</span>
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    ">0.002</span>
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    ">0.002</span>
</td>
</tr>
<tr>
<td style="text-align:center;padding-left: 2em;" indentlevel="1">
Size
</td>
<td style="text-align:center;">
<span
style=" font-weight: bold;    color: #D40481 !important;">5.312</span>
</td>
<td style="text-align:center;">
-2.623
</td>
<td style="text-align:center;">
-2.256
</td>
</tr>
<tr>
<td style="text-align:center;">
Size p-val
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    ">0.034</span>
</td>
<td style="text-align:center;">
0.358
</td>
<td style="text-align:center;">
0.414
</td>
</tr>
<tr>
<td style="text-align:center;padding-left: 2em;" indentlevel="1">
VIS
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
<span
style=" font-weight: bold;    color: #D40481 !important;">1.147</span>
</td>
<td style="text-align:center;">
NA
</td>
</tr>
<tr>
<td style="text-align:center;">
VIS p-val
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    ">0</span>
</td>
<td style="text-align:center;">
NA
</td>
</tr>
<tr>
<td style="text-align:center;padding-left: 2em;" indentlevel="1">
PC:size
</td>
<td style="text-align:center;">
<span
style=" font-weight: bold;    color: #D40481 !important;">2.553</span>
</td>
<td style="text-align:center;">
<span
style=" font-weight: bold;    color: #D40481 !important;">-5.015</span>
</td>
<td style="text-align:center;">
<span
style=" font-weight: bold;    color: #D40481 !important;">-4.871</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
PC:size p-val
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    ">0.018</span>
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    ">0.002</span>
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    ">0.003</span>
</td>
</tr>
</tbody>
</table>
</div>
<div id="multiple-trees-10" class="section level3">
<h3>multiple trees</h3>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>srvVISl <span class="ot">&lt;-</span> <span class="fu">as.character</span>(</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">format</span>(<span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="fu">c</span>(</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>              FinVisS[<span class="dv">1</span>,<span class="dv">1</span>],FinVisS[<span class="dv">3</span>,<span class="dv">1</span>],</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>              FinResS[<span class="dv">4</span>,<span class="dv">1</span>],FinVisS[<span class="dv">6</span>,<span class="dv">1</span>],<span class="st">&quot;NA&quot;</span>,<span class="st">&quot;NA&quot;</span>,</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>              FinVisS[<span class="dv">7</span>,<span class="dv">1</span>],FinVisS[<span class="dv">9</span>,<span class="dv">1</span>])),<span class="dv">3</span>),<span class="at">nsmall=</span><span class="dv">3</span>))</span></code></pre></div>
<pre><code>## Warning in format(round(as.numeric(c(FinVisS[1, 1], FinVisS[3, 1], FinResS[4, :
## NAs introduced by coercion</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>srvVISu <span class="ot">&lt;-</span> <span class="fu">as.character</span>(</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">format</span>(<span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="fu">c</span>(</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>              FinVisS[<span class="dv">1</span>,<span class="dv">2</span>],FinVisS[<span class="dv">3</span>,<span class="dv">2</span>],</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>              FinVisS[<span class="dv">4</span>,<span class="dv">2</span>],FinVisS[<span class="dv">6</span>,<span class="dv">2</span>],<span class="st">&quot;NA&quot;</span>,<span class="st">&quot;NA&quot;</span>,</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>              FinVisS[<span class="dv">7</span>,<span class="dv">2</span>],FinVisS[<span class="dv">9</span>,<span class="dv">2</span>])),<span class="dv">3</span>),<span class="at">nsmall=</span><span class="dv">3</span>))</span></code></pre></div>
<pre><code>## Warning in format(round(as.numeric(c(FinVisS[1, 2], FinVisS[3, 2], FinVisS[4, :
## NAs introduced by coercion</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>srvNIRl <span class="ot">&lt;-</span> <span class="fu">as.character</span>(</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">format</span>(<span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="fu">c</span>(</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>              FinNirS[<span class="dv">1</span>,<span class="dv">1</span>],FinNirS[<span class="dv">3</span>,<span class="dv">1</span>],</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>              FinNirS[<span class="dv">4</span>,<span class="dv">1</span>],FinNirS[<span class="dv">6</span>,<span class="dv">1</span>],</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>              FinNirS[<span class="dv">7</span>,<span class="dv">1</span>],FinNirS[<span class="dv">9</span>,<span class="dv">1</span>],</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>              FinNirS[<span class="dv">10</span>,<span class="dv">1</span>],FinNirS[<span class="dv">12</span>,<span class="dv">1</span>]</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>              )),<span class="dv">3</span>),<span class="at">nsmall=</span><span class="dv">3</span>))</span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>srvNIRu <span class="ot">&lt;-</span> <span class="fu">as.character</span>(</span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>           <span class="fu">format</span>(<span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="fu">c</span>(</span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>              FinNirS[<span class="dv">1</span>,<span class="dv">2</span>],FinNirS[<span class="dv">3</span>,<span class="dv">2</span>],</span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>              FinNirS[<span class="dv">4</span>,<span class="dv">2</span>],FinNirS[<span class="dv">6</span>,<span class="dv">2</span>],</span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a>              FinNirS[<span class="dv">7</span>,<span class="dv">2</span>],FinNirS[<span class="dv">9</span>,<span class="dv">2</span>],</span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a>              FinNirS[<span class="dv">10</span>,<span class="dv">2</span>],FinNirS[<span class="dv">12</span>,<span class="dv">2</span>]</span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a>              )),<span class="dv">3</span>),<span class="at">nsmall=</span><span class="dv">3</span>))</span>
<span id="cb90-16"><a href="#cb90-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-17"><a href="#cb90-17" aria-hidden="true" tabindex="-1"></a>srvFRSl <span class="ot">&lt;-</span> <span class="fu">as.character</span>(</span>
<span id="cb90-18"><a href="#cb90-18" aria-hidden="true" tabindex="-1"></a>            <span class="fu">format</span>(<span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="fu">c</span>(</span>
<span id="cb90-19"><a href="#cb90-19" aria-hidden="true" tabindex="-1"></a>              FinFRSS[<span class="dv">1</span>,<span class="dv">1</span>],FinFRSS[<span class="dv">3</span>,<span class="dv">1</span>],</span>
<span id="cb90-20"><a href="#cb90-20" aria-hidden="true" tabindex="-1"></a>              FinFRSS[<span class="dv">4</span>,<span class="dv">1</span>],FinFRSS[<span class="dv">6</span>,<span class="dv">1</span>],<span class="st">&quot;NA&quot;</span>,<span class="st">&quot;NA&quot;</span>,</span>
<span id="cb90-21"><a href="#cb90-21" aria-hidden="true" tabindex="-1"></a>              FinFRSS[<span class="dv">7</span>,<span class="dv">1</span>],FinFRSS[<span class="dv">9</span>,<span class="dv">1</span>])),<span class="dv">3</span>),<span class="at">nsmall=</span><span class="dv">3</span>))</span></code></pre></div>
<pre><code>## Warning in format(round(as.numeric(c(FinFRSS[1, 1], FinFRSS[3, 1], FinFRSS[4, :
## NAs introduced by coercion</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>srvFRSu <span class="ot">&lt;-</span> <span class="fu">as.character</span>(</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">format</span>(<span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="fu">c</span>(</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>              FinFRSS[<span class="dv">1</span>,<span class="dv">2</span>],FinFRSS[<span class="dv">3</span>,<span class="dv">2</span>],</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>              FinFRSS[<span class="dv">4</span>,<span class="dv">2</span>],FinFRSS[<span class="dv">6</span>,<span class="dv">2</span>],<span class="st">&quot;NA&quot;</span>,<span class="st">&quot;NA&quot;</span>,</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>              FinFRSS[<span class="dv">7</span>,<span class="dv">2</span>],FinFRSS[<span class="dv">9</span>,<span class="dv">2</span>])),<span class="dv">3</span>),<span class="at">nsmall=</span><span class="dv">3</span>))</span></code></pre></div>
<pre><code>## Warning in format(round(as.numeric(c(FinFRSS[1, 2], FinFRSS[3, 2], FinFRSS[4, :
## NAs introduced by coercion</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>srvVISi<span class="ot">&lt;-</span><span class="fu">paste</span>(srvVISl,srvVISu, <span class="at">sep =</span> <span class="st">&quot; ; &quot;</span>)</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>srvNIRi<span class="ot">&lt;-</span><span class="fu">paste</span>(srvNIRl,srvNIRu, <span class="at">sep =</span> <span class="st">&quot; ; &quot;</span>)</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>srvFRSi<span class="ot">&lt;-</span><span class="fu">paste</span>(srvFRSl,srvFRSu, <span class="at">sep =</span> <span class="st">&quot; ; &quot;</span>)</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>srvVISi[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(srvVISi[<span class="dv">1</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>srvVISi[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(srvVISi[<span class="dv">2</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>srvVISi[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(srvVISi[<span class="dv">3</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>srvVISi[<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(srvVISi[<span class="dv">4</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a>srvVISi[<span class="dv">7</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(srvVISi[<span class="dv">7</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a>srvVISi[<span class="dv">8</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(srvVISi[<span class="dv">8</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-14"><a href="#cb94-14" aria-hidden="true" tabindex="-1"></a>srvNIRi[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(srvNIRi[<span class="dv">1</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb94-15"><a href="#cb94-15" aria-hidden="true" tabindex="-1"></a>srvNIRi[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(srvNIRi[<span class="dv">2</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb94-16"><a href="#cb94-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-17"><a href="#cb94-17" aria-hidden="true" tabindex="-1"></a>srvNIRi[<span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(srvNIRi[<span class="dv">5</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb94-18"><a href="#cb94-18" aria-hidden="true" tabindex="-1"></a>srvNIRi[<span class="dv">6</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(srvNIRi[<span class="dv">6</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb94-19"><a href="#cb94-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-20"><a href="#cb94-20" aria-hidden="true" tabindex="-1"></a>srvNIRi[<span class="dv">7</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(srvNIRi[<span class="dv">7</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb94-21"><a href="#cb94-21" aria-hidden="true" tabindex="-1"></a>srvNIRi[<span class="dv">8</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(srvNIRi[<span class="dv">8</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb94-22"><a href="#cb94-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-23"><a href="#cb94-23" aria-hidden="true" tabindex="-1"></a>srvFRSi[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(srvFRSi[<span class="dv">1</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb94-24"><a href="#cb94-24" aria-hidden="true" tabindex="-1"></a>srvFRSi[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(srvFRSi[<span class="dv">2</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb94-25"><a href="#cb94-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-26"><a href="#cb94-26" aria-hidden="true" tabindex="-1"></a>srvFRSi[<span class="dv">7</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(srvFRSi[<span class="dv">7</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb94-27"><a href="#cb94-27" aria-hidden="true" tabindex="-1"></a>srvFRSi[<span class="dv">8</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(srvFRSi[<span class="dv">8</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb94-28"><a href="#cb94-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-29"><a href="#cb94-29" aria-hidden="true" tabindex="-1"></a>smResultspgls <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(sPredictor,</span>
<span id="cb94-30"><a href="#cb94-30" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;VIS&quot;</span> <span class="ot">=</span> srvVISi,</span>
<span id="cb94-31"><a href="#cb94-31" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;NIR&quot;</span> <span class="ot">=</span> srvNIRi,</span>
<span id="cb94-32"><a href="#cb94-32" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;Res&quot;</span> <span class="ot">=</span> srvFRSi) </span>
<span id="cb94-33"><a href="#cb94-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-34"><a href="#cb94-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-35"><a href="#cb94-35" aria-hidden="true" tabindex="-1"></a>smResultspgls <span class="sc">%&gt;%</span> </span>
<span id="cb94-36"><a href="#cb94-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">align =</span><span class="st">&quot;c&quot;</span>, <span class="at">escape =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb94-37"><a href="#cb94-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb94-38"><a href="#cb94-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_indent</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>)) </span></code></pre></div>
<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
sPredictor
</th>
<th style="text-align:center;">
VIS
</th>
<th style="text-align:center;">
NIR
</th>
<th style="text-align:center;">
Res
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;padding-left: 2em;" indentlevel="1">
PC
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    color: #D40481 !important;">-7.719 ;
-5.314</span>
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    color: #D40481 !important;">11.247 ;
14.851</span>
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    color: #D40481 !important;">10.884 ;
14.297</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
PC p-val
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    "> 0.000 ; 0.049</span>
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    "> 0.000 ; 0.007</span>
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    "> 0.000 ; 0.007</span>
</td>
</tr>
<tr>
<td style="text-align:center;padding-left: 2em;" indentlevel="1">
Size
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    color: #D40481 !important;">-3.260 ;
6.740</span>
</td>
<td style="text-align:center;">
-4.022 ; -0.915
</td>
<td style="text-align:center;">
-3.613 ; -0.691
</td>
</tr>
<tr>
<td style="text-align:center;">
Size p-val
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    "> 0.003 ; 0.092</span>
</td>
<td style="text-align:center;">
0.169 ; 0.755
</td>
<td style="text-align:center;">
0.206 ; 0.797
</td>
</tr>
<tr>
<td style="text-align:center;padding-left: 2em;" indentlevel="1">
VIS
</td>
<td style="text-align:center;">
NA ; NA
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    color: #D40481 !important;"> 1.090 ;
1.183</span>
</td>
<td style="text-align:center;">
NA ; NA
</td>
</tr>
<tr>
<td style="text-align:center;">
VIS p-val
</td>
<td style="text-align:center;">
NA ; NA
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    "> 0.000 ; 0.000</span>
</td>
<td style="text-align:center;">
NA ; NA
</td>
</tr>
<tr>
<td style="text-align:center;padding-left: 2em;" indentlevel="1">
PC:size
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    color: #D40481 !important;"> 2.210 ;
3.263</span>
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    color: #D40481 !important;">-5.614 ;
-4.222</span>
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    color: #D40481 !important;">-5.487 ;
-4.175</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
PC:size p-val
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    "> 0.000 ; 0.054</span>
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    "> 0.000 ; 0.008</span>
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    "> 0.000 ; 0.009</span>
</td>
</tr>
</tbody>
</table>
<p><br> <br></p>
</div>
</div>
</div>
<div id="pgls-assumptions" class="section level1">
<h1>PGLS Assumptions</h1>
<p>Residuals should be normally distributed and should not have any
extra patterns after fitting the model</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pglsmodTOT)</span></code></pre></div>
<p><img src="MacroEcol_6_ManuscriptStats_files/figure-html/unnamed-chunk-47-1.png" width="672" /></p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pglsmodVIS)</span></code></pre></div>
<p><img src="MacroEcol_6_ManuscriptStats_files/figure-html/unnamed-chunk-47-2.png" width="672" /></p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pglsmodNIR)</span></code></pre></div>
<p><img src="MacroEcol_6_ManuscriptStats_files/figure-html/unnamed-chunk-47-3.png" width="672" /></p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pglsmodRes)</span></code></pre></div>
<p><img src="MacroEcol_6_ManuscriptStats_files/figure-html/unnamed-chunk-47-4.png" width="672" /></p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pglsmodFRS)</span></code></pre></div>
<p><img src="MacroEcol_6_ManuscriptStats_files/figure-html/unnamed-chunk-47-5.png" width="672" /></p>
<p><br> <br></p>
</div>
<div id="interactions" class="section level1">
<h1>Interactions</h1>
<p>To understand the interaction terms we explored the relationships
between the PC value and the reflectance dividing the beetle species
into small and large.</p>
<p>Firstly, prepare data frames</p>
<div class="sourceCode" id="cb100"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>VISSmall<span class="ot">&lt;-</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>  SimpleVIS <span class="sc">%&gt;%</span> <span class="co"># visible reflectance</span></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(size<span class="sc">&lt;</span><span class="fl">2.2</span>) <span class="co"># Small beetles</span></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>VISLarge<span class="ot">&lt;-</span></span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>  SimpleVIS <span class="sc">%&gt;%</span> <span class="co"># visible reflectance</span></span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(size<span class="sc">&gt;</span><span class="fl">2.2</span>) <span class="co"># large beetles</span></span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a>ProbPol <span class="ot">&lt;-</span></span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a>  SimpleVIS <span class="sc">%&gt;%</span></span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>( <span class="co">#if we want to consider only polarized beetles</span></span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a>    phylogeny_name <span class="sc">!=</span> <span class="st">&quot;Paraschizognathus_ocularis&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb100-13"><a href="#cb100-13" aria-hidden="true" tabindex="-1"></a>    phylogeny_name <span class="sc">!=</span> <span class="st">&quot;Paraschizognathus_prasinus&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb100-14"><a href="#cb100-14" aria-hidden="true" tabindex="-1"></a>    phylogeny_name <span class="sc">!=</span> <span class="st">&quot;Paraschizognathus_olivaceous&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb100-15"><a href="#cb100-15" aria-hidden="true" tabindex="-1"></a>    phylogeny_name <span class="sc">!=</span> <span class="st">&quot;Anoplognathus_prasinus&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb100-16"><a href="#cb100-16" aria-hidden="true" tabindex="-1"></a>    phylogeny_name <span class="sc">!=</span> <span class="st">&quot;Xylonichus_sp&quot;</span>) <span class="co"># these all have white underlay</span></span>
<span id="cb100-17"><a href="#cb100-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-18"><a href="#cb100-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-19"><a href="#cb100-19" aria-hidden="true" tabindex="-1"></a>VISSmallp<span class="ot">&lt;-</span></span>
<span id="cb100-20"><a href="#cb100-20" aria-hidden="true" tabindex="-1"></a>  ProbPol <span class="sc">%&gt;%</span> </span>
<span id="cb100-21"><a href="#cb100-21" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(size<span class="sc">&lt;</span><span class="fl">2.2</span>) <span class="co"># small beetles</span></span>
<span id="cb100-22"><a href="#cb100-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-23"><a href="#cb100-23" aria-hidden="true" tabindex="-1"></a>VISLargep<span class="ot">&lt;-</span></span>
<span id="cb100-24"><a href="#cb100-24" aria-hidden="true" tabindex="-1"></a>  ProbPol <span class="sc">%&gt;%</span> </span>
<span id="cb100-25"><a href="#cb100-25" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(size<span class="sc">&gt;</span><span class="fl">2.2</span>) <span class="co"># large beetles</span></span>
<span id="cb100-26"><a href="#cb100-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-27"><a href="#cb100-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-28"><a href="#cb100-28" aria-hidden="true" tabindex="-1"></a>ResSmall<span class="ot">&lt;-</span></span>
<span id="cb100-29"><a href="#cb100-29" aria-hidden="true" tabindex="-1"></a>  SimpleRes <span class="sc">%&gt;%</span> <span class="co"># residuals between the relationship NIR~VIS</span></span>
<span id="cb100-30"><a href="#cb100-30" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(size<span class="sc">&lt;</span><span class="fl">2.5</span>) <span class="co"># small beetles</span></span>
<span id="cb100-31"><a href="#cb100-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-32"><a href="#cb100-32" aria-hidden="true" tabindex="-1"></a>ResLarge<span class="ot">&lt;-</span></span>
<span id="cb100-33"><a href="#cb100-33" aria-hidden="true" tabindex="-1"></a>  SimpleRes <span class="sc">%&gt;%</span> </span>
<span id="cb100-34"><a href="#cb100-34" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(size<span class="sc">&gt;</span><span class="fl">2.5</span>) <span class="co"># Large beetles</span></span></code></pre></div>
<p>Subsets for plots</p>
<div class="sourceCode" id="cb101"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>ToPlotInt <span class="ot">&lt;-</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>  Cons1 <span class="sc">%&gt;%</span></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>phylogeny_name) <span class="sc">%&gt;%</span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">&quot;spp&quot;</span> <span class="ot">=</span> <span class="fu">substr</span>(ind, <span class="dv">1</span>, <span class="dv">4</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(spp) <span class="sc">%&gt;%</span></span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(</span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">meanAll =</span> <span class="fu">mean</span>(R_ALL),</span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">meanVIS =</span> <span class="fu">mean</span>(R_VIS),</span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">meanNIR =</span> <span class="fu">mean</span>(R_NIR),</span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">meanRes =</span> <span class="fu">mean</span>(Res),</span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">meanPC1 =</span> <span class="fu">mean</span>(PC1),</span>
<span id="cb101-13"><a href="#cb101-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">meanPC2 =</span> <span class="fu">mean</span>(PC2),</span>
<span id="cb101-14"><a href="#cb101-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">meanSize =</span> <span class="fu">mean</span>(size),</span>
<span id="cb101-15"><a href="#cb101-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">sdAll =</span> <span class="fu">sd</span>(R_ALL),</span>
<span id="cb101-16"><a href="#cb101-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">sdVIS =</span> <span class="fu">sd</span>(R_VIS),</span>
<span id="cb101-17"><a href="#cb101-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">sdNIR =</span> <span class="fu">sd</span>(R_NIR),</span>
<span id="cb101-18"><a href="#cb101-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">sdRes =</span> <span class="fu">sd</span>(Res),</span>
<span id="cb101-19"><a href="#cb101-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">sdPC1 =</span> <span class="fu">sd</span>(PC1),</span>
<span id="cb101-20"><a href="#cb101-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">sdPC2 =</span> <span class="fu">sd</span>(PC2),</span>
<span id="cb101-21"><a href="#cb101-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">sdSize =</span> <span class="fu">sd</span>(size)</span>
<span id="cb101-22"><a href="#cb101-22" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb101-23"><a href="#cb101-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-24"><a href="#cb101-24" aria-hidden="true" tabindex="-1"></a>plotVisSmall <span class="ot">&lt;-</span> </span>
<span id="cb101-25"><a href="#cb101-25" aria-hidden="true" tabindex="-1"></a>  ToPlotInt <span class="sc">%&gt;%</span> </span>
<span id="cb101-26"><a href="#cb101-26" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(meanSize<span class="sc">&lt;</span><span class="fl">2.2</span>) <span class="sc">%&gt;%</span>  <span class="co"># Small beetles</span></span>
<span id="cb101-27"><a href="#cb101-27" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">10</span>,<span class="dv">13</span>,<span class="dv">15</span>)</span>
<span id="cb101-28"><a href="#cb101-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-29"><a href="#cb101-29" aria-hidden="true" tabindex="-1"></a>plotVisLarge <span class="ot">&lt;-</span> </span>
<span id="cb101-30"><a href="#cb101-30" aria-hidden="true" tabindex="-1"></a>  ToPlotInt <span class="sc">%&gt;%</span> </span>
<span id="cb101-31"><a href="#cb101-31" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(meanSize<span class="sc">&gt;</span><span class="fl">2.2</span>) <span class="sc">%&gt;%</span>  <span class="co"># Large beetles </span></span>
<span id="cb101-32"><a href="#cb101-32" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">10</span>,<span class="dv">13</span>,<span class="dv">15</span>)</span>
<span id="cb101-33"><a href="#cb101-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-34"><a href="#cb101-34" aria-hidden="true" tabindex="-1"></a>plotNirSmall <span class="ot">&lt;-</span></span>
<span id="cb101-35"><a href="#cb101-35" aria-hidden="true" tabindex="-1"></a>  ToPlotInt <span class="sc">%&gt;%</span> </span>
<span id="cb101-36"><a href="#cb101-36" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(meanSize<span class="sc">&lt;</span><span class="fl">2.5</span>) <span class="sc">%&gt;%</span>  <span class="co"># Small beetles</span></span>
<span id="cb101-37"><a href="#cb101-37" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">12</span>,<span class="dv">14</span>,<span class="dv">15</span>)</span>
<span id="cb101-38"><a href="#cb101-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-39"><a href="#cb101-39" aria-hidden="true" tabindex="-1"></a>plotNirLarge <span class="ot">&lt;-</span></span>
<span id="cb101-40"><a href="#cb101-40" aria-hidden="true" tabindex="-1"></a>  ToPlotInt <span class="sc">%&gt;%</span> </span>
<span id="cb101-41"><a href="#cb101-41" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(meanSize<span class="sc">&gt;</span><span class="fl">2.5</span>) <span class="sc">%&gt;%</span>  <span class="co"># Large beetles</span></span>
<span id="cb101-42"><a href="#cb101-42" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">12</span>,<span class="dv">14</span>,<span class="dv">15</span>)</span></code></pre></div>
<div id="preliminary" class="section level2">
<h2>Preliminary</h2>
<ol style="list-style-type: decimal">
<li>Relationship between vis reflectance and size.</li>
</ol>
<p>This relationship is intensified if the most reflective beetles are
removed. The species A. aures, A. parvulus and A. roseus.</p>
<div class="sourceCode" id="cb102"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>AllBeet <span class="ot">&lt;-</span> <span class="fu">lm</span>(VISDataSet<span class="sc">$</span>Reflectance <span class="sc">~</span> VISDataSet<span class="sc">$</span>size)</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(AllBeet)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = VISDataSet$Reflectance ~ VISDataSet$size)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -9.5682 -4.0620 -0.9952  2.7082 21.7555 
## 
## Coefficients:
##                 Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)        7.355      5.491   1.340    0.187
## VISDataSet$size    3.046      2.400   1.269    0.211
## 
## Residual standard error: 6.624 on 45 degrees of freedom
## Multiple R-squared:  0.03456,    Adjusted R-squared:  0.01311 
## F-statistic: 1.611 on 1 and 45 DF,  p-value: 0.2109</code></pre>
<div class="sourceCode" id="cb104"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>AA <span class="ot">&lt;-</span> <span class="co"># removing the most reflective beetles</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>  VISDataSet <span class="sc">%&gt;%</span> </span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(phylogeny_name <span class="sc">!=</span> <span class="st">&quot;Anoplognathus_aureus&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>                phylogeny_name <span class="sc">!=</span> <span class="st">&quot;Anoplognathus_parvulus&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>                phylogeny_name <span class="sc">!=</span> <span class="st">&quot;Anoplostethus_roseus&quot;</span>) </span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>SubsetBeet <span class="ot">&lt;-</span><span class="fu">lm</span>(AA<span class="sc">$</span>Reflectance <span class="sc">~</span> AA<span class="sc">$</span>size)</span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(SubsetBeet)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = AA$Reflectance ~ AA$size)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -8.544 -2.887 -1.127  2.887 14.077 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   -2.665      4.279  -0.623 0.536878    
## AA$size        6.944      1.845   3.763 0.000514 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.81 on 42 degrees of freedom
## Multiple R-squared:  0.2522, Adjusted R-squared:  0.2344 
## F-statistic: 14.16 on 1 and 42 DF,  p-value: 0.0005141</code></pre>
<p>If these species are removed, larger beetles reflect more visible
light.</p>
<ol start="2" style="list-style-type: decimal">
<li>PC1</li>
</ol>
<p>We divided the beetles into two groups large beetles &gt; 2.2 cm and
small beetles &lt; 2.2 cm.</p>
<p>** If I remove the non-polarized beetles, the pattern remains the
same.</p>
<div class="sourceCode" id="cb106"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(VISSmall<span class="sc">$</span>Reflectance <span class="sc">~</span> VISSmall<span class="sc">$</span>PC, </span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;PC1&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Reflectance&quot;</span>,  <span class="at">main=</span><span class="st">&quot;Small beetles (&lt;2.2cm)&quot;</span>)</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(VISLarge<span class="sc">$</span>Reflectance <span class="sc">~</span> VISLarge<span class="sc">$</span>PC,</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;PC1&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Reflectance&quot;</span>, <span class="at">main=</span><span class="st">&quot;Large beetles (&gt;2.2cm)&quot;</span>)</span></code></pre></div>
<p><img src="MacroEcol_6_ManuscriptStats_files/figure-html/unnamed-chunk-51-1.png" width="672" /></p>
<div class="sourceCode" id="cb107"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>dumModVs <span class="ot">&lt;-</span> <span class="fu">lm</span>(VISSmall<span class="sc">$</span>Reflectance <span class="sc">~</span> VISSmall<span class="sc">$</span>PC)</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dumModVs)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = VISSmall$Reflectance ~ VISSmall$PC)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -9.970 -5.482 -2.907  3.633 19.004 
## 
## Coefficients:
##             Estimate Std. Error t value  Pr(&gt;|t|)    
## (Intercept)   11.487      2.285   5.027 0.0000748 ***
## VISSmall$PC   -1.230      1.160  -1.060     0.302    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 8.075 on 19 degrees of freedom
## Multiple R-squared:  0.05588,    Adjusted R-squared:  0.006189 
## F-statistic: 1.125 on 1 and 19 DF,  p-value: 0.3022</code></pre>
<div class="sourceCode" id="cb109"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>dumModVl <span class="ot">&lt;-</span> <span class="fu">lm</span>(VISLarge<span class="sc">$</span>Reflectance <span class="sc">~</span> VISLarge<span class="sc">$</span>PC) </span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dumModVl)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = VISLarge$Reflectance ~ VISLarge$PC)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -10.1084  -3.2947  -0.6308   2.9120  14.8847 
## 
## Coefficients:
##             Estimate Std. Error t value          Pr(&gt;|t|)    
## (Intercept)  15.0848     1.0292  14.657 0.000000000000179 ***
## VISLarge$PC   0.7263     0.7674   0.946             0.353    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.226 on 24 degrees of freedom
## Multiple R-squared:  0.03598,    Adjusted R-squared:  -0.004191 
## F-statistic: 0.8957 on 1 and 24 DF,  p-value: 0.3534</code></pre>
<p>Here, there seems to be a negative relationship between the PC1 and
the reflectance for small beetles. But the slope does not seem to be
significant.</p>
<p>Plots for NIR light</p>
<p>We separated the beetles into two groups large beetles &gt; 2.5 cm
and small beetles &lt; 2.5 cm.</p>
<div class="sourceCode" id="cb111"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>((ResDataSet[ResDataSet<span class="sc">$</span>size<span class="sc">&lt;</span><span class="fl">2.5</span>,])<span class="sc">$</span>PC2,</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>     (ResDataSet[ResDataSet<span class="sc">$</span>size<span class="sc">&lt;</span><span class="fl">2.5</span>,])<span class="sc">$</span>Reflectance,</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">&quot;Reflectance&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;PC2&quot;</span>, <span class="at">main=</span><span class="st">&quot;Small beetles (&lt;2.5cm)&quot;</span>)</span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>((ResDataSet[ResDataSet<span class="sc">$</span>size<span class="sc">&gt;</span><span class="fl">2.5</span>,])<span class="sc">$</span>PC2,</span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a>     (ResDataSet[ResDataSet<span class="sc">$</span>size<span class="sc">&gt;</span><span class="fl">2.5</span>,])<span class="sc">$</span>Reflectance,</span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">&quot;Reflectance&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;PC2&quot;</span>, <span class="at">main=</span><span class="st">&quot;Large beetles (&gt;2.5cm)&quot;</span>)</span></code></pre></div>
<p><img src="MacroEcol_6_ManuscriptStats_files/figure-html/unnamed-chunk-52-1.png" width="672" /></p>
<div class="sourceCode" id="cb112"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>dumModNb <span class="ot">&lt;-</span> <span class="fu">lm</span>(ResDataSet<span class="sc">$</span>Reflectance <span class="sc">~</span> ResDataSet<span class="sc">$</span>PC2) <span class="co"># All together</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dumModNb)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = ResDataSet$Reflectance ~ ResDataSet$PC2)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -13.3459  -4.2771  -0.0932   4.1056  28.3801 
## 
## Coefficients:
##                Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)     -1.4520     1.1036  -1.316    0.195
## ResDataSet$PC2   1.0044     0.7286   1.378    0.175
## 
## Residual standard error: 7.52 on 45 degrees of freedom
## Multiple R-squared:  0.04052,    Adjusted R-squared:  0.01919 
## F-statistic:   1.9 on 1 and 45 DF,  p-value: 0.1749</code></pre>
<div class="sourceCode" id="cb114"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>dumModNs <span class="ot">&lt;-</span> <span class="fu">lm</span>(ResSmall<span class="sc">$</span>Reflectance <span class="sc">~</span> ResSmall<span class="sc">$</span>PC) <span class="co"># size &lt; 2.5</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dumModNs)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = ResSmall$Reflectance ~ ResSmall$PC)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -15.7008  -4.1481  -0.1156   3.7125  26.4345 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)   -1.969      1.363  -1.445   0.1582  
## ResSmall$PC    3.071      1.161   2.646   0.0125 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 7.86 on 32 degrees of freedom
## Multiple R-squared:  0.1795, Adjusted R-squared:  0.1539 
## F-statistic: 7.002 on 1 and 32 DF,  p-value: 0.01252</code></pre>
<div class="sourceCode" id="cb116"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>dumModNl <span class="ot">&lt;-</span> <span class="fu">lm</span>(ResLarge<span class="sc">$</span>Reflectance <span class="sc">~</span> ResLarge<span class="sc">$</span>PC) <span class="co"># size &gt; 2.5</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dumModNl)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = ResLarge$Reflectance ~ ResLarge$PC)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -7.5858 -1.8395  0.1237  2.9330  6.5657 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)  -3.0062     1.3603  -2.210   0.0492 *
## ResLarge$PC  -0.8831     0.6281  -1.406   0.1873  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.289 on 11 degrees of freedom
## Multiple R-squared:  0.1523, Adjusted R-squared:  0.07527 
## F-statistic: 1.977 on 1 and 11 DF,  p-value: 0.1873</code></pre>
<p>There is a positive correlation between PC2 and NIR (residuals
NIR~VIS) but this is only valid for small beetles. For small beetles,
the NIR reflectance is greater in fresh environments. This is opposite
to the original hypothesis in which we expected more NIR in more arid
and hot environments.</p>
<p><br></p>
</div>
<div id="predictions" class="section level2">
<h2>Predictions</h2>
<p>We calculated the expected values of visible and NIR reflectance for
the two groups of beetles, small and large based on the large full
model.</p>
<p>Fos the visible reflectance we only graphed the PC1 since PC2 did not
have a signifficant effect in reflectance. For NIR reflectance we
graphed only PC2.</p>
<div class="sourceCode" id="cb118"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Small beetles VIS</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a><span class="do">## set values for predictors: </span></span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>SVPC1 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">range</span>(plotVisSmall<span class="sc">$</span>meanPC1)[<span class="dv">1</span>],</span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>             <span class="fu">range</span>(plotVisSmall<span class="sc">$</span>meanPC1)[<span class="dv">2</span>],<span class="fl">0.01</span>) <span class="co"># A range of PC1 values</span></span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a>SVPC2 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">mean</span>(VISDataSet<span class="sc">$</span>PC2),<span class="fu">length</span>(SVPC1)) <span class="co"># The mean PC2 for all beetles </span></span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a>SVsize <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">mean</span>(plotVisSmall<span class="sc">$</span>meanSize),</span>
<span id="cb118-10"><a href="#cb118-10" aria-hidden="true" tabindex="-1"></a>              <span class="fu">length</span>(SVPC1)) <span class="co"># mean size of the small beetles</span></span>
<span id="cb118-11"><a href="#cb118-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-12"><a href="#cb118-12" aria-hidden="true" tabindex="-1"></a>new1<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="st">&quot;PC1&quot;</span> <span class="ot">=</span> SVPC1, <span class="st">&quot;PC2&quot;</span> <span class="ot">=</span> SVPC2, <span class="st">&quot;size&quot;</span> <span class="ot">=</span> SVsize) <span class="co"># data frame</span></span>
<span id="cb118-13"><a href="#cb118-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-14"><a href="#cb118-14" aria-hidden="true" tabindex="-1"></a>ref1<span class="ot">&lt;-</span><span class="fu">predict</span>(pglsmodVIS, <span class="at">newdata =</span> new1, </span>
<span id="cb118-15"><a href="#cb118-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">type =</span> <span class="st">&quot;response&quot;</span>) <span class="co"># Expected reflectance</span></span>
<span id="cb118-16"><a href="#cb118-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-17"><a href="#cb118-17" aria-hidden="true" tabindex="-1"></a>trend1<span class="ot">&lt;-</span><span class="fu">data.frame</span>(ref1,SVPC1) <span class="co"># PC1 values and expected reflectance joint</span></span>
<span id="cb118-18"><a href="#cb118-18" aria-hidden="true" tabindex="-1"></a>trend1<span class="sc">$</span>invSVPC1<span class="ot">&lt;-</span> trend1<span class="sc">$</span>SVPC1<span class="sc">*-</span><span class="dv">1</span></span>
<span id="cb118-19"><a href="#cb118-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-20"><a href="#cb118-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Large beetles VIS</span></span>
<span id="cb118-21"><a href="#cb118-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-22"><a href="#cb118-22" aria-hidden="true" tabindex="-1"></a>LVPC1 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">range</span>(plotVisLarge<span class="sc">$</span>meanPC1)[<span class="dv">1</span>],</span>
<span id="cb118-23"><a href="#cb118-23" aria-hidden="true" tabindex="-1"></a>             <span class="fu">range</span>(plotVisLarge<span class="sc">$</span>meanPC1)[<span class="dv">2</span>],<span class="fl">0.01</span>) <span class="co"># A range of PC1 values</span></span>
<span id="cb118-24"><a href="#cb118-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-25"><a href="#cb118-25" aria-hidden="true" tabindex="-1"></a>LVPC2 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">mean</span>(VISDataSet<span class="sc">$</span>PC2),<span class="fu">length</span>(LVPC1)) <span class="co"># The mean PC2 for all beetles</span></span>
<span id="cb118-26"><a href="#cb118-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-27"><a href="#cb118-27" aria-hidden="true" tabindex="-1"></a>LVsize <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">mean</span>(plotVisLarge<span class="sc">$</span>meanSize),</span>
<span id="cb118-28"><a href="#cb118-28" aria-hidden="true" tabindex="-1"></a>              <span class="fu">length</span>(LVPC1)) <span class="co"># mean size of the large beetles</span></span>
<span id="cb118-29"><a href="#cb118-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-30"><a href="#cb118-30" aria-hidden="true" tabindex="-1"></a>new2<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="st">&quot;PC1&quot;</span> <span class="ot">=</span> LVPC1, <span class="st">&quot;PC2&quot;</span> <span class="ot">=</span> LVPC2, <span class="st">&quot;size&quot;</span> <span class="ot">=</span> LVsize) <span class="co"># data frame </span></span>
<span id="cb118-31"><a href="#cb118-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-32"><a href="#cb118-32" aria-hidden="true" tabindex="-1"></a>ref2<span class="ot">&lt;-</span><span class="fu">predict</span>(pglsmodVIS, <span class="at">newdata =</span> new2, </span>
<span id="cb118-33"><a href="#cb118-33" aria-hidden="true" tabindex="-1"></a>              <span class="at">type =</span> <span class="st">&quot;response&quot;</span>) <span class="co"># Expected reflectance</span></span>
<span id="cb118-34"><a href="#cb118-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-35"><a href="#cb118-35" aria-hidden="true" tabindex="-1"></a>trend2<span class="ot">&lt;-</span><span class="fu">data.frame</span>(ref2,LVPC1) <span class="co"># PC1 values and expected reflectance joint</span></span>
<span id="cb118-36"><a href="#cb118-36" aria-hidden="true" tabindex="-1"></a>trend2<span class="sc">$</span>invLVPC1 <span class="ot">&lt;-</span> trend2<span class="sc">$</span>LVPC1<span class="sc">*-</span><span class="dv">1</span></span>
<span id="cb118-37"><a href="#cb118-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-38"><a href="#cb118-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-39"><a href="#cb118-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Small beetles NIR</span></span>
<span id="cb118-40"><a href="#cb118-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-41"><a href="#cb118-41" aria-hidden="true" tabindex="-1"></a>SNPC2 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">range</span>(plotNirSmall<span class="sc">$</span>meanPC2)[<span class="dv">1</span>],</span>
<span id="cb118-42"><a href="#cb118-42" aria-hidden="true" tabindex="-1"></a>             <span class="fu">range</span>(plotNirSmall<span class="sc">$</span>meanPC2)[<span class="dv">2</span>],<span class="fl">0.01</span>) <span class="co"># A range of PC2 values</span></span>
<span id="cb118-43"><a href="#cb118-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-44"><a href="#cb118-44" aria-hidden="true" tabindex="-1"></a>SNPC1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">mean</span>(ResDataSet<span class="sc">$</span>PC1),<span class="fu">length</span>(SNPC2)) <span class="co"># The mean PC1 for all beetles</span></span>
<span id="cb118-45"><a href="#cb118-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-46"><a href="#cb118-46" aria-hidden="true" tabindex="-1"></a>SNsize <span class="ot">&lt;-</span> <span class="fu">rep</span>((<span class="fu">mean</span>(plotNirSmall<span class="sc">$</span>meanSize)<span class="co"># mean size of the small beetles</span></span>
<span id="cb118-47"><a href="#cb118-47" aria-hidden="true" tabindex="-1"></a>               <span class="sc">-</span><span class="fl">0.2</span>), <span class="co"># adjusted for visualization purposes</span></span>
<span id="cb118-48"><a href="#cb118-48" aria-hidden="true" tabindex="-1"></a>              <span class="fu">length</span>(SNPC2)) </span>
<span id="cb118-49"><a href="#cb118-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-50"><a href="#cb118-50" aria-hidden="true" tabindex="-1"></a>new3<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="st">&quot;PC1&quot;</span> <span class="ot">=</span> SNPC1, <span class="st">&quot;PC2&quot;</span> <span class="ot">=</span> SNPC2, <span class="st">&quot;size&quot;</span> <span class="ot">=</span> SNsize) <span class="co"># data frame </span></span>
<span id="cb118-51"><a href="#cb118-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-52"><a href="#cb118-52" aria-hidden="true" tabindex="-1"></a>ref3<span class="ot">&lt;-</span><span class="fu">predict</span>(pglsmodRes, <span class="at">newdata =</span> new3, </span>
<span id="cb118-53"><a href="#cb118-53" aria-hidden="true" tabindex="-1"></a>              <span class="at">type =</span> <span class="st">&quot;response&quot;</span>) <span class="co"># Expected reflectance</span></span>
<span id="cb118-54"><a href="#cb118-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-55"><a href="#cb118-55" aria-hidden="true" tabindex="-1"></a>trend3 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(ref3,SNPC2)</span>
<span id="cb118-56"><a href="#cb118-56" aria-hidden="true" tabindex="-1"></a>trend3<span class="sc">$</span>invSNPC2 <span class="ot">&lt;-</span> trend3<span class="sc">$</span>SNPC2<span class="sc">*-</span><span class="dv">1</span></span>
<span id="cb118-57"><a href="#cb118-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-58"><a href="#cb118-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-59"><a href="#cb118-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-60"><a href="#cb118-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Large beetles NIR</span></span>
<span id="cb118-61"><a href="#cb118-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-62"><a href="#cb118-62" aria-hidden="true" tabindex="-1"></a>LNPC2 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">range</span>(plotNirLarge<span class="sc">$</span>meanPC2)[<span class="dv">1</span>],</span>
<span id="cb118-63"><a href="#cb118-63" aria-hidden="true" tabindex="-1"></a>             <span class="fu">range</span>(plotNirLarge<span class="sc">$</span>meanPC2)[<span class="dv">2</span>],<span class="fl">0.01</span>) <span class="co"># A range of PC1 values</span></span>
<span id="cb118-64"><a href="#cb118-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-65"><a href="#cb118-65" aria-hidden="true" tabindex="-1"></a>LNPC1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">mean</span>(ResDataSet<span class="sc">$</span>PC1),<span class="fu">length</span>(LNPC2)) <span class="co"># The mean PC2 for all beetles</span></span>
<span id="cb118-66"><a href="#cb118-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-67"><a href="#cb118-67" aria-hidden="true" tabindex="-1"></a>LNsize <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">mean</span>(plotNirLarge<span class="sc">$</span>meanSize),</span>
<span id="cb118-68"><a href="#cb118-68" aria-hidden="true" tabindex="-1"></a>              <span class="fu">length</span>(LNPC2)) <span class="co"># mean size of the large beetles</span></span>
<span id="cb118-69"><a href="#cb118-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-70"><a href="#cb118-70" aria-hidden="true" tabindex="-1"></a>new4<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="st">&quot;PC1&quot;</span> <span class="ot">=</span> LNPC1, <span class="st">&quot;PC2&quot;</span> <span class="ot">=</span> LNPC2, <span class="st">&quot;size&quot;</span> <span class="ot">=</span> LNsize) <span class="co"># data frame </span></span>
<span id="cb118-71"><a href="#cb118-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-72"><a href="#cb118-72" aria-hidden="true" tabindex="-1"></a>ref4<span class="ot">&lt;-</span><span class="fu">predict</span>(pglsmodRes, <span class="at">newdata =</span> new4, </span>
<span id="cb118-73"><a href="#cb118-73" aria-hidden="true" tabindex="-1"></a>              <span class="at">type =</span> <span class="st">&quot;response&quot;</span>) <span class="co"># Expected reflectance</span></span>
<span id="cb118-74"><a href="#cb118-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-75"><a href="#cb118-75" aria-hidden="true" tabindex="-1"></a>trend4 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(ref4,LNPC2)</span>
<span id="cb118-76"><a href="#cb118-76" aria-hidden="true" tabindex="-1"></a>trend4<span class="sc">$</span>invLNPC2 <span class="ot">&lt;-</span> trend4<span class="sc">$</span>LNPC2<span class="sc">*-</span><span class="dv">1</span></span></code></pre></div>
</div>
<div id="figures" class="section level2">
<h2>Figures</h2>
<p>Plots</p>
<p>PC axis were inverted here so that they are easy to interpret</p>
<div class="sourceCode" id="cb119"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>PVS <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plotVisSmall, <span class="fu">aes</span>(<span class="at">x =</span> <span class="sc">-</span>meanPC1, <span class="at">y =</span> meanVIS)) <span class="sc">+</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymin =</span> meanVIS <span class="sc">-</span> sdVIS,</span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymax =</span> meanVIS <span class="sc">+</span> sdVIS</span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;#cecec2&quot;</span></span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(</span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmin =</span> <span class="sc">-</span>meanPC1 <span class="sc">-</span> sdPC1,</span>
<span id="cb119-10"><a href="#cb119-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmax =</span> <span class="sc">-</span>meanPC1 <span class="sc">+</span> sdPC1</span>
<span id="cb119-11"><a href="#cb119-11" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb119-12"><a href="#cb119-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;#cecec2&quot;</span></span>
<span id="cb119-13"><a href="#cb119-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb119-14"><a href="#cb119-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb119-15"><a href="#cb119-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">2</span>, <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&quot;#648fff&quot;</span>,</span>
<span id="cb119-16"><a href="#cb119-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.9</span></span>
<span id="cb119-17"><a href="#cb119-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb119-18"><a href="#cb119-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">40</span>)<span class="sc">+</span></span>
<span id="cb119-19"><a href="#cb119-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="fl">2.8</span>,<span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb119-20"><a href="#cb119-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb119-21"><a href="#cb119-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)<span class="sc">+</span></span>
<span id="cb119-22"><a href="#cb119-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span> invSVPC1, <span class="at">y=</span> ref1), <span class="at">data=</span>trend1)<span class="sc">+</span></span>
<span id="cb119-23"><a href="#cb119-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Humidity (-PC1)&quot;</span>) <span class="sc">+</span></span>
<span id="cb119-24"><a href="#cb119-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span> (<span class="st">&quot;VIS reflectivity (%)&quot;</span>)</span>
<span id="cb119-25"><a href="#cb119-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-26"><a href="#cb119-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-27"><a href="#cb119-27" aria-hidden="true" tabindex="-1"></a>PVL <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plotVisLarge, <span class="fu">aes</span>(<span class="at">x =</span> <span class="sc">-</span>meanPC1, <span class="at">y =</span> meanVIS)) <span class="sc">+</span></span>
<span id="cb119-28"><a href="#cb119-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(</span>
<span id="cb119-29"><a href="#cb119-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymin =</span> meanVIS <span class="sc">-</span> sdVIS,</span>
<span id="cb119-30"><a href="#cb119-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymax =</span> meanVIS <span class="sc">+</span> sdVIS</span>
<span id="cb119-31"><a href="#cb119-31" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb119-32"><a href="#cb119-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;#cecec2&quot;</span></span>
<span id="cb119-33"><a href="#cb119-33" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb119-34"><a href="#cb119-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(</span>
<span id="cb119-35"><a href="#cb119-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmin =</span> <span class="sc">-</span>meanPC1 <span class="sc">-</span> sdPC1,</span>
<span id="cb119-36"><a href="#cb119-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmax =</span> <span class="sc">-</span>meanPC1 <span class="sc">+</span> sdPC1</span>
<span id="cb119-37"><a href="#cb119-37" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb119-38"><a href="#cb119-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;#cecec2&quot;</span></span>
<span id="cb119-39"><a href="#cb119-39" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb119-40"><a href="#cb119-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb119-41"><a href="#cb119-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">2</span>, <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&quot;#ff7200&quot;</span>,</span>
<span id="cb119-42"><a href="#cb119-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.9</span></span>
<span id="cb119-43"><a href="#cb119-43" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb119-44"><a href="#cb119-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">40</span>)<span class="sc">+</span></span>
<span id="cb119-45"><a href="#cb119-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="fl">2.8</span>,<span class="dv">4</span>)<span class="sc">+</span></span>
<span id="cb119-46"><a href="#cb119-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb119-47"><a href="#cb119-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)<span class="sc">+</span></span>
<span id="cb119-48"><a href="#cb119-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span> invLVPC1, <span class="at">y=</span> ref2), <span class="at">data=</span>trend2) <span class="sc">+</span></span>
<span id="cb119-49"><a href="#cb119-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Humidity (-PC1)&quot;</span>) <span class="sc">+</span></span>
<span id="cb119-50"><a href="#cb119-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span> (<span class="st">&quot;VIS reflectivity (%)&quot;</span>)</span>
<span id="cb119-51"><a href="#cb119-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-52"><a href="#cb119-52" aria-hidden="true" tabindex="-1"></a>PNS <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plotNirSmall, <span class="fu">aes</span>(<span class="at">x =</span> <span class="sc">-</span>meanPC2, <span class="at">y =</span> meanRes)) <span class="sc">+</span></span>
<span id="cb119-53"><a href="#cb119-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(</span>
<span id="cb119-54"><a href="#cb119-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymin =</span> meanRes <span class="sc">-</span> sdRes,</span>
<span id="cb119-55"><a href="#cb119-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymax =</span> meanRes <span class="sc">+</span> sdRes</span>
<span id="cb119-56"><a href="#cb119-56" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb119-57"><a href="#cb119-57" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;#cecec2&quot;</span></span>
<span id="cb119-58"><a href="#cb119-58" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb119-59"><a href="#cb119-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(</span>
<span id="cb119-60"><a href="#cb119-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmin =</span> <span class="sc">-</span>meanPC2 <span class="sc">-</span> sdPC2,</span>
<span id="cb119-61"><a href="#cb119-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmax =</span> <span class="sc">-</span>meanPC2 <span class="sc">+</span> sdPC2</span>
<span id="cb119-62"><a href="#cb119-62" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb119-63"><a href="#cb119-63" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;#cecec2&quot;</span></span>
<span id="cb119-64"><a href="#cb119-64" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb119-65"><a href="#cb119-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb119-66"><a href="#cb119-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">2</span>, <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&quot;#ff2c85&quot;</span>,</span>
<span id="cb119-67"><a href="#cb119-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.9</span></span>
<span id="cb119-68"><a href="#cb119-68" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb119-69"><a href="#cb119-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">20</span>,<span class="dv">40</span>)<span class="sc">+</span></span>
<span id="cb119-70"><a href="#cb119-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">4</span>,<span class="dv">4</span>)<span class="sc">+</span></span>
<span id="cb119-71"><a href="#cb119-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb119-72"><a href="#cb119-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)<span class="sc">+</span></span>
<span id="cb119-73"><a href="#cb119-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span> invSNPC2, <span class="at">y=</span> ref3), <span class="at">data=</span>trend3)  <span class="sc">+</span></span>
<span id="cb119-74"><a href="#cb119-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Aridity &amp; Radiation (-PC2)&quot;</span>) <span class="sc">+</span></span>
<span id="cb119-75"><a href="#cb119-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span> (<span class="st">&quot;NIR (res) reflectivity (%)&quot;</span>)</span>
<span id="cb119-76"><a href="#cb119-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-77"><a href="#cb119-77" aria-hidden="true" tabindex="-1"></a>PNL <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plotNirLarge, <span class="fu">aes</span>(<span class="at">x =</span> <span class="sc">-</span>meanPC2, <span class="at">y =</span> meanRes)) <span class="sc">+</span></span>
<span id="cb119-78"><a href="#cb119-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(</span>
<span id="cb119-79"><a href="#cb119-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymin =</span> meanRes <span class="sc">-</span> sdRes,</span>
<span id="cb119-80"><a href="#cb119-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymax =</span> meanRes <span class="sc">+</span> sdRes</span>
<span id="cb119-81"><a href="#cb119-81" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb119-82"><a href="#cb119-82" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;#cecec2&quot;</span></span>
<span id="cb119-83"><a href="#cb119-83" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb119-84"><a href="#cb119-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(</span>
<span id="cb119-85"><a href="#cb119-85" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmin =</span> <span class="sc">-</span>meanPC2 <span class="sc">-</span> sdPC2,</span>
<span id="cb119-86"><a href="#cb119-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmax =</span> <span class="sc">-</span>meanPC2 <span class="sc">+</span> sdPC2</span>
<span id="cb119-87"><a href="#cb119-87" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb119-88"><a href="#cb119-88" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;#cecec2&quot;</span></span>
<span id="cb119-89"><a href="#cb119-89" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb119-90"><a href="#cb119-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb119-91"><a href="#cb119-91" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">2</span>, <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&quot;#ffb000&quot;</span>,</span>
<span id="cb119-92"><a href="#cb119-92" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.9</span></span>
<span id="cb119-93"><a href="#cb119-93" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb119-94"><a href="#cb119-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">20</span>,<span class="dv">40</span>)<span class="sc">+</span></span>
<span id="cb119-95"><a href="#cb119-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="fl">2.8</span>,<span class="dv">6</span>)<span class="sc">+</span></span>
<span id="cb119-96"><a href="#cb119-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb119-97"><a href="#cb119-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)<span class="sc">+</span></span>
<span id="cb119-98"><a href="#cb119-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span> invLNPC2, <span class="at">y=</span> ref4), <span class="at">data=</span>trend4)  <span class="sc">+</span></span>
<span id="cb119-99"><a href="#cb119-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Aridity &amp; Radiation (-PC2)&quot;</span>)  <span class="sc">+</span></span>
<span id="cb119-100"><a href="#cb119-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span> (<span class="st">&quot;NIR (res) reflectivity (%)&quot;</span>)</span>
<span id="cb119-101"><a href="#cb119-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-102"><a href="#cb119-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-103"><a href="#cb119-103" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(PVS, PVL, PNS, PNL, <span class="at">nrow =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="MacroEcol_6_ManuscriptStats_files/figure-html/unnamed-chunk-55-1.png" width="672" /></p>
</div>
</div>
<div id="conclusions" class="section level1">
<h1>Conclusions</h1>
<p><br> For Visible reflectivity the interaction between Size and PC1
was signifficant. Lower PC1 = higher humidity (vapour, rain and clouds)
lower aridity. Smaller beetles reflect more visible light in humid
environments</p>
<p><br> For NIR reflectivity the interaction between Size and PC2 was
signifficant. Lower PC2 = higher solar radiation, higher max temp, more
days above 35 and more aridity Smaller beetles reflect less NIR light in
hot/arid environments.</p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4,h5",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
