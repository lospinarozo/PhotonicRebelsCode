<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Reflectivity PGLS</title>

<script src="site_libs/header-attrs-2.14/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #ffffff;
    color: #a0a0a0;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
div.sourceCode
  { color: #1f1c1b; background-color: #ffffff; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #1f1c1b; } /* Normal */
code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
code span.an { color: #ca60ca; } /* Annotation */
code span.at { color: #0057ae; } /* Attribute */
code span.bn { color: #b08000; } /* BaseN */
code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
code span.ch { color: #924c9d; } /* Char */
code span.cn { color: #aa5500; } /* Constant */
code span.co { color: #898887; } /* Comment */
code span.cv { color: #0095ff; } /* CommentVar */
code span.do { color: #607880; } /* Documentation */
code span.dt { color: #0057ae; } /* DataType */
code span.dv { color: #b08000; } /* DecVal */
code span.er { color: #bf0303; text-decoration: underline; } /* Error */
code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
code span.fl { color: #b08000; } /* Float */
code span.fu { color: #644a9b; } /* Function */
code span.im { color: #ff5500; } /* Import */
code span.in { color: #b08000; } /* Information */
code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
code span.op { color: #1f1c1b; } /* Operator */
code span.ot { color: #006e28; } /* Other */
code span.pp { color: #006e28; } /* Preprocessor */
code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
code span.sc { color: #3daee9; } /* SpecialChar */
code span.ss { color: #ff5500; } /* SpecialString */
code span.st { color: #bf0303; } /* String */
code span.va { color: #0057ae; } /* Variable */
code span.vs { color: #bf0303; } /* VerbatimString */
code span.wa { color: #bf0303; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Shady Xmas Beetles</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="MacroEcol_1_SettingUp.html">Setting up</a>
</li>
<li>
  <a href="MacroEcol_2_OpticalProperties.html">Optical properties</a>
</li>
<li>
  <a href="MacroEcol_3_EcologicalVariables.html">Ecological variables</a>
</li>
<li>
  <a href="MacroEcol_5_Polarization.html">Polarisation</a>
</li>
<li>
  <a href="MacroEcol_5_Polarization2.html">Polarisation PGLS</a>
</li>
<li>
  <a href="MacroEcol_6_ManuscriptStats.html">Reflectivity PGLS</a>
</li>
<li>
  <a href="MacroEcol_7_ManuscriptFigures.html">Figures</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Reflectivity PGLS</h1>

</div>


<div id="libraries" class="section level1">
<h1>Libraries</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;./MacroEcol_1_Libraries.R&quot;</span>)</span></code></pre></div>
</div>
<div id="data-sets" class="section level1">
<h1>Data Sets</h1>
<p>Reflectivity by Individual</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>Cons1 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;../Data/FromCode/ConsReflEcolInd.csv&quot;</span>)[<span class="sc">-</span><span class="dv">1</span>]</span></code></pre></div>
<p>Absorptivity by Individual</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>Cons2 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;../Data/FromCode/ConsAbsEcolInd.csv&quot;</span>)[<span class="sc">-</span><span class="dv">1</span>]</span></code></pre></div>
<p>Phylogeny (multiple trees)</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>trees <span class="ot">&lt;-</span> ape<span class="sc">::</span><span class="fu">read.tree</span>(<span class="st">&quot;../Data/XMAS_mat2b_bst2ef_set23nn2_pinct.nwk&quot;</span>)</span></code></pre></div>
<div id="aggregate" class="section level2">
<h2>Aggregate</h2>
<p>Sumarise all variables in the data frame to get one value per
species.</p>
<p>In this analysis we will consider interspecific instead of
intraspecific variability.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>Cons1agg <span class="ot">&lt;-</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  Cons1 <span class="sc">%&gt;%</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span> (<span class="sc">-</span>ind) <span class="sc">%&gt;%</span><span class="co"># remove individual id</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span> (phylogeny_name, <span class="fu">everything</span> ()) <span class="sc">%&gt;%</span> <span class="co"># order columns</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span> (phylogeny_name) <span class="sc">%&gt;%</span>  <span class="co"># group</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span> (<span class="fu">across</span>(<span class="fu">everything</span>(), <span class="fu">list</span>(mean))) <span class="co"># mean</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Modify to make it compatible with tree tips</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>ConsAgg <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(Cons1agg) <span class="co"># convert to a data frame</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(ConsAgg) <span class="ot">&lt;-</span> ConsAgg[, <span class="dv">1</span>] <span class="co"># make species the row names </span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>ConsAgg <span class="ot">&lt;-</span> ConsAgg [,<span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(ConsAgg)] <span class="co"># eliminate spp name (redundant)</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Separate the data frames </span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Useful for plotting in the tree</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(ConsAgg) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;TOT&quot;</span>, <span class="st">&quot;VIS&quot;</span>, <span class="st">&quot;NIR&quot;</span>, <span class="st">&quot;Res&quot;</span>,</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;PC1&quot;</span>, <span class="st">&quot;PC2&quot;</span>, <span class="st">&quot;Size&quot;</span> )</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>TOTdf <span class="ot">&lt;-</span> ConsAgg <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span> (TOT) </span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>VISdf <span class="ot">&lt;-</span> ConsAgg <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span> (VIS) </span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>NIRdf <span class="ot">&lt;-</span> ConsAgg <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span> (NIR) </span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>Resdf <span class="ot">&lt;-</span> ConsAgg <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span> (Res) </span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>PC1df <span class="ot">&lt;-</span> ConsAgg <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span> (PC1) </span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>PC2df <span class="ot">&lt;-</span> ConsAgg <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span> (PC2) </span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>Sizdf <span class="ot">&lt;-</span> ConsAgg <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span> (Size) </span></code></pre></div>
</div>
<div id="match" class="section level2">
<h2>Match</h2>
<p>Make sure that the phylogeny names are consistent in the data frame
and the phylogenetic trees</p>
<p>Read and prune the MCC tree</p>
<p>The MCC (Maximum clade credibility) tree used here is the BEAST MCC
tree.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># read the tree</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>MCCtree.raw <span class="ot">&lt;-</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  ape<span class="sc">::</span><span class="fu">read.nexus</span>(<span class="st">&quot;../Data/xmas_mat2b_bst2ef_set23nn2_pinct_med.tre&quot;</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Prune extra spp in the tree, not contain in the test sample</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>species.MCC <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">unique</span>(Cons1<span class="sc">$</span>phylogeny_name))</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to &quot;row names&quot; (required for following steps)</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(species.MCC) <span class="ot">&lt;-</span> species.MCC[, <span class="dv">1</span>] </span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Make sure the names in data set and tree match</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>temp.MCC <span class="ot">&lt;-</span> <span class="fu">name.check</span>(MCCtree.raw, species.MCC) </span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>temp.MCC </span></code></pre></div>
<pre><code>## [1] &quot;OK&quot;</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This step would be neccesary if the tips had been different.</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co"># MCCtree &lt;- drop.tip(MCCtree.raw, temp.MCC$tree_not_data)</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Not used in our case.</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Instead, changed the name</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>MCCtree <span class="ot">&lt;-</span> MCCtree.raw</span></code></pre></div>
<p>Make sure names between data and tree tips match</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>Cons1agg <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(Cons1agg)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(Cons1agg) <span class="ot">&lt;-</span> Cons1agg [, <span class="dv">1</span>] </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Cons1agg) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;phylogeny_name&quot;</span>, <span class="st">&quot;TOT&quot;</span>, <span class="st">&quot;VIS&quot;</span>, <span class="st">&quot;NIR&quot;</span>,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;Res&quot;</span>,<span class="st">&quot;size&quot;</span>, <span class="st">&quot;PC1&quot;</span>, <span class="st">&quot;PC2&quot;</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Test if the species are the same</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="fu">identical</span>(</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">length</span>(<span class="fu">name.check</span>(MCCtree, Cons1agg<span class="sc">$</span>phylogeny_name)<span class="sc">$</span>tree_not_data),</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">length</span>(Cons1agg<span class="sc">$</span>phylogeny_name)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="subset" class="section level2">
<h2>Subset</h2>
<p>Create subsets for each waveband</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>ALLDataSet <span class="ot">&lt;-</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  Cons1agg <span class="sc">%&gt;%</span> </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span> (<span class="sc">-</span>VIS, <span class="sc">-</span>NIR, <span class="sc">-</span> Res) <span class="sc">%&gt;%</span> </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span> (<span class="st">&quot;Reflectance&quot;</span> <span class="ot">=</span> TOT) </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>NIRDataSet <span class="ot">&lt;-</span> </span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  Cons1agg <span class="sc">%&gt;%</span> </span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span> (<span class="sc">-</span>TOT, <span class="sc">-</span>VIS, <span class="sc">-</span> Res) <span class="sc">%&gt;%</span> </span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span> (<span class="st">&quot;Reflectance&quot;</span> <span class="ot">=</span> NIR) </span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>VISDataSet <span class="ot">&lt;-</span> </span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  Cons1agg <span class="sc">%&gt;%</span> </span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span> (<span class="sc">-</span>TOT, <span class="sc">-</span>NIR, <span class="sc">-</span> Res) <span class="sc">%&gt;%</span> </span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span> (<span class="st">&quot;Reflectance&quot;</span> <span class="ot">=</span> VIS) </span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>ResDataSet <span class="ot">&lt;-</span> </span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>  Cons1agg <span class="sc">%&gt;%</span> </span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span> (<span class="sc">-</span>TOT, <span class="sc">-</span>NIR, <span class="sc">-</span>VIS) <span class="sc">%&gt;%</span> </span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span> (<span class="st">&quot;Reflectance&quot;</span> <span class="ot">=</span> Res)</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>NmoDataSet <span class="ot">&lt;-</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>  Cons1agg <span class="sc">%&gt;%</span> </span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span> (<span class="sc">-</span>TOT, <span class="sc">-</span> Res) <span class="sc">%&gt;%</span> </span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span> (<span class="st">&quot;Reflectance&quot;</span> <span class="ot">=</span> NIR) </span></code></pre></div>
</div>
</div>
<div id="pgls-on-mcc-tree" class="section level1">
<h1>PGLS on MCC tree</h1>
<p>The PGLS model tests if the correlations we found in the previous
step remain after correcting by phylogeny. This model does not consider
instraspecific variation. We averaged both location and reflectivity and
obtained only one value per species.</p>
<p>Set up:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>comp_data <span class="ot">&lt;-</span> <span class="fu">comparative.data</span>(</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">phy =</span> MCCtree, <span class="at">data =</span> Cons1agg,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">names.col =</span> <span class="st">&quot;phylogeny_name&quot;</span>, <span class="at">vcv =</span> <span class="cn">TRUE</span>,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.omit =</span> <span class="cn">FALSE</span>, <span class="at">warn.dropped =</span> <span class="cn">TRUE</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div id="tot" class="section level2">
<h2>TOT</h2>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>pglsmodTOT <span class="ot">&lt;-</span> <span class="fu">pgls</span>(TOT <span class="sc">~</span> PC1 <span class="sc">+</span> PC2 <span class="sc">+</span> size <span class="sc">+</span> PC1<span class="sc">*</span>size <span class="sc">+</span> PC2<span class="sc">*</span>size,</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> comp_data, <span class="at">param.CI =</span> <span class="fl">0.95</span>, <span class="at">lambda =</span> <span class="st">&quot;ML&quot;</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pglsmodTOT) </span></code></pre></div>
<pre><code>## 
## Call:
## pgls(formula = TOT ~ PC1 + PC2 + size + PC1 * size + PC2 * size, 
##     data = comp_data, lambda = &quot;ML&quot;, param.CI = 0.95)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -9.0799 -1.4748  0.0745  1.9952  6.6713 
## 
## Branch length transformations:
## 
## kappa  [Fix]  : 1.000
## lambda [ ML]  : 1.000
##    lower bound : 0.000, p = 0.038354
##    upper bound : 1.000, p = 1    
##    95.0% CI   : (0.661, NA)
## delta  [Fix]  : 1.000
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept) 14.94594   12.03651  1.2417   0.2214
## PC1         -5.70775    3.84672 -1.4838   0.1455
## PC2         -0.92677    4.74555 -0.1953   0.8461
## size         5.99790    3.73277  1.6068   0.1158
## PC1:size     2.65290    1.63942  1.6182   0.1133
## PC2:size     0.30175    1.88939  0.1597   0.8739
## 
## Residual standard error: 3.448 on 41 degrees of freedom
## Multiple R-squared: 0.1787,  Adjusted R-squared: 0.07853 
## F-statistic: 1.784 on 5 and 41 DF,  p-value: 0.1376</code></pre>
<p>None of the variables has an effect in the total reflectance</p>
<p>Test phylogenetic signal using Pagel’s lambda:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>pagelTOTRefl <span class="ot">&lt;-</span> Cons1agg<span class="sc">$</span>TOT <span class="co"># Define which trait you want to test</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(pagelTOTRefl) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(Cons1agg) <span class="co"># Row names = tree tips</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">phylosig</span>(MCCtree, pagelTOTRefl, <span class="at">method =</span> <span class="st">&quot;lambda&quot;</span>, <span class="at">test =</span> <span class="cn">TRUE</span>, <span class="at">nsim =</span> <span class="dv">999</span>)</span></code></pre></div>
<pre><code>## 
## Phylogenetic signal lambda : 0.819728 
## logL(lambda) : -162.013 
## LR(lambda=0) : 0.319604 
## P-value (based on LR test) : 0.571846</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># nsim = 999 means testing with 999 randomizations</span></span></code></pre></div>
<p>Phylogenetic signal is high.</p>
</div>
<div id="vis" class="section level2">
<h2>VIS</h2>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>pglsmodVIS <span class="ot">&lt;-</span> <span class="fu">pgls</span>(VIS <span class="sc">~</span> PC1 <span class="sc">+</span> PC2 <span class="sc">+</span> size <span class="sc">+</span> PC1<span class="sc">*</span>size <span class="sc">+</span> PC2<span class="sc">*</span>size,</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> comp_data, <span class="at">param.CI =</span> <span class="fl">0.95</span>, <span class="at">lambda =</span> <span class="st">&quot;ML&quot;</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pglsmodVIS) </span></code></pre></div>
<pre><code>## 
## Call:
## pgls(formula = VIS ~ PC1 + PC2 + size + PC1 * size + PC2 * size, 
##     data = comp_data, lambda = &quot;ML&quot;, param.CI = 0.95)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -8.3153 -1.6597  0.2742  1.3151  7.1544 
## 
## Branch length transformations:
## 
## kappa  [Fix]  : 1.000
## lambda [ ML]  : 1.000
##    lower bound : 0.000, p = 0.01719
##    upper bound : 1.000, p = 1    
##    95.0% CI   : (0.640, NA)
## delta  [Fix]  : 1.000
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)  -4.7921     9.8591 -0.4861  0.62952  
## PC1          -6.1775     3.1509 -1.9606  0.05675 .
## PC2          -6.8310     3.8871 -1.7574  0.08632 .
## size          7.0754     3.0575  2.3141  0.02575 *
## PC1:size      2.7225     1.3429  2.0274  0.04915 *
## PC2:size      2.5631     1.5476  1.6562  0.10532  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.824 on 41 degrees of freedom
## Multiple R-squared: 0.2311,  Adjusted R-squared: 0.1373 
## F-statistic: 2.465 on 5 and 41 DF,  p-value: 0.04838</code></pre>
<p>Results after correcting by phylogeny:</p>
<p><em>Size</em> —-</p>
<p>Even after correcting by phylogeny, larger beetles reflect more
visible light</p>
<p><em>PC1 and PC2</em> —-</p>
<p>Marginal effects. Larger PC1 lower VIS = Higher visible reflectivity
in more humid environments.</p>
<p>Larger PC2 lower VIS = Higher visible reflectivity in more hot arid
environments.</p>
<p><em>Interactions</em> —-</p>
<p>PC1:Size significant = smaller beetles tend to reflect more visible
light in more humid environments <em>OR</em> The effects in PC1 and PC2
are more significant for smaller beetles. PC2:Size not significant</p>
<p>Test phylogenetic signal using Pagel’s lambda:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>pagelVISRefl <span class="ot">&lt;-</span> Cons1agg<span class="sc">$</span>VIS <span class="co"># Define which trait you want to test</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(pagelVISRefl) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(Cons1agg) <span class="co"># Row names = tree tips</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">phylosig</span>(MCCtree, pagelVISRefl, <span class="at">method =</span> <span class="st">&quot;lambda&quot;</span>, <span class="at">test =</span> <span class="cn">TRUE</span>, <span class="at">nsim =</span> <span class="dv">999</span>)</span></code></pre></div>
<pre><code>## 
## Phylogenetic signal lambda : 0.882589 
## logL(lambda) : -154.422 
## LR(lambda=0) : 1.87652 
## P-value (based on LR test) : 0.17073</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># nsim = 999 means testing with 999 randomizations</span></span></code></pre></div>
<p>Phylogenetic signal is high.</p>
</div>
<div id="nir" class="section level2">
<h2>NIR</h2>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>pglsmodNIR <span class="ot">&lt;-</span> <span class="fu">pgls</span>(NIR <span class="sc">~</span> PC1 <span class="sc">+</span> PC2 <span class="sc">+</span> size <span class="sc">+</span> PC1<span class="sc">*</span>size <span class="sc">+</span> PC2<span class="sc">*</span>size,</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> comp_data, <span class="at">param.CI =</span> <span class="fl">0.95</span>, <span class="at">lambda =</span> <span class="st">&quot;ML&quot;</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pglsmodNIR) </span></code></pre></div>
<pre><code>## 
## Call:
## pgls(formula = NIR ~ PC1 + PC2 + size + PC1 * size + PC2 * size, 
##     data = comp_data, lambda = &quot;ML&quot;, param.CI = 0.95)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -10.1898  -1.9398   0.0626   2.8028  10.4344 
## 
## Branch length transformations:
## 
## kappa  [Fix]  : 1.000
## lambda [ ML]  : 1.000
##    lower bound : 0.000, p = 0.02704
##    upper bound : 1.000, p = 1    
##    95.0% CI   : (0.635, NA)
## delta  [Fix]  : 1.000
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)  32.1323    15.4659  2.0776  0.04405 *
## PC1          -5.3031     4.9427 -1.0729  0.28958  
## PC2           4.2105     6.0976  0.6905  0.49376  
## size          5.0615     4.7963  1.0553  0.29747  
## PC1:size      2.5949     2.1065  1.2318  0.22503  
## PC2:size     -1.6663     2.4277 -0.6864  0.49635  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.431 on 41 degrees of freedom
## Multiple R-squared: 0.1679,  Adjusted R-squared: 0.06639 
## F-statistic: 1.654 on 5 and 41 DF,  p-value: 0.1675</code></pre>
<p>Results after correcting by phylogeny:</p>
<p>None of the variables has an effect in the NIR reflectance</p>
<p>Test phylogenetic signal using Pagel’s lambda:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>pagelNIRRefl <span class="ot">&lt;-</span> Cons1agg<span class="sc">$</span>NIR <span class="co"># Define which trait you want to test</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(pagelNIRRefl) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(Cons1agg) <span class="co"># Row names = tree tips</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">phylosig</span>(MCCtree, pagelNIRRefl, <span class="at">method =</span> <span class="st">&quot;lambda&quot;</span>, <span class="at">test =</span> <span class="cn">TRUE</span>, <span class="at">nsim =</span> <span class="dv">999</span>)</span></code></pre></div>
<pre><code>## 
## Phylogenetic signal lambda : 0.816089 
## logL(lambda) : -173.55 
## LR(lambda=0) : 1.47387 
## P-value (based on LR test) : 0.224736</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># nsim = 999 means testing with 999 randomizations</span></span></code></pre></div>
<p>Phylogenetic signal is high.</p>
</div>
<div id="res" class="section level2">
<h2>Res</h2>
<p>(i.e. residuals between NIR ~ VIS)</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>pglsmodRes <span class="ot">&lt;-</span> <span class="fu">pgls</span>(Res <span class="sc">~</span> PC1 <span class="sc">+</span> PC2 <span class="sc">+</span> size <span class="sc">+</span> PC1<span class="sc">*</span>size <span class="sc">+</span> PC2<span class="sc">*</span>size,</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> comp_data, <span class="at">param.CI =</span> <span class="fl">0.95</span>, <span class="at">lambda =</span> <span class="st">&quot;ML&quot;</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pglsmodRes)</span></code></pre></div>
<pre><code>## 
## Call:
## pgls(formula = Res ~ PC1 + PC2 + size + PC1 * size + PC2 * size, 
##     data = comp_data, lambda = &quot;ML&quot;, param.CI = 0.95)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -5.6459 -1.9425 -0.4048  1.1028  9.5861 
## 
## Branch length transformations:
## 
## kappa  [Fix]  : 1.000
## lambda [ ML]  : 0.993
##    lower bound : 0.000, p = 0.0027546
##    upper bound : 1.000, p = 0.83769
##    95.0% CI   : (0.561, NA)
## delta  [Fix]  : 1.000
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept) 10.09770   10.56163  0.9561  0.34464  
## PC1          0.87161    3.41933  0.2549  0.80007  
## PC2         11.16291    4.23513  2.6358  0.01180 *
## size        -2.13834    3.32626 -0.6429  0.52389  
## PC1:size    -0.14131    1.45920 -0.0968  0.92333  
## PC2:size    -4.29135    1.68867 -2.5413  0.01492 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.981 on 41 degrees of freedom
## Multiple R-squared: 0.2136,  Adjusted R-squared: 0.1177 
## F-statistic: 2.227 on 5 and 41 DF,  p-value: 0.06975</code></pre>
<p>Results after correcting by phylogeny:</p>
<p><em>Size</em> —-</p>
<p>no effect</p>
<p><em>PC1 and PC2</em> —-</p>
<p>Larger PC2 larger NIR reflectivity = NIR reflective beetles live in
more fresh environments (less hot and arid)</p>
<p><em>Interactions</em> —-</p>
<p>smaller beetles tend to reflect more visible light in hotter arid
environments <em>OR</em> The effect of PC2 in the NIR residuals is more
significant for smaller beetles.</p>
<p>Test phylogenetic signal using Pagel’s lambda:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>pagelRes <span class="ot">&lt;-</span> Cons1agg<span class="sc">$</span>Res <span class="co"># Define which trait you want to test</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(pagelRes) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(Cons1agg) <span class="co"># Row names = tree tips</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">phylosig</span>(MCCtree, pagelRes, <span class="at">method =</span> <span class="st">&quot;lambda&quot;</span>, <span class="at">test =</span> <span class="cn">TRUE</span>, <span class="at">nsim =</span> <span class="dv">999</span>)</span></code></pre></div>
<pre><code>## 
## Phylogenetic signal lambda : 0.931743 
## logL(lambda) : -157.838 
## LR(lambda=0) : 7.25432 
## P-value (based on LR test) : 0.00707307</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># nsim = 999 means testing with 999 randomizations</span></span></code></pre></div>
<p>Phylogenetic signal is very high</p>
</div>
</div>
<div id="pgls-multiple-trees" class="section level1">
<h1>PGLS Multiple Trees</h1>
<div id="source-function" class="section level2">
<h2>Source function</h2>
<p>note that this function has to be adapted to the data frame and model
on each case</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;8_multiple_pgls_function_C.R&quot;</span>)<span class="co"># function C is for reflectance as response</span></span></code></pre></div>
</div>
<div id="define-model" class="section level2">
<h2>Define model</h2>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>MuPGLSMod <span class="ot">&lt;-</span> Reflectance <span class="sc">~</span> PC1 <span class="sc">+</span> PC2 <span class="sc">+</span> size <span class="sc">+</span> PC1<span class="sc">*</span>size <span class="sc">+</span> PC2<span class="sc">*</span>size</span></code></pre></div>
</div>
<div id="run" class="section level2">
<h2>Run</h2>
<div id="tot-1" class="section level3">
<h3>TOT</h3>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>runsTOT<span class="ot">&lt;-</span><span class="fu">lapply</span>(trees,pgls_run,<span class="at">model=</span>MuPGLSMod,<span class="at">dataset=</span>ALLDataSet) </span></code></pre></div>
<pre><code>## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>dfTOT <span class="ot">&lt;-</span> <span class="fu">ldply</span> (runsTOT, data.frame)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(dfTOT,<span class="st">&quot;../Data/FromCode/MuTPglsResultsTOT.csv&quot;</span>)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>mudfTOT <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;../Data/FromCode/MuTPglsResultsTOT.csv&quot;</span>)[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="fu">HPDinterval</span>(<span class="fu">as.mcmc</span>(dfTOT))</span></code></pre></div>
<pre><code>##                  lower      upper
## estimateP1 -7.35745936 -4.7606223
## ts1        -1.95135237 -1.1607712
## ps1         0.05634508  0.2481285
## estimateP2 -2.88429228  1.1262012
## tP2        -0.59683123  0.2524784
## pP2         0.58592184  0.9999923
## estimateP3  4.10277785  7.9011622
## tP3         0.98487332  2.0289506
## pP3         0.03903547  0.3066347
## estimateP4  2.22607324  3.3232925
## tP4         1.14050170  1.9958435
## pP4         0.03880395  0.2201823
## estimateP5 -0.48943961  1.1251529
## tP5        -0.25604953  0.6049516
## pP5         0.60886477  0.9999868
## attr(,&quot;Probability&quot;)
## [1] 0.9501511</code></pre>
</div>
<div id="vis-1" class="section level3">
<h3>VIS</h3>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>runsVIS<span class="ot">&lt;-</span><span class="fu">lapply</span>(trees,pgls_run,<span class="at">model=</span>MuPGLSMod,<span class="at">dataset=</span>VISDataSet) </span></code></pre></div>
<pre><code>## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>dfVIS <span class="ot">&lt;-</span> <span class="fu">ldply</span> (runsVIS, data.frame)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(dfVIS,<span class="st">&quot;../Data/FromCode/MuTPglsResultsVIS.csv&quot;</span>)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>mudfVIS <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;../Data/FromCode/MuTPglsResultsVIS.csv&quot;</span>)[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="fu">HPDinterval</span>(<span class="fu">as.mcmc</span>(mudfVIS))</span></code></pre></div>
<pre><code>##                   lower       upper
## estimateP1 -7.677549311 -5.28849193
## ts1        -2.419047389 -1.66986478
## ps1         0.016376219  0.09118539
## estimateP2 -8.471042500 -5.29772203
## tP2        -2.230090168 -1.36618493
## pP2         0.022231856  0.16432732
## estimateP3  6.069249418  8.41302588
## tP3         1.932069125  2.68138675
## pP3         0.008854441  0.05341940
## estimateP4  2.314745362  3.28369994
## tP4         1.761704230  2.51197754
## pP4         0.014315560  0.08225087
## estimateP5  1.870955925  3.18018409
## tP5         1.276479293  2.10746118
## pP5         0.031225845  0.19071319
## attr(,&quot;Probability&quot;)
## [1] 0.9499249</code></pre>
</div>
<div id="nir-1" class="section level3">
<h3>NIR</h3>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>runsNIR<span class="ot">&lt;-</span><span class="fu">lapply</span>(trees,pgls_run,<span class="at">model=</span>MuPGLSMod,<span class="at">dataset=</span>NIRDataSet) </span></code></pre></div>
<pre><code>## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>dfNIR <span class="ot">&lt;-</span> <span class="fu">ldply</span> (runsNIR, data.frame)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(dfNIR,<span class="st">&quot;../Data/FromCode/MuTPglsResultsNIR.csv&quot;</span>)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>mudfNIR <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;../Data/FromCode/MuTPglsResultsNIR.csv&quot;</span>)[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="fu">HPDinterval</span>(<span class="fu">as.mcmc</span>(mudfNIR))</span></code></pre></div>
<pre><code>##                 lower      upper
## estimateP1 -7.1703970 -4.0118289
## ts1        -1.4260708 -0.7308212
## ps1         0.1481836  0.4468380
## estimateP2  1.5428143  7.2149895
## tP2         0.2311177  1.1921070
## pP2         0.2329080  0.8086885
## estimateP3  2.0484494  7.2506605
## tP3         0.4004465  1.5014287
## pP3         0.1265687  0.6700089
## estimateP4  1.9178649  3.3160835
## tP4         0.8210857  1.5982398
## pP4         0.1083306  0.4044425
## estimateP5 -2.9095756 -0.6167299
## tP5        -1.1566283 -0.2283405
## pP5         0.2480681  0.8100840
## attr(,&quot;Probability&quot;)
## [1] 0.9499499</code></pre>
</div>
<div id="res-1" class="section level3">
<h3>Res</h3>
<p>(i.e. residuals between NIR ~ VIS)</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>runsRes<span class="ot">&lt;-</span><span class="fu">lapply</span>(trees,pgls_run,<span class="at">model=</span>MuPGLSMod,<span class="at">dataset=</span>ResDataSet) </span></code></pre></div>
<pre><code>## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>dfRes <span class="ot">&lt;-</span> <span class="fu">ldply</span> (runsRes, data.frame)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(dfRes,<span class="st">&quot;../Data/FromCode/MuTPglsResultsRes.csv&quot;</span>)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>mudfRes <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;../Data/FromCode/MuTPglsResultsRes.csv&quot;</span>)[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="fu">HPDinterval</span>(<span class="fu">as.mcmc</span>(mudfRes))</span></code></pre></div>
<pre><code>##                    lower       upper
## estimateP1 -0.3589274443  1.79097967
## ts1        -0.0961711442  0.53303180
## ps1         0.6344563161  0.99968776
## estimateP2  9.0125438851 13.84301021
## tP2         2.0059421386  3.32509046
## pP2         0.0003925185  0.03918852
## estimateP3 -4.0139565149 -0.53520045
## tP3        -1.1296631542 -0.16446537
## pP3         0.2618216713  0.86028674
## estimateP4 -0.6843013055  0.35603641
## tP4        -0.4396177277  0.26165591
## pP4         0.6903042214  0.99996709
## estimateP5 -5.4064007786 -3.48757445
## tP5        -3.1667545722 -1.99192470
## pP5         0.0008749745  0.04453556
## attr(,&quot;Probability&quot;)
## [1] 0.9499249</code></pre>
</div>
</div>
</div>
<div id="pgls-different-model" class="section level1">
<h1>PGLS Different model</h1>
<p>I also tried running the PGLs to predict NIR with a different model
using VIS visible reflectivity as a predictor</p>
<div id="source-function-1" class="section level2">
<h2>Source function</h2>
<p>note that this function has to be adapted to the data frame and model
on each case</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;9_multiple_pgls_function_D.R&quot;</span>)<span class="co"># function D is NIR explained by PCs and VIS</span></span></code></pre></div>
</div>
<div id="define-model-1" class="section level2">
<h2>Define model</h2>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>MuPGLSMod2 <span class="ot">&lt;-</span> Reflectance <span class="sc">~</span> PC1 <span class="sc">+</span> PC2 <span class="sc">+</span> size <span class="sc">+</span> PC1<span class="sc">*</span>size <span class="sc">+</span> PC2<span class="sc">*</span>size <span class="sc">+</span> VIS</span></code></pre></div>
</div>
<div id="run-1" class="section level2">
<h2>Run</h2>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>runsNmo<span class="ot">&lt;-</span><span class="fu">lapply</span>(trees[<span class="dv">51</span><span class="sc">:</span><span class="dv">60</span>],pgls_run,<span class="at">model=</span>MuPGLSMod,<span class="at">dataset=</span>NmoDataSet) </span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>dfNmo <span class="ot">&lt;-</span> <span class="fu">ldply</span> (runsNmo, data.frame)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(dfNmo,<span class="st">&quot;../Data/FromCode/MuTPglsResultsNmo.csv&quot;</span>)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>mudfNmo <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;../Data/FromCode/MuTPglsResultsNmo.csv&quot;</span>)[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a><span class="fu">HPDinterval</span>(<span class="fu">as.mcmc</span>(mudfNmo))</span></code></pre></div>
<pre><code>##                 lower      upper
## estimateP1 -6.6741144 -3.9067837
## ts1        -1.3607043 -0.7855176
## ps1         0.1810407  0.4366662
## estimateP2  2.3438389  6.8999156
## tP2         0.3813500  1.0879031
## pP2         0.2829919  0.7049127
## estimateP3  3.0957335  6.6736254
## tP3         0.5739848  1.3744415
## pP3         0.1767712  0.5691138
## estimateP4  2.0387806  3.2197953
## tP4         0.8774172  1.5088708
## pP4         0.1390001  0.3853727
## estimateP5 -2.7326422 -1.0356017
## tP5        -1.0851323 -0.4287997
## pP5         0.2842026  0.6703137
## attr(,&quot;Probability&quot;)
## [1] 0.9</code></pre>
<p><br> <br> <br></p>
</div>
</div>
<div id="pgls-intervals" class="section level1">
<h1>PGLS Intervals</h1>
<p>TOT</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>mudfTOT <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;../Data/FromCode/MuTPglsResultsTOT.csv&quot;</span>)[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>rrTOT<span class="ot">&lt;-</span> <span class="fu">HPDinterval</span>(<span class="fu">as.mcmc</span>(mudfTOT))</span></code></pre></div>
<p>VIS</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>mudfVIS <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;../Data/FromCode/MuTPglsResultsVIS.csv&quot;</span>)[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>rrVIS <span class="ot">&lt;-</span> <span class="fu">HPDinterval</span>(<span class="fu">as.mcmc</span>(mudfVIS))</span></code></pre></div>
<p>NIR</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>mudfNIR <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;../Data/FromCode/MuTPglsResultsNIR.csv&quot;</span>)[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>rrNIR <span class="ot">&lt;-</span> <span class="fu">HPDinterval</span>(<span class="fu">as.mcmc</span>(mudfNIR))</span></code></pre></div>
<p>Res</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>mudfRes <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;../Data/FromCode/MuTPglsResultsRes.csv&quot;</span>)[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>rrRes <span class="ot">&lt;-</span> <span class="fu">HPDinterval</span>(<span class="fu">as.mcmc</span>(mudfRes))</span></code></pre></div>
<p>full summary:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>Predictor <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;PC1&quot;</span>,<span class="st">&quot;PC1 p-val&quot;</span> , </span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;PC2&quot;</span>, <span class="st">&quot;PC2 p-val&quot;</span>, </span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;Size&quot;</span>, <span class="st">&quot;Size p-val&quot;</span>, </span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;PC1:size&quot;</span>, <span class="st">&quot;PC1:size p-val&quot;</span>, </span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;PC2:size&quot;</span>, <span class="st">&quot;PC2:size p-val&quot;</span>)</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>rvTOTl <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="fu">c</span>(rrTOT[<span class="dv">1</span>,<span class="dv">1</span>],rrTOT[<span class="dv">3</span>,<span class="dv">1</span>],rrTOT[<span class="dv">4</span>,<span class="dv">1</span>],rrTOT[<span class="dv">6</span>,<span class="dv">1</span>],</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>              rrTOT[<span class="dv">7</span>,<span class="dv">1</span>],rrTOT[<span class="dv">9</span>,<span class="dv">1</span>],rrTOT[<span class="dv">10</span>,<span class="dv">1</span>],rrTOT[<span class="dv">12</span>,<span class="dv">1</span>],</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>              rrTOT[<span class="dv">13</span>,<span class="dv">1</span>],rrTOT[<span class="dv">15</span>,<span class="dv">1</span>])),<span class="dv">3</span>)</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>rvTOTu <span class="ot">&lt;-</span> <span class="fu">format</span>(<span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="fu">c</span>(rrTOT[<span class="dv">1</span>,<span class="dv">2</span>],rrTOT[<span class="dv">3</span>,<span class="dv">2</span>],rrTOT[<span class="dv">4</span>,<span class="dv">2</span>],rrTOT[<span class="dv">6</span>,<span class="dv">2</span>],</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>              rrTOT[<span class="dv">7</span>,<span class="dv">2</span>],rrTOT[<span class="dv">9</span>,<span class="dv">2</span>],rrTOT[<span class="dv">10</span>,<span class="dv">2</span>],rrTOT[<span class="dv">12</span>,<span class="dv">2</span>],</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>              rrTOT[<span class="dv">13</span>,<span class="dv">2</span>],rrTOT[<span class="dv">15</span>,<span class="dv">2</span>])),<span class="dv">3</span>),<span class="at">nsmall=</span><span class="dv">3</span>)</span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>rvVISl <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="fu">c</span>(rrVIS[<span class="dv">1</span>,<span class="dv">1</span>],rrVIS[<span class="dv">3</span>,<span class="dv">1</span>],rrVIS[<span class="dv">4</span>,<span class="dv">1</span>],rrVIS[<span class="dv">6</span>,<span class="dv">1</span>],</span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>              rrVIS[<span class="dv">7</span>,<span class="dv">1</span>],rrVIS[<span class="dv">9</span>,<span class="dv">1</span>],rrVIS[<span class="dv">10</span>,<span class="dv">1</span>],rrVIS[<span class="dv">12</span>,<span class="dv">1</span>],</span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>              rrVIS[<span class="dv">13</span>,<span class="dv">1</span>],rrVIS[<span class="dv">15</span>,<span class="dv">1</span>])),<span class="dv">3</span>)</span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a>rvVISu <span class="ot">&lt;-</span> <span class="fu">format</span>(<span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="fu">c</span>(rrVIS[<span class="dv">1</span>,<span class="dv">2</span>],rrVIS[<span class="dv">3</span>,<span class="dv">2</span>],rrVIS[<span class="dv">4</span>,<span class="dv">2</span>],rrVIS[<span class="dv">6</span>,<span class="dv">2</span>],</span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a>              rrVIS[<span class="dv">7</span>,<span class="dv">2</span>],rrVIS[<span class="dv">9</span>,<span class="dv">2</span>],rrVIS[<span class="dv">10</span>,<span class="dv">2</span>],rrVIS[<span class="dv">12</span>,<span class="dv">2</span>],</span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a>              rrVIS[<span class="dv">13</span>,<span class="dv">2</span>],rrVIS[<span class="dv">15</span>,<span class="dv">2</span>])),<span class="dv">3</span>),<span class="at">nsmall=</span><span class="dv">3</span>)</span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-26"><a href="#cb59-26" aria-hidden="true" tabindex="-1"></a>rvNIRl <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="fu">c</span>(rrNIR[<span class="dv">1</span>,<span class="dv">1</span>],rrNIR[<span class="dv">3</span>,<span class="dv">1</span>],rrNIR[<span class="dv">4</span>,<span class="dv">1</span>],rrNIR[<span class="dv">6</span>,<span class="dv">1</span>],</span>
<span id="cb59-27"><a href="#cb59-27" aria-hidden="true" tabindex="-1"></a>              rrNIR[<span class="dv">7</span>,<span class="dv">1</span>],rrNIR[<span class="dv">9</span>,<span class="dv">1</span>],rrNIR[<span class="dv">10</span>,<span class="dv">1</span>],rrNIR[<span class="dv">12</span>,<span class="dv">1</span>],</span>
<span id="cb59-28"><a href="#cb59-28" aria-hidden="true" tabindex="-1"></a>              rrNIR[<span class="dv">13</span>,<span class="dv">1</span>],rrNIR[<span class="dv">15</span>,<span class="dv">1</span>])),<span class="dv">3</span>)</span>
<span id="cb59-29"><a href="#cb59-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-30"><a href="#cb59-30" aria-hidden="true" tabindex="-1"></a>rvNIRu <span class="ot">&lt;-</span> <span class="fu">format</span>(<span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="fu">c</span>(rrNIR[<span class="dv">1</span>,<span class="dv">2</span>],rrNIR[<span class="dv">3</span>,<span class="dv">2</span>],rrNIR[<span class="dv">4</span>,<span class="dv">2</span>],rrNIR[<span class="dv">6</span>,<span class="dv">2</span>],</span>
<span id="cb59-31"><a href="#cb59-31" aria-hidden="true" tabindex="-1"></a>              rrNIR[<span class="dv">7</span>,<span class="dv">2</span>],rrNIR[<span class="dv">9</span>,<span class="dv">2</span>],rrNIR[<span class="dv">10</span>,<span class="dv">2</span>],rrNIR[<span class="dv">12</span>,<span class="dv">2</span>],</span>
<span id="cb59-32"><a href="#cb59-32" aria-hidden="true" tabindex="-1"></a>              rrNIR[<span class="dv">13</span>,<span class="dv">2</span>],rrNIR[<span class="dv">15</span>,<span class="dv">2</span>])),<span class="dv">3</span>),<span class="at">nsmall=</span><span class="dv">3</span>)</span>
<span id="cb59-33"><a href="#cb59-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-34"><a href="#cb59-34" aria-hidden="true" tabindex="-1"></a>rvResl <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="fu">c</span>(rrRes[<span class="dv">1</span>,<span class="dv">1</span>],rrRes[<span class="dv">3</span>,<span class="dv">1</span>],rrRes[<span class="dv">4</span>,<span class="dv">1</span>],rrRes[<span class="dv">6</span>,<span class="dv">1</span>],</span>
<span id="cb59-35"><a href="#cb59-35" aria-hidden="true" tabindex="-1"></a>              rrRes[<span class="dv">7</span>,<span class="dv">1</span>],rrRes[<span class="dv">9</span>,<span class="dv">1</span>],rrRes[<span class="dv">10</span>,<span class="dv">1</span>],rrRes[<span class="dv">12</span>,<span class="dv">1</span>],</span>
<span id="cb59-36"><a href="#cb59-36" aria-hidden="true" tabindex="-1"></a>              rrRes[<span class="dv">13</span>,<span class="dv">1</span>],rrRes[<span class="dv">15</span>,<span class="dv">1</span>])),<span class="dv">3</span>)</span>
<span id="cb59-37"><a href="#cb59-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-38"><a href="#cb59-38" aria-hidden="true" tabindex="-1"></a>rvResu <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="fu">c</span>(rrRes[<span class="dv">1</span>,<span class="dv">2</span>],rrRes[<span class="dv">3</span>,<span class="dv">2</span>],rrRes[<span class="dv">4</span>,<span class="dv">2</span>],rrRes[<span class="dv">6</span>,<span class="dv">2</span>],</span>
<span id="cb59-39"><a href="#cb59-39" aria-hidden="true" tabindex="-1"></a>              rrRes[<span class="dv">7</span>,<span class="dv">2</span>],rrRes[<span class="dv">9</span>,<span class="dv">2</span>],rrRes[<span class="dv">10</span>,<span class="dv">2</span>],rrRes[<span class="dv">12</span>,<span class="dv">2</span>],</span>
<span id="cb59-40"><a href="#cb59-40" aria-hidden="true" tabindex="-1"></a>              rrRes[<span class="dv">13</span>,<span class="dv">2</span>],rrRes[<span class="dv">15</span>,<span class="dv">2</span>])),<span class="dv">3</span>)</span>
<span id="cb59-41"><a href="#cb59-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-42"><a href="#cb59-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-43"><a href="#cb59-43" aria-hidden="true" tabindex="-1"></a>rvTOTi<span class="ot">&lt;-</span><span class="fu">paste</span>(rvTOTl,rvTOTu, <span class="at">sep =</span> <span class="st">&quot; ; &quot;</span>)</span>
<span id="cb59-44"><a href="#cb59-44" aria-hidden="true" tabindex="-1"></a>rvVISi<span class="ot">&lt;-</span><span class="fu">paste</span>(rvVISl,rvVISu, <span class="at">sep =</span> <span class="st">&quot; ; &quot;</span>)</span>
<span id="cb59-45"><a href="#cb59-45" aria-hidden="true" tabindex="-1"></a>rvNIRi<span class="ot">&lt;-</span><span class="fu">paste</span>(rvNIRl,rvNIRu, <span class="at">sep =</span> <span class="st">&quot; ; &quot;</span>)</span>
<span id="cb59-46"><a href="#cb59-46" aria-hidden="true" tabindex="-1"></a>rvResi<span class="ot">&lt;-</span><span class="fu">paste</span>(rvResl,rvResu, <span class="at">sep =</span> <span class="st">&quot; ; &quot;</span>)</span>
<span id="cb59-47"><a href="#cb59-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-48"><a href="#cb59-48" aria-hidden="true" tabindex="-1"></a>rvVISi[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(rvVISi[<span class="dv">1</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb59-49"><a href="#cb59-49" aria-hidden="true" tabindex="-1"></a>rvVISi[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(rvVISi[<span class="dv">2</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb59-50"><a href="#cb59-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-51"><a href="#cb59-51" aria-hidden="true" tabindex="-1"></a>rvVISi[<span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(rvVISi[<span class="dv">5</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb59-52"><a href="#cb59-52" aria-hidden="true" tabindex="-1"></a>rvVISi[<span class="dv">6</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(rvVISi[<span class="dv">6</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb59-53"><a href="#cb59-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-54"><a href="#cb59-54" aria-hidden="true" tabindex="-1"></a>rvVISi[<span class="dv">7</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(rvVISi[<span class="dv">7</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb59-55"><a href="#cb59-55" aria-hidden="true" tabindex="-1"></a>rvVISi[<span class="dv">8</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(rvVISi[<span class="dv">8</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb59-56"><a href="#cb59-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-57"><a href="#cb59-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-58"><a href="#cb59-58" aria-hidden="true" tabindex="-1"></a>rvResi[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(rvResi[<span class="dv">3</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb59-59"><a href="#cb59-59" aria-hidden="true" tabindex="-1"></a>rvResi[<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(rvResi[<span class="dv">4</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb59-60"><a href="#cb59-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-61"><a href="#cb59-61" aria-hidden="true" tabindex="-1"></a>rvResi[<span class="dv">9</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(rvResi[<span class="dv">9</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb59-62"><a href="#cb59-62" aria-hidden="true" tabindex="-1"></a>rvResi[<span class="dv">10</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(rvResi[<span class="dv">10</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb59-63"><a href="#cb59-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-64"><a href="#cb59-64" aria-hidden="true" tabindex="-1"></a>Resultspgls <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Predictor,  </span>
<span id="cb59-65"><a href="#cb59-65" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;TOT&quot;</span> <span class="ot">=</span> rvTOTi,</span>
<span id="cb59-66"><a href="#cb59-66" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;VIS&quot;</span> <span class="ot">=</span> rvVISi,</span>
<span id="cb59-67"><a href="#cb59-67" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;NIR&quot;</span> <span class="ot">=</span> rvNIRi,</span>
<span id="cb59-68"><a href="#cb59-68" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;Res&quot;</span> <span class="ot">=</span> rvResi) </span>
<span id="cb59-69"><a href="#cb59-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-70"><a href="#cb59-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-71"><a href="#cb59-71" aria-hidden="true" tabindex="-1"></a>Resultspgls <span class="sc">%&gt;%</span> </span>
<span id="cb59-72"><a href="#cb59-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">align =</span><span class="st">&quot;c&quot;</span>, <span class="at">escape =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb59-73"><a href="#cb59-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb59-74"><a href="#cb59-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_indent</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">9</span>)) </span></code></pre></div>
<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
Predictor
</th>
<th style="text-align:center;">
TOT
</th>
<th style="text-align:center;">
VIS
</th>
<th style="text-align:center;">
NIR
</th>
<th style="text-align:center;">
Res
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;padding-left: 2em;" indentlevel="1">
PC1
</td>
<td style="text-align:center;">
-7.357 ; -4.761
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    color: #D40481 !important;">-7.678 ;
-5.288</span>
</td>
<td style="text-align:center;">
-7.17 ; -4.012
</td>
<td style="text-align:center;">
-0.359 ; 1.791
</td>
</tr>
<tr>
<td style="text-align:center;">
PC1 p-val
</td>
<td style="text-align:center;">
0.056 ; 0.248
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    ">0.016 ; 0.091</span>
</td>
<td style="text-align:center;">
0.148 ; 0.447
</td>
<td style="text-align:center;">
0.634 ; 1
</td>
</tr>
<tr>
<td style="text-align:center;padding-left: 2em;" indentlevel="1">
PC2
</td>
<td style="text-align:center;">
-2.884 ; 1.126
</td>
<td style="text-align:center;">
-8.471 ; -5.298
</td>
<td style="text-align:center;">
1.543 ; 7.215
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    color: #D40481 !important;">9.013 ;
13.843</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
PC2 p-val
</td>
<td style="text-align:center;">
0.586 ; 1.000
</td>
<td style="text-align:center;">
0.022 ; 0.164
</td>
<td style="text-align:center;">
0.233 ; 0.809
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    ">0 ; 0.039</span>
</td>
</tr>
<tr>
<td style="text-align:center;padding-left: 2em;" indentlevel="1">
Size
</td>
<td style="text-align:center;">
4.103 ; 7.901
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    color: #D40481 !important;">6.069 ;
8.413</span>
</td>
<td style="text-align:center;">
2.048 ; 7.251
</td>
<td style="text-align:center;">
-4.014 ; -0.535
</td>
</tr>
<tr>
<td style="text-align:center;">
Size p-val
</td>
<td style="text-align:center;">
0.039 ; 0.307
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    ">0.009 ; 0.053</span>
</td>
<td style="text-align:center;">
0.127 ; 0.670
</td>
<td style="text-align:center;">
0.262 ; 0.86
</td>
</tr>
<tr>
<td style="text-align:center;padding-left: 2em;" indentlevel="1">
PC1:size
</td>
<td style="text-align:center;">
2.226 ; 3.323
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    color: #D40481 !important;">2.315 ;
3.284</span>
</td>
<td style="text-align:center;">
1.918 ; 3.316
</td>
<td style="text-align:center;">
-0.684 ; 0.356
</td>
</tr>
<tr>
<td style="text-align:center;">
PC1:size p-val
</td>
<td style="text-align:center;">
0.039 ; 0.220
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    ">0.014 ; 0.082</span>
</td>
<td style="text-align:center;">
0.108 ; 0.404
</td>
<td style="text-align:center;">
0.69 ; 1
</td>
</tr>
<tr>
<td style="text-align:center;padding-left: 2em;" indentlevel="1">
PC2:size
</td>
<td style="text-align:center;">
-0.489 ; 1.125
</td>
<td style="text-align:center;">
1.871 ; 3.180
</td>
<td style="text-align:center;">
-2.91 ; -0.617
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    color: #D40481 !important;">-5.406 ;
-3.488</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
PC2:size p-val
</td>
<td style="text-align:center;">
0.609 ; 1.000
</td>
<td style="text-align:center;">
0.031 ; 0.191
</td>
<td style="text-align:center;">
0.248 ; 0.810
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    ">0.001 ; 0.045</span>
</td>
</tr>
</tbody>
</table>
</div>
<div id="conclusions" class="section level1">
<h1>Conclusions</h1>
<p>Lower PC1 = higher humidity (vapour, rain and clouds) lower
aridity.</p>
<p><br></p>
<p>Lower PC2 = higher solar radiation, higher max temp, more days above
35 and more aridity</p>
<p><br> <br></p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4,h5",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
