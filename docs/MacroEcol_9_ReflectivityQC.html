<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Reflectivity PGLS (Quality control)</title>

<script src="site_libs/header-attrs-2.17/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #ffffff;
    color: #a0a0a0;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
div.sourceCode
  { color: #1f1c1b; background-color: #ffffff; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #1f1c1b; } /* Normal */
code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
code span.an { color: #ca60ca; } /* Annotation */
code span.at { color: #0057ae; } /* Attribute */
code span.bn { color: #b08000; } /* BaseN */
code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
code span.ch { color: #924c9d; } /* Char */
code span.cn { color: #aa5500; } /* Constant */
code span.co { color: #898887; } /* Comment */
code span.cv { color: #0095ff; } /* CommentVar */
code span.do { color: #607880; } /* Documentation */
code span.dt { color: #0057ae; } /* DataType */
code span.dv { color: #b08000; } /* DecVal */
code span.er { color: #bf0303; text-decoration: underline; } /* Error */
code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
code span.fl { color: #b08000; } /* Float */
code span.fu { color: #644a9b; } /* Function */
code span.im { color: #ff5500; } /* Import */
code span.in { color: #b08000; } /* Information */
code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
code span.op { color: #1f1c1b; } /* Operator */
code span.ot { color: #006e28; } /* Other */
code span.pp { color: #006e28; } /* Preprocessor */
code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
code span.sc { color: #3daee9; } /* SpecialChar */
code span.ss { color: #ff5500; } /* SpecialString */
code span.st { color: #bf0303; } /* String */
code span.va { color: #0057ae; } /* Variable */
code span.vs { color: #bf0303; } /* VerbatimString */
code span.wa { color: #bf0303; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Photonic Rebels</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Main</a>
</li>
<li>
  <a href="MacroEcol_1_SettingUp.html">Setting up</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Extracting variables
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="MacroEcol_2_OpticalProperties.html">Reflectivity &amp; Absorptivity</a>
    </li>
    <li>
      <a href="MacroEcol_3_Polarisation.html">Polarisation</a>
    </li>
    <li>
      <a href="MacroEcol_4_EcologicalVariables.html">Ecology</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Analysis
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="MacroEcol_5_ReflectivityStats.html">Reflectivity</a>
    </li>
    <li>
      <a href="MacroEcol_6_AbsorptivityStats.html">Absorptivity</a>
    </li>
    <li>
      <a href="MacroEcol_7_PolarisationStats.html">Polarisation</a>
    </li>
    <li>
      <a href="MacroEcol_8_SizeStats.html">Size</a>
    </li>
    <li>
      <a href="MacroEcol_9_ReflectivityQC.html">Quality control (reflectivity)</a>
    </li>
    <li>
      <a href="MacroEcol_10_AbsorptivityQC.html">Quality control (absorptivity)</a>
    </li>
  </ul>
</li>
<li>
  <a href="MacroEcol_11_ExtraFigures.html">Extra figures</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Reflectivity PGLS (Quality control)</h1>

</div>


<p>In this script we use a combination of phylogenetically controlled
models to evaluate if VIS and NIR reflectivity in the Christmas beetles’
elytra can be predicted by climate and size. Climate here is determined
by the ecological variables: maximum temperature, number of days above
35°C, solar radiation, cloud cover, rain, water vapour and aridity
summarised in two principal components.</p>
<div id="setting-up-data" class="section level1">
<h1>Setting up data</h1>
<div id="libraries" class="section level2">
<h2>Libraries</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We source the libraries from this file:</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;Scripts/MacroEcol_1_Libraries.R&quot;</span>))</span></code></pre></div>
</div>
<div id="data-sets" class="section level2">
<h2>Data Sets</h2>
<p><br> <span style="color: #04C799"> <strong>Reflectivity data</strong>
</span> <br/></p>
<p>Initially we import the reflectivity data obtained in the script
“optical properties” and join it with the environmental data obtained in
“Ecological variables”</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Consolidated by individual</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>Cons1 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;Data/FromCode/ConsReflEcolInd.csv&quot;</span>))[<span class="sc">-</span><span class="dv">1</span>] <span class="sc">%&gt;%</span> </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">str_detect</span>(ind, <span class="st">&quot;xyls&quot;</span>),</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">str_detect</span>(ind, <span class="st">&quot;prsi&quot;</span>),</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">str_detect</span>(ind, <span class="st">&quot;xyle&quot;</span>),</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">str_detect</span>(ind, <span class="st">&quot;pczo&quot;</span>),</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">str_detect</span>(ind, <span class="st">&quot;pczp&quot;</span>),</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">str_detect</span>(ind, <span class="st">&quot;pczv&quot;</span>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Consolidated by species</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>Cons1agg <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;Data/FromCode/ConsolidatedReflectivitySpp.csv&quot;</span>))[<span class="sc">-</span><span class="dv">1</span>] <span class="sc">%&gt;%</span> </span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(phylogeny_name) <span class="sc">%&gt;%</span> </span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(phylogeny_name <span class="sc">%in%</span> Cons1<span class="sc">$</span>phylogeny_name)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="co"># PC Values</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>PCValuesF <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;Data/FromCode/PCsbySpp.csv&quot;</span>))[<span class="sc">-</span><span class="dv">1</span>] <span class="sc">%&gt;%</span> </span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(phylogeny_name) <span class="sc">%&gt;%</span> </span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(phylogeny_name <span class="sc">%in%</span> Cons1<span class="sc">$</span>phylogeny_name)</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>Cons1agg<span class="sc">$</span>PC1 <span class="ot">&lt;-</span> PCValuesF<span class="sc">$</span>PC1_1</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>Cons1agg<span class="sc">$</span>PC2 <span class="ot">&lt;-</span> PCValuesF<span class="sc">$</span>PC2_1</span></code></pre></div>
<p><br> <span style="color: #04C799"> <strong>Phylogenetic data</strong>
</span> <br/></p>
<p>In our analyses we use a subset of the 1300 posterior sample trees to
represent the phylogenetic information accounting for uncertainty in
node ages and topology:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set subset limits</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>trees_subset_min<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>trees_subset_max<span class="ot">&lt;-</span><span class="dv">2000</span></span></code></pre></div>
<p>Import phylogeny (multiple trees)</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>trees <span class="ot">&lt;-</span> ape<span class="sc">::</span><span class="fu">read.tree</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;Data/XMAS_mat2b_bst2ef_set23nn2_pinct.nwk&quot;</span>))</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>MCCtree <span class="ot">&lt;-</span> </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  ape<span class="sc">::</span><span class="fu">read.nexus</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;Data/xmas_mat2b_bst2ef_set23nn2_pinct_med.tre&quot;</span>))</span></code></pre></div>
<p>The MCC (Maximum clade credibility) tree used here is the BEAST MCC
tree. We did not need to prun the tree. The equivalence between specie
sin the tree and data frame was tested in previous steps (tab optical
properties).</p>
<p><br> <span style="color: #04C799"> <strong>Merge</strong> </span>
<br/></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modify to make it compatible with tree tips</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>Cons1agg <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(Cons1agg) <span class="co"># convert to a data frame</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(Cons1agg) <span class="ot">&lt;-</span> Cons1agg[, <span class="dv">1</span>] <span class="co"># make species the row names </span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>ConsAgg <span class="ot">&lt;-</span> Cons1agg [,<span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(Cons1agg)] <span class="co"># eliminate spp name (redundant)</span></span></code></pre></div>
<p>The names between data and tree tips should match.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test if the species are the same</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">identical</span>(</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">length</span>(<span class="fu">name.check</span>(MCCtree, Cons1agg<span class="sc">$</span>phylogeny_name)<span class="sc">$</span>tree_not_data),</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">length</span>(Cons1agg<span class="sc">$</span>phylogeny_name)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<p><span style="color: #04C799"> <strong>Subsets</strong> </span>
<br/></p>
<p>Create subsets for each spectral band. In these subsets the response
variable is always called “response” so that we can use the same
function to run various models.</p>
<p>In this script, the response variable is the reflectance on each
spectral band or the NIR/VIS residuals.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>ALLDataSet <span class="ot">&lt;-</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  Cons1agg <span class="sc">%&gt;%</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span> (<span class="sc">-</span>VIS, <span class="sc">-</span>NIR, <span class="sc">-</span> Res, <span class="sc">-</span>FRS, <span class="sc">-</span>FRS2) <span class="sc">%&gt;%</span> </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span> (<span class="st">&quot;Response&quot;</span> <span class="ot">=</span> TOT) </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>NIRDataSet <span class="ot">&lt;-</span> </span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  Cons1agg <span class="sc">%&gt;%</span> </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span> (<span class="sc">-</span>TOT, <span class="sc">-</span>VIS, <span class="sc">-</span> Res, <span class="sc">-</span>FRS, <span class="sc">-</span>FRS2) <span class="sc">%&gt;%</span> </span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span> (<span class="st">&quot;Response&quot;</span> <span class="ot">=</span> NIR) </span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>VISDataSet <span class="ot">&lt;-</span> </span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  Cons1agg <span class="sc">%&gt;%</span> </span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span> (<span class="sc">-</span>TOT, <span class="sc">-</span>NIR, <span class="sc">-</span> Res, <span class="sc">-</span>FRS, <span class="sc">-</span>FRS2) <span class="sc">%&gt;%</span> </span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span> (<span class="st">&quot;Response&quot;</span> <span class="ot">=</span> VIS) </span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>ResDataSet <span class="ot">&lt;-</span> </span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  Cons1agg <span class="sc">%&gt;%</span> </span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span> (<span class="sc">-</span>TOT, <span class="sc">-</span>NIR, <span class="sc">-</span>VIS, <span class="sc">-</span>FRS, <span class="sc">-</span>FRS2) <span class="sc">%&gt;%</span> </span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span> (<span class="st">&quot;Response&quot;</span> <span class="ot">=</span> Res)</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>NmoDataSet <span class="ot">&lt;-</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>  Cons1agg <span class="sc">%&gt;%</span> </span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span> (<span class="sc">-</span>TOT, <span class="sc">-</span> Res, <span class="sc">-</span>FRS, <span class="sc">-</span>FRS2) <span class="sc">%&gt;%</span> <span class="co"># keep VIS as predictor</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span> (<span class="st">&quot;Response&quot;</span> <span class="ot">=</span> NIR) <span class="co"># Raw NIR </span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>FRSDataSet <span class="ot">&lt;-</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>  Cons1agg <span class="sc">%&gt;%</span> </span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span> (<span class="sc">-</span>TOT, <span class="sc">-</span>NIR, <span class="sc">-</span>VIS, <span class="sc">-</span>Res, <span class="sc">-</span>FRS2) <span class="sc">%&gt;%</span> </span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span> (<span class="st">&quot;Response&quot;</span> <span class="ot">=</span> FRS) <span class="co"># PGLS Residuals </span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>PRSDataSet <span class="ot">&lt;-</span></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>  Cons1agg <span class="sc">%&gt;%</span> </span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span> (<span class="sc">-</span>TOT, <span class="sc">-</span>NIR, <span class="sc">-</span>VIS, <span class="sc">-</span>Res, <span class="sc">-</span>FRS) <span class="sc">%&gt;%</span> </span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span> (<span class="st">&quot;Response&quot;</span> <span class="ot">=</span> FRS2) <span class="co"># PGLS Phyres residuals</span></span></code></pre></div>
</div>
</div>
<div id="setting-up-models" class="section level1">
<h1>Setting up models</h1>
<p>The PGLS function has to be adapted to the data frame and model on
each case</p>
<div id="model-1" class="section level2">
<h2>Model 1</h2>
<p>PGLS in the MCC</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>comp_data <span class="ot">&lt;-</span> <span class="fu">comparative.data</span>(</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">phy =</span> MCCtree, <span class="at">data =</span> Cons1agg,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">names.col =</span> <span class="st">&quot;phylogeny_name&quot;</span>, <span class="at">vcv =</span> <span class="cn">TRUE</span>,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.omit =</span> <span class="cn">FALSE</span>, <span class="at">warn.dropped =</span> <span class="cn">TRUE</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Warning in comparative.data(phy = MCCtree, data = Cons1agg, names.col = &quot;phylogeny_name&quot;, : Data dropped in compiling comparative data object</code></pre>
</div>
<div id="model-2" class="section level2">
<h2>Model 2</h2>
<p>PGLS Multiple Trees with 5 predictors + intercept</p>
<p>Source function</p>
<p>note that this function has to be adapted to the data frame and model
on each case</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># function C is for reflectance as response</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;Scripts/8_multiple_pgls_function_C.R&quot;</span>))</span></code></pre></div>
<p>Define model</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>MuPGLSMod2 <span class="ot">&lt;-</span> Response <span class="sc">~</span> PC1 <span class="sc">+</span> PC2 <span class="sc">+</span> size <span class="sc">+</span> PC1<span class="sc">*</span>size <span class="sc">+</span> PC2<span class="sc">*</span>size</span></code></pre></div>
</div>
<div id="model-3" class="section level2">
<h2>Model 3</h2>
<p>PGLS in multiple trees for NIR contains 6 predictors + intercept. The
extra predictor here is the “VIS” reflectance to account for the
correlation of these two variables.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># function D: NIR explained by PCs and VIS</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;Scripts/9_multiple_pgls_function_D.R&quot;</span>))</span></code></pre></div>
<p>Define model</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>MuPGLSMod3 <span class="ot">&lt;-</span> Response <span class="sc">~</span> PC1 <span class="sc">+</span> PC2 <span class="sc">+</span> size <span class="sc">+</span> PC1<span class="sc">*</span>size <span class="sc">+</span> PC2<span class="sc">*</span>size <span class="sc">+</span> VIS</span></code></pre></div>
</div>
<div id="model-4" class="section level2">
<h2>Model 4</h2>
<p>PGLS Multiple Trees with 3 predictors + intercept</p>
<p>We run simplified models with only one pc for each spectral band
including only the predictors that were signifficant in the full model.
(because the visible reflectance seems to be more correlated to PC1 and
the NIR to PC2)</p>
<p>Source function</p>
<p>note that this function has to be adapted to the data frame and model
on each case</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># function E: simplified. One PC and size</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;Scripts/10_multiple_pgls_function_E.R&quot;</span>))</span></code></pre></div>
<p>Define model</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>MuPGLSMod4 <span class="ot">&lt;-</span> Response <span class="sc">~</span> PC <span class="sc">+</span> size <span class="sc">+</span> PC<span class="sc">*</span>size </span></code></pre></div>
</div>
<div id="model-5" class="section level2">
<h2>Model 5</h2>
<p>PGLS Multiple Trees with 4 predictors + intercept</p>
<p>We run simplified models with only one pc for each spectral band
including only the predictors that were signifficant in the full model
(because the visible reflectance seems to be more correlated to PC1 and
the NIR to PC2). However, for NIR we need to include VIS reflectance as
a predictor</p>
<p>Source function</p>
<p>note that this function has to be adapted to the data frame and model
on each case</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># F: One PC, size and VIS as predictors</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;Scripts/11_multiple_pgls_function_F.R&quot;</span>))</span></code></pre></div>
<p>Define model</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>MuPGLSMod5 <span class="ot">&lt;-</span> Response <span class="sc">~</span> PC <span class="sc">+</span> size <span class="sc">+</span> PC<span class="sc">*</span>size <span class="sc">+</span> VIS</span></code></pre></div>
</div>
</div>
<div id="results-per-spectral-band" class="section level1">
<h1>Results per spectral band</h1>
<p>The PGLS model tests if the correlations we found in the previous
step remain after correcting by phylogeny. This model does not consider
instraspecific variation. We averaged both location and reflectivity and
obtained only one value per species.</p>
<div id="tot" class="section level2">
<h2>TOT</h2>
<div id="mcc-tree" class="section level3">
<h3>MCC Tree</h3>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>pglsmodTOT <span class="ot">&lt;-</span> <span class="fu">pgls</span>(TOT <span class="sc">~</span> PC1 <span class="sc">+</span> PC2 <span class="sc">+</span> size <span class="sc">+</span> PC1<span class="sc">*</span>size <span class="sc">+</span> PC2<span class="sc">*</span>size,</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> comp_data, <span class="at">param.CI =</span> <span class="fl">0.95</span>, <span class="at">lambda =</span> <span class="st">&quot;ML&quot;</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>FinMccTotc <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">round</span>(<span class="fu">summary</span>(pglsmodTOT)<span class="sc">$</span>coefficients[,<span class="dv">1</span>],<span class="dv">3</span>))</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>FinMccTotp <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">round</span>(<span class="fu">summary</span>(pglsmodTOT)<span class="sc">$</span>coefficients[,<span class="dv">4</span>],<span class="dv">3</span>)) </span></code></pre></div>
</div>
<div id="multiple-trees" class="section level3">
<h3>multiple trees</h3>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>runsTOT<span class="ot">&lt;-</span><span class="fu">lapply</span>(trees[trees_subset_min<span class="sc">:</span>trees_subset_max],</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>                pgls_runC,</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">model=</span>MuPGLSMod2,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">dataset=</span>ALLDataSet) </span></code></pre></div>
<pre><code>## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>dfTOT <span class="ot">&lt;-</span> <span class="fu">ldply</span> (runsTOT, data.frame)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(dfTOT[,<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 1000</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(dfTOT, here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;Data/FromCode/MuTPglsResultsTOT_QC.csv&quot;</span>))</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>FinTotM <span class="ot">&lt;-</span> <span class="fu">HPDinterval</span>(<span class="fu">as.mcmc</span>(dfTOT))</span></code></pre></div>
</div>
</div>
<div id="vis" class="section level2">
<h2>VIS</h2>
<div id="full-model" class="section level3">
<h3>Full model</h3>
<div id="mcc-tree-1" class="section level4">
<h4>MCC Tree</h4>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>pglsmodVIS <span class="ot">&lt;-</span> <span class="fu">pgls</span>(VIS <span class="sc">~</span> PC1 <span class="sc">+</span> PC2 <span class="sc">+</span> size <span class="sc">+</span> PC1<span class="sc">*</span>size <span class="sc">+</span> PC2<span class="sc">*</span>size,</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> comp_data, <span class="at">param.CI =</span> <span class="fl">0.95</span>, <span class="at">lambda =</span> <span class="st">&quot;ML&quot;</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>FinMccVisc <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">round</span>(<span class="fu">summary</span>(pglsmodVIS)<span class="sc">$</span>coefficients[,<span class="dv">1</span>],<span class="dv">3</span>)) </span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>FinMccVisp <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">round</span>(<span class="fu">summary</span>(pglsmodVIS)<span class="sc">$</span>coefficients[,<span class="dv">4</span>],<span class="dv">3</span>))</span></code></pre></div>
</div>
<div id="multiple-trees-1" class="section level4">
<h4>multiple trees</h4>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>runsVIS<span class="ot">&lt;-</span><span class="fu">lapply</span>(trees[trees_subset_min<span class="sc">:</span>trees_subset_max],</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>                pgls_runC,</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">model=</span>MuPGLSMod2,</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">dataset=</span>VISDataSet) </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>dfVIS <span class="ot">&lt;-</span> <span class="fu">ldply</span> (runsVIS, data.frame)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(dfVIS[,<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 1001</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(dfVIS, here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;Data/FromCode/MuTPglsResultsVIS_QC.csv&quot;</span>))</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>FinVisM <span class="ot">&lt;-</span> <span class="fu">HPDinterval</span>(<span class="fu">as.mcmc</span>(dfVIS))</span></code></pre></div>
</div>
</div>
<div id="simple-model" class="section level3">
<h3>Simple model</h3>
<div id="mcc-tree-2" class="section level4">
<h4>MCC Tree</h4>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>spglsmodVIS <span class="ot">&lt;-</span> <span class="fu">pgls</span>(VIS <span class="sc">~</span> PC1 <span class="sc">+</span> size <span class="sc">+</span> PC1<span class="sc">*</span>size,</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> comp_data, <span class="at">param.CI =</span> <span class="fl">0.95</span>, <span class="at">lambda =</span> <span class="st">&quot;ML&quot;</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(spglsmodVIS) </span></code></pre></div>
<pre><code>## 
## Call:
## pgls(formula = VIS ~ PC1 + size + PC1 * size, data = comp_data, 
##     lambda = &quot;ML&quot;, param.CI = 0.95)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -9.3779 -1.6848  0.3588  1.5383  3.4719 
## 
## Branch length transformations:
## 
## kappa  [Fix]  : 1.000
## lambda [ ML]  : 1.000
##    lower bound : 0.000, p = 0.0084147
##    upper bound : 1.000, p = 1    
##    95.0% CI   : (0.695, NA)
## delta  [Fix]  : 1.000
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)  -2.4691     9.0549 -0.2727  0.78658  
## PC1          -5.8156     2.6312 -2.2103  0.03318 *
## size          5.4531     2.5683  2.1232  0.04031 *
## PC1:size      2.4594     1.0881  2.2602  0.02962 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.982 on 38 degrees of freedom
## Multiple R-squared: 0.1701,  Adjusted R-squared: 0.1046 
## F-statistic: 2.596 on 3 and 38 DF,  p-value: 0.06651</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>sFinMccVisc <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">round</span>(<span class="fu">summary</span>(spglsmodVIS)<span class="sc">$</span>coefficients[,<span class="dv">1</span>],<span class="dv">3</span>)) </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>sFinMccVisp <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">round</span>(<span class="fu">summary</span>(spglsmodVIS)<span class="sc">$</span>coefficients[,<span class="dv">4</span>],<span class="dv">3</span>))</span></code></pre></div>
</div>
<div id="multiple-trees-2" class="section level4">
<h4>multiple trees</h4>
<p>First step is to modify the data frame.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>SimpleVIS <span class="ot">&lt;-</span> </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  VISDataSet <span class="sc">%&gt;%</span> </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(phylogeny_name, Response, size, PC1) <span class="sc">%&gt;%</span> </span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">PC =</span> PC1)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>SimpleVIS <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(SimpleVIS)</span></code></pre></div>
<p>Now run the model</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>runsVISsimple<span class="ot">&lt;-</span><span class="fu">lapply</span>(trees[trees_subset_min<span class="sc">:</span>trees_subset_max],</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>                      pgls_runE,</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">model=</span>MuPGLSMod4,</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">dataset=</span>SimpleVIS) </span></code></pre></div>
<pre><code>## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>dfVISsimple <span class="ot">&lt;-</span> <span class="fu">ldply</span> (runsVISsimple, data.frame)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(dfVISsimple[,<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 1000</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>FinVisS <span class="ot">&lt;-</span> <span class="fu">HPDinterval</span>(<span class="fu">as.mcmc</span>(dfVISsimple))</span></code></pre></div>
</div>
</div>
</div>
<div id="nir" class="section level2">
<h2>NIR</h2>
<div id="full-model-1" class="section level3">
<h3>Full model</h3>
<div id="mcc-tree-3" class="section level4">
<h4>MCC Tree</h4>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>pglsmodNIR <span class="ot">&lt;-</span> <span class="fu">pgls</span>(NIR <span class="sc">~</span> PC1 <span class="sc">+</span> PC2 <span class="sc">+</span> size <span class="sc">+</span> PC1<span class="sc">*</span>size <span class="sc">+</span> PC2<span class="sc">*</span>size <span class="sc">+</span> VIS,</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> comp_data, <span class="at">param.CI =</span> <span class="fl">0.95</span>, <span class="at">lambda =</span> <span class="st">&quot;ML&quot;</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>FinMccNirc <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">round</span>(<span class="fu">summary</span>(pglsmodNIR)<span class="sc">$</span>coefficients[,<span class="dv">1</span>],<span class="dv">3</span>)) </span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>FinMccNirp <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">round</span>(<span class="fu">summary</span>(pglsmodNIR)<span class="sc">$</span>coefficients[,<span class="dv">4</span>],<span class="dv">3</span>))</span></code></pre></div>
</div>
<div id="multiple-trees-3" class="section level4">
<h4>multiple trees</h4>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>runsNIR<span class="ot">&lt;-</span><span class="fu">lapply</span>(trees[trees_subset_min<span class="sc">:</span>trees_subset_max],</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>                pgls_runD,</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">model=</span>MuPGLSMod3,</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">dataset=</span>NmoDataSet) </span></code></pre></div>
<pre><code>## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>dfNIR <span class="ot">&lt;-</span> <span class="fu">ldply</span> (runsNIR, data.frame)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(dfNIR[,<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 995</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(dfNIR, here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;Data/FromCode/MuTPglsResultsNmo_QC.csv&quot;</span>))</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>FinNirM <span class="ot">&lt;-</span> <span class="fu">HPDinterval</span>(<span class="fu">as.mcmc</span>(dfNIR))</span></code></pre></div>
</div>
</div>
<div id="simple-model-1" class="section level3">
<h3>Simple model</h3>
<div id="mcc-tree-4" class="section level4">
<h4>MCC Tree</h4>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>spglsmodNIR <span class="ot">&lt;-</span> <span class="fu">pgls</span>(NIR <span class="sc">~</span> PC2 <span class="sc">+</span> size <span class="sc">+</span> PC2<span class="sc">*</span>size <span class="sc">+</span> VIS,</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> comp_data, <span class="at">param.CI =</span> <span class="fl">0.95</span>, <span class="at">lambda =</span> <span class="st">&quot;ML&quot;</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>sFinMccNirc <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">round</span>(<span class="fu">summary</span>(spglsmodNIR)<span class="sc">$</span>coefficients[,<span class="dv">1</span>],<span class="dv">3</span>)) </span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>sFinMccNirp <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">round</span>(<span class="fu">summary</span>(spglsmodNIR)<span class="sc">$</span>coefficients[,<span class="dv">4</span>],<span class="dv">3</span>))</span></code></pre></div>
</div>
<div id="multiple-trees-4" class="section level4">
<h4>multiple trees</h4>
<p>First step is to modify the data frame.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>SimpleNIR <span class="ot">&lt;-</span> </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  NmoDataSet <span class="sc">%&gt;%</span> </span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(phylogeny_name, Response, size, VIS, PC2) <span class="sc">%&gt;%</span> </span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">PC =</span> PC2)</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>SimpleNIR <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(SimpleNIR)</span></code></pre></div>
<p>Now run the model</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>runsNIRsimple<span class="ot">&lt;-</span><span class="fu">lapply</span>(trees[trees_subset_min<span class="sc">:</span>trees_subset_max],</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>                      pgls_runF,</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">model=</span>MuPGLSMod5,</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">dataset=</span>SimpleNIR) </span></code></pre></div>
<pre><code>## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>dfNIRsimple <span class="ot">&lt;-</span> <span class="fu">ldply</span> (runsNIRsimple, data.frame)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(dfNIRsimple[,<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 998</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>FinNirS <span class="ot">&lt;-</span> <span class="fu">HPDinterval</span>(<span class="fu">as.mcmc</span>(dfNIRsimple))</span></code></pre></div>
</div>
</div>
</div>
<div id="res" class="section level2">
<h2>Res</h2>
<p>Residuals between NIR ~ VIS reflectance without phylogenetic
correction</p>
<div id="full-model-2" class="section level3">
<h3>Full model</h3>
<div id="mcc-tree-5" class="section level4">
<h4>MCC Tree</h4>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>pglsmodRes <span class="ot">&lt;-</span> <span class="fu">pgls</span>(Res <span class="sc">~</span> PC1 <span class="sc">+</span> PC2 <span class="sc">+</span> size <span class="sc">+</span> PC1<span class="sc">*</span>size <span class="sc">+</span> PC2<span class="sc">*</span>size,</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> comp_data, <span class="at">param.CI =</span> <span class="fl">0.95</span>, <span class="at">lambda =</span> <span class="st">&quot;ML&quot;</span>, <span class="at">bounds =</span> <span class="fu">list</span>(<span class="at">lambda=</span><span class="fu">c</span>(<span class="fl">1e-5</span>,<span class="dv">1</span>)) <span class="co"># modify bounds (defaults are c(1e-6,1))</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>FinMccResc <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">round</span>(<span class="fu">summary</span>(pglsmodRes)<span class="sc">$</span>coefficients[,<span class="dv">1</span>],<span class="dv">3</span>)) </span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>FinMccResp <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">round</span>(<span class="fu">summary</span>(pglsmodRes)<span class="sc">$</span>coefficients[,<span class="dv">4</span>],<span class="dv">3</span>))</span></code></pre></div>
</div>
<div id="multiple-trees-5" class="section level4">
<h4>multiple trees</h4>
<p>(i.e. residuals between NIR ~ VIS)</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>runsRes<span class="ot">&lt;-</span><span class="fu">lapply</span>(trees[trees_subset_min<span class="sc">:</span>trees_subset_max],</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>                pgls_runC,</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">model=</span>MuPGLSMod2,</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">dataset=</span>ResDataSet) </span></code></pre></div>
<pre><code>## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>dfRes <span class="ot">&lt;-</span> <span class="fu">ldply</span>(runsRes, data.frame)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(dfRes[,<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 995</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(dfRes, here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;Data/FromCode/MuTPglsResultsRes_QC.csv&quot;</span>))</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>FinResM <span class="ot">&lt;-</span> <span class="fu">HPDinterval</span>(<span class="fu">as.mcmc</span>(dfRes))</span></code></pre></div>
</div>
</div>
<div id="simple-model-2" class="section level3">
<h3>Simple model</h3>
<div id="mcc-tree-6" class="section level4">
<h4>MCC Tree</h4>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>spglsmodRes <span class="ot">&lt;-</span> <span class="fu">pgls</span>(Res <span class="sc">~</span> PC2 <span class="sc">+</span> size <span class="sc">+</span> PC2<span class="sc">*</span>size,</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> comp_data, <span class="at">param.CI =</span> <span class="fl">0.95</span>, <span class="at">lambda =</span> <span class="st">&quot;ML&quot;</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>sFinMccResc <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">round</span>(<span class="fu">summary</span>(spglsmodRes)<span class="sc">$</span>coefficients[,<span class="dv">1</span>],<span class="dv">3</span>)) </span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>sFinMccResp <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">round</span>(<span class="fu">summary</span>(spglsmodRes)<span class="sc">$</span>coefficients[,<span class="dv">4</span>],<span class="dv">3</span>))</span></code></pre></div>
</div>
<div id="multiple-trees-6" class="section level4">
<h4>multiple trees</h4>
<p>First step is to modify the data frame.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>SimpleRes <span class="ot">&lt;-</span> </span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  ResDataSet <span class="sc">%&gt;%</span> </span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(phylogeny_name, Response, size, PC2) <span class="sc">%&gt;%</span> </span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">PC =</span> PC2)</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>SimpleRes <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(SimpleRes)</span></code></pre></div>
<p>Now run the model</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>runsRessimple<span class="ot">&lt;-</span><span class="fu">lapply</span>(trees[trees_subset_min<span class="sc">:</span>trees_subset_max],</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>                      pgls_runE,</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">model=</span>MuPGLSMod4,</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">dataset=</span>SimpleRes) </span></code></pre></div>
<pre><code>## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>dfRessimple <span class="ot">&lt;-</span> <span class="fu">ldply</span>(runsRessimple, data.frame)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(dfRessimple[,<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 998</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>FinResS <span class="ot">&lt;-</span> <span class="fu">HPDinterval</span>(<span class="fu">as.mcmc</span>(dfRessimple))</span></code></pre></div>
</div>
</div>
</div>
<div id="frs" class="section level2">
<h2>FRS</h2>
<p>Residuals between NIR ~ VIS corrected by phylogeny. Extracted as
model$residuals</p>
<div id="full-model-3" class="section level3">
<h3>Full model</h3>
<div id="mcc-tree-7" class="section level4">
<h4>MCC Tree</h4>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>pglsmodFRS <span class="ot">&lt;-</span> <span class="fu">pgls</span>(FRS <span class="sc">~</span> PC1 <span class="sc">+</span> PC2 <span class="sc">+</span> size <span class="sc">+</span> PC1<span class="sc">*</span>size <span class="sc">+</span> PC2<span class="sc">*</span>size,</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> comp_data, <span class="at">param.CI =</span> <span class="fl">0.95</span>, <span class="at">lambda =</span> <span class="st">&quot;ML&quot;</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>FinMccFRSc <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">round</span>(<span class="fu">summary</span>(pglsmodFRS)<span class="sc">$</span>coefficients[,<span class="dv">1</span>],<span class="dv">3</span>)) </span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>FinMccFRSp <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">round</span>(<span class="fu">summary</span>(pglsmodFRS)<span class="sc">$</span>coefficients[,<span class="dv">4</span>],<span class="dv">3</span>))</span></code></pre></div>
</div>
<div id="multiple-trees-7" class="section level4">
<h4>multiple trees</h4>
<p>(i.e. Residuals between NIR ~ VIS corrected by phylogeny)</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>runsFRS<span class="ot">&lt;-</span><span class="fu">lapply</span>(trees[trees_subset_min<span class="sc">:</span>trees_subset_max],</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>                pgls_runC,</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">model=</span>MuPGLSMod2,</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">dataset=</span>FRSDataSet) </span></code></pre></div>
<pre><code>## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>dfFRS <span class="ot">&lt;-</span> <span class="fu">ldply</span> (runsFRS, data.frame)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(dfFRS[,<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 994</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(dfFRS, here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;Data/FromCode/MuTPglsResultsFRS_QC.csv&quot;</span>))</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>FinFRSM <span class="ot">&lt;-</span> <span class="fu">HPDinterval</span>(<span class="fu">as.mcmc</span>(dfFRS))</span></code></pre></div>
</div>
</div>
<div id="simple-model-3" class="section level3">
<h3>Simple model</h3>
<div id="mcc-tree-8" class="section level4">
<h4>MCC Tree</h4>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>spglsmodFRS <span class="ot">&lt;-</span> <span class="fu">pgls</span>(FRS <span class="sc">~</span> PC2 <span class="sc">+</span> size <span class="sc">+</span> PC2<span class="sc">*</span>size,</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> comp_data, <span class="at">param.CI =</span> <span class="fl">0.95</span>, <span class="at">lambda =</span> <span class="st">&quot;ML&quot;</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>sFinMccFRSc <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">round</span>(<span class="fu">summary</span>(spglsmodFRS)<span class="sc">$</span>coefficients[,<span class="dv">1</span>],<span class="dv">3</span>)) </span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>sFinMccFRSp <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">round</span>(<span class="fu">summary</span>(spglsmodFRS)<span class="sc">$</span>coefficients[,<span class="dv">4</span>],<span class="dv">3</span>))</span></code></pre></div>
</div>
<div id="multiple-trees-8" class="section level4">
<h4>multiple trees</h4>
<p>First step is to modify the data frame.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>SimpleFRS <span class="ot">&lt;-</span> </span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  FRSDataSet <span class="sc">%&gt;%</span> </span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(phylogeny_name, Response, size, PC2) <span class="sc">%&gt;%</span> </span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">PC =</span> PC2)</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>SimpleFRS <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(SimpleFRS)</span></code></pre></div>
<p>Now run the model</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>runsFRSsimple<span class="ot">&lt;-</span><span class="fu">lapply</span>(trees[trees_subset_min<span class="sc">:</span>trees_subset_max],</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>                      pgls_runE,</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">model=</span>MuPGLSMod4,</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">dataset=</span>SimpleFRS) </span></code></pre></div>
<pre><code>## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH 
## ERROR : Problem with optim:52ERROR: ABNORMAL_TERMINATION_IN_LNSRCH</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>dfFRSsimple <span class="ot">&lt;-</span> <span class="fu">ldply</span> (runsFRSsimple, data.frame)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(dfFRSsimple[,<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 995</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>FinFRSS <span class="ot">&lt;-</span><span class="fu">HPDinterval</span>(<span class="fu">as.mcmc</span>(dfFRSsimple))</span></code></pre></div>
</div>
</div>
</div>
<div id="prs" class="section level2">
<h2>PRS</h2>
<p>Residuals between NIR ~ VIS corrected by phylogeny. Phylogenetic
signal eliminated by the PGLS correction. Extracted as model$phyres.</p>
<div id="full-model-4" class="section level3">
<h3>Full model</h3>
<div id="mcc-tree-9" class="section level4">
<h4>MCC Tree</h4>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>pglsmodPRS <span class="ot">&lt;-</span> <span class="fu">pgls</span>(FRS2 <span class="sc">~</span> PC1 <span class="sc">+</span> PC2 <span class="sc">+</span> size <span class="sc">+</span> PC1<span class="sc">*</span>size <span class="sc">+</span> PC2<span class="sc">*</span>size,</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> comp_data, <span class="at">param.CI =</span> <span class="fl">0.95</span>, <span class="at">lambda =</span> <span class="st">&quot;ML&quot;</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>FinMccPRSc <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">round</span>(<span class="fu">summary</span>(pglsmodPRS)<span class="sc">$</span>coefficients[,<span class="dv">1</span>],<span class="dv">3</span>)) </span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>FinMccPRSp <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">round</span>(<span class="fu">summary</span>(pglsmodPRS)<span class="sc">$</span>coefficients[,<span class="dv">4</span>],<span class="dv">3</span>))</span></code></pre></div>
</div>
<div id="multiple-trees-9" class="section level4">
<h4>multiple trees</h4>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>runsPRS<span class="ot">&lt;-</span><span class="fu">lapply</span>(trees[trees_subset_min<span class="sc">:</span>trees_subset_max],</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>                pgls_runC,</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">model=</span>MuPGLSMod2,</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">dataset=</span>PRSDataSet) </span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>dfPRS <span class="ot">&lt;-</span> <span class="fu">ldply</span> (runsPRS, data.frame)</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(dfPRS[,<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 1001</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(dfPRS, here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;Data/FromCode/MuTPglsResultsFRS_QC.csv&quot;</span>))</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>FinPRSM <span class="ot">&lt;-</span> <span class="fu">HPDinterval</span>(<span class="fu">as.mcmc</span>(dfPRS))</span></code></pre></div>
</div>
</div>
<div id="simple-model-4" class="section level3">
<h3>Simple model</h3>
<div id="mcc-tree-10" class="section level4">
<h4>MCC Tree</h4>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>spglsmodPRS <span class="ot">&lt;-</span> <span class="fu">pgls</span>(FRS2 <span class="sc">~</span> PC2 <span class="sc">+</span> size <span class="sc">+</span> PC2<span class="sc">*</span>size,</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> comp_data, <span class="at">param.CI =</span> <span class="fl">0.95</span>, <span class="at">lambda =</span> <span class="st">&quot;ML&quot;</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>sFinMccPRSc <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">round</span>(<span class="fu">summary</span>(spglsmodPRS)<span class="sc">$</span>coefficients[,<span class="dv">1</span>],<span class="dv">3</span>)) </span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>sFinMccPRSp <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">round</span>(<span class="fu">summary</span>(spglsmodPRS)<span class="sc">$</span>coefficients[,<span class="dv">4</span>],<span class="dv">3</span>))</span></code></pre></div>
</div>
<div id="multiple-trees-10" class="section level4">
<h4>multiple trees</h4>
<p>First step is to modify the data frame.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>SimplePRS <span class="ot">&lt;-</span> </span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>  PRSDataSet <span class="sc">%&gt;%</span> </span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(phylogeny_name, Response, size, PC2) <span class="sc">%&gt;%</span> </span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">PC =</span> PC2)</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>SimplePRS <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(SimplePRS)</span></code></pre></div>
<p>Now run the model</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>runsPRSsimple<span class="ot">&lt;-</span><span class="fu">lapply</span>(trees[trees_subset_min<span class="sc">:</span>trees_subset_max],</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>                      pgls_runE,</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">model=</span>MuPGLSMod4,</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">dataset=</span>SimplePRS) </span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>dfPRSsimple <span class="ot">&lt;-</span> <span class="fu">ldply</span> (runsPRSsimple, data.frame)</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(dfPRSsimple[,<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 1001</code></pre>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>FinPRSS <span class="ot">&lt;-</span><span class="fu">HPDinterval</span>(<span class="fu">as.mcmc</span>(dfPRSsimple))</span></code></pre></div>
</div>
</div>
</div>
</div>
<div id="final-results" class="section level1">
<h1>Final results</h1>
<div id="full-models" class="section level2">
<h2>Full models</h2>
<div id="mcc-tree-11" class="section level3">
<h3>MCC Tree</h3>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>Predictor <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;PC1&quot;</span>,<span class="st">&quot;PC1 p-val&quot;</span> , </span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;PC2&quot;</span>, <span class="st">&quot;PC2 p-val&quot;</span>, </span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;Size&quot;</span>, <span class="st">&quot;Size p-val&quot;</span>,</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;VIS&quot;</span>, <span class="st">&quot;VIS p-val&quot;</span>,</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;PC1:size&quot;</span>, <span class="st">&quot;PC1:size p-val&quot;</span>, </span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;PC2:size&quot;</span>, <span class="st">&quot;PC2:size p-val&quot;</span>)</span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Arrange the vectors to build the data frame</span></span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a><span class="co"># New vectors alternate coefficient and p-values to match &quot;predictors&quot;</span></span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a>Toti <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rbind</span>((<span class="fu">c</span>(</span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a>            FinMccTotc[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>],<span class="st">&quot;NA&quot;</span>,FinMccTotc[<span class="dv">5</span><span class="sc">:</span><span class="dv">6</span>])),</span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a>                (<span class="fu">c</span>(FinMccTotp[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>],<span class="st">&quot;NA&quot;</span>,FinMccTotp[<span class="dv">5</span><span class="sc">:</span><span class="dv">6</span>]))))))</span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a>Visi <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rbind</span>((<span class="fu">c</span>(</span>
<span id="cb86-16"><a href="#cb86-16" aria-hidden="true" tabindex="-1"></a>            FinMccVisc[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>],<span class="st">&quot;NA&quot;</span>,FinMccVisc[<span class="dv">5</span><span class="sc">:</span><span class="dv">6</span>])),</span>
<span id="cb86-17"><a href="#cb86-17" aria-hidden="true" tabindex="-1"></a>                (<span class="fu">c</span>(FinMccVisp[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>],<span class="st">&quot;NA&quot;</span>,FinMccVisp[<span class="dv">5</span><span class="sc">:</span><span class="dv">6</span>]))))))</span>
<span id="cb86-18"><a href="#cb86-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-19"><a href="#cb86-19" aria-hidden="true" tabindex="-1"></a>Niri <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rbind</span>(</span>
<span id="cb86-20"><a href="#cb86-20" aria-hidden="true" tabindex="-1"></a>            FinMccNirc[<span class="dv">2</span><span class="sc">:</span><span class="dv">7</span>], FinMccNirp[<span class="dv">2</span><span class="sc">:</span><span class="dv">7</span>]))))</span>
<span id="cb86-21"><a href="#cb86-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-22"><a href="#cb86-22" aria-hidden="true" tabindex="-1"></a>FRSi <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rbind</span>((<span class="fu">c</span>(</span>
<span id="cb86-23"><a href="#cb86-23" aria-hidden="true" tabindex="-1"></a>            FinMccFRSc[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>],<span class="st">&quot;NA&quot;</span>,FinMccFRSc[<span class="dv">5</span><span class="sc">:</span><span class="dv">6</span>])),</span>
<span id="cb86-24"><a href="#cb86-24" aria-hidden="true" tabindex="-1"></a>                (<span class="fu">c</span>(FinMccFRSp[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>],<span class="st">&quot;NA&quot;</span>,FinMccFRSp[<span class="dv">5</span><span class="sc">:</span><span class="dv">6</span>]))))))</span>
<span id="cb86-25"><a href="#cb86-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-26"><a href="#cb86-26" aria-hidden="true" tabindex="-1"></a>PRSi <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rbind</span>((<span class="fu">c</span>(</span>
<span id="cb86-27"><a href="#cb86-27" aria-hidden="true" tabindex="-1"></a>            FinMccPRSc[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>],<span class="st">&quot;NA&quot;</span>,FinMccPRSc[<span class="dv">5</span><span class="sc">:</span><span class="dv">6</span>])),</span>
<span id="cb86-28"><a href="#cb86-28" aria-hidden="true" tabindex="-1"></a>                (<span class="fu">c</span>(FinMccPRSp[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>],<span class="st">&quot;NA&quot;</span>,FinMccPRSp[<span class="dv">5</span><span class="sc">:</span><span class="dv">6</span>]))))))</span>
<span id="cb86-29"><a href="#cb86-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb86-30"><a href="#cb86-30" aria-hidden="true" tabindex="-1"></a><span class="co"># This section colours the signifficant p-values and their coefficients</span></span>
<span id="cb86-31"><a href="#cb86-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-32"><a href="#cb86-32" aria-hidden="true" tabindex="-1"></a>Visi[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(Visi[<span class="dv">1</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb86-33"><a href="#cb86-33" aria-hidden="true" tabindex="-1"></a>Visi[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(Visi[<span class="dv">2</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb86-34"><a href="#cb86-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-35"><a href="#cb86-35" aria-hidden="true" tabindex="-1"></a>Visi[<span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(Visi[<span class="dv">5</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb86-36"><a href="#cb86-36" aria-hidden="true" tabindex="-1"></a>Visi[<span class="dv">6</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(Visi[<span class="dv">6</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb86-37"><a href="#cb86-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-38"><a href="#cb86-38" aria-hidden="true" tabindex="-1"></a>Visi[<span class="dv">9</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(Visi[<span class="dv">9</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb86-39"><a href="#cb86-39" aria-hidden="true" tabindex="-1"></a>Visi[<span class="dv">10</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(Visi[<span class="dv">10</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb86-40"><a href="#cb86-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-41"><a href="#cb86-41" aria-hidden="true" tabindex="-1"></a>Niri[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(Niri[<span class="dv">3</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb86-42"><a href="#cb86-42" aria-hidden="true" tabindex="-1"></a>Niri[<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(Niri[<span class="dv">4</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb86-43"><a href="#cb86-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-44"><a href="#cb86-44" aria-hidden="true" tabindex="-1"></a>Niri[<span class="dv">7</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(Niri[<span class="dv">7</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb86-45"><a href="#cb86-45" aria-hidden="true" tabindex="-1"></a>Niri[<span class="dv">8</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(Niri[<span class="dv">8</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb86-46"><a href="#cb86-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-47"><a href="#cb86-47" aria-hidden="true" tabindex="-1"></a>Niri[<span class="dv">11</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(Niri[<span class="dv">11</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb86-48"><a href="#cb86-48" aria-hidden="true" tabindex="-1"></a>Niri[<span class="dv">12</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(Niri[<span class="dv">12</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb86-49"><a href="#cb86-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-50"><a href="#cb86-50" aria-hidden="true" tabindex="-1"></a>FRSi[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(FRSi[<span class="dv">3</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb86-51"><a href="#cb86-51" aria-hidden="true" tabindex="-1"></a>FRSi[<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(FRSi[<span class="dv">4</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb86-52"><a href="#cb86-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-53"><a href="#cb86-53" aria-hidden="true" tabindex="-1"></a>FRSi[<span class="dv">11</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(FRSi[<span class="dv">11</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb86-54"><a href="#cb86-54" aria-hidden="true" tabindex="-1"></a>FRSi[<span class="dv">12</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(FRSi[<span class="dv">12</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb86-55"><a href="#cb86-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-56"><a href="#cb86-56" aria-hidden="true" tabindex="-1"></a><span class="co"># Assemble the table</span></span>
<span id="cb86-57"><a href="#cb86-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-58"><a href="#cb86-58" aria-hidden="true" tabindex="-1"></a>Resultspgls <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Predictor,  </span>
<span id="cb86-59"><a href="#cb86-59" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;TOT&quot;</span> <span class="ot">=</span> Toti,</span>
<span id="cb86-60"><a href="#cb86-60" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;VIS&quot;</span> <span class="ot">=</span> Visi,</span>
<span id="cb86-61"><a href="#cb86-61" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;NIR&quot;</span> <span class="ot">=</span> Niri,</span>
<span id="cb86-62"><a href="#cb86-62" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;Res&quot;</span> <span class="ot">=</span> FRSi,</span>
<span id="cb86-63"><a href="#cb86-63" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;Phr&quot;</span> <span class="ot">=</span> PRSi) </span>
<span id="cb86-64"><a href="#cb86-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-65"><a href="#cb86-65" aria-hidden="true" tabindex="-1"></a>Resultspgls <span class="sc">%&gt;%</span> </span>
<span id="cb86-66"><a href="#cb86-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">align =</span><span class="st">&quot;c&quot;</span>, <span class="at">escape =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb86-67"><a href="#cb86-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb86-68"><a href="#cb86-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_indent</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">9</span>)) </span></code></pre></div>
<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
Predictor
</th>
<th style="text-align:center;">
TOT
</th>
<th style="text-align:center;">
VIS
</th>
<th style="text-align:center;">
NIR
</th>
<th style="text-align:center;">
Res
</th>
<th style="text-align:center;">
Phr
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;padding-left: 2em;" indentlevel="1">
PC1
</td>
<td style="text-align:center;">
-5.388
</td>
<td style="text-align:center;">
<span
style=" font-weight: bold;    color: #D40481 !important;">-5.952</span>
</td>
<td style="text-align:center;">
0.862
</td>
<td style="text-align:center;">
1.398
</td>
<td style="text-align:center;">
0.763
</td>
</tr>
<tr>
<td style="text-align:center;">
PC1 p-val
</td>
<td style="text-align:center;">
0.129
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    ">0.078</span>
</td>
<td style="text-align:center;">
0.753
</td>
<td style="text-align:center;">
0.594
</td>
<td style="text-align:center;">
0.666
</td>
</tr>
<tr>
<td style="text-align:center;padding-left: 2em;" indentlevel="1">
PC2
</td>
<td style="text-align:center;">
-5.777
</td>
<td style="text-align:center;">
-8.513
</td>
<td style="text-align:center;">
<span
style=" font-weight: bold;    color: #D40481 !important;">4.996</span>
</td>
<td style="text-align:center;">
<span
style=" font-weight: bold;    color: #D40481 !important;">5.801</span>
</td>
<td style="text-align:center;">
-0.739
</td>
</tr>
<tr>
<td style="text-align:center;">
PC2 p-val
</td>
<td style="text-align:center;">
0.205
</td>
<td style="text-align:center;">
0.052
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    ">0.177</span>
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    ">0.1</span>
</td>
<td style="text-align:center;">
0.741
</td>
</tr>
<tr>
<td style="text-align:center;padding-left: 2em;" indentlevel="1">
Size
</td>
<td style="text-align:center;">
8.54
</td>
<td style="text-align:center;">
<span
style=" font-weight: bold;    color: #D40481 !important;">7.883</span>
</td>
<td style="text-align:center;">
0.661
</td>
<td style="text-align:center;">
-0.088
</td>
<td style="text-align:center;">
1.114
</td>
</tr>
<tr>
<td style="text-align:center;">
Size p-val
</td>
<td style="text-align:center;">
0.019
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    ">0.021</span>
</td>
<td style="text-align:center;">
0.815
</td>
<td style="text-align:center;">
0.973
</td>
<td style="text-align:center;">
0.47
</td>
</tr>
<tr>
<td style="text-align:center;padding-left: 2em;" indentlevel="1">
VIS
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
<span
style=" font-weight: bold;    color: #D40481 !important;">0.969</span>
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
</tr>
<tr>
<td style="text-align:center;">
VIS p-val
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    ">0</span>
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
</tr>
<tr>
<td style="text-align:center;padding-left: 2em;" indentlevel="1">
PC1:size
</td>
<td style="text-align:center;">
2.56
</td>
<td style="text-align:center;">
<span
style=" font-weight: bold;    color: #D40481 !important;">2.646</span>
</td>
<td style="text-align:center;">
-0.136
</td>
<td style="text-align:center;">
-0.38
</td>
<td style="text-align:center;">
-0.452
</td>
</tr>
<tr>
<td style="text-align:center;">
PC1:size p-val
</td>
<td style="text-align:center;">
0.091
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    ">0.066</span>
</td>
<td style="text-align:center;">
0.908
</td>
<td style="text-align:center;">
0.735
</td>
<td style="text-align:center;">
0.552
</td>
</tr>
<tr>
<td style="text-align:center;">
PC2:size
</td>
<td style="text-align:center;">
2.087
</td>
<td style="text-align:center;">
3.175
</td>
<td style="text-align:center;">
<span
style=" font-weight: bold;    color: #D40481 !important;">-2.05</span>
</td>
<td style="text-align:center;">
<span
style=" font-weight: bold;    color: #D40481 !important;">-2.355</span>
</td>
<td style="text-align:center;">
0.393
</td>
</tr>
<tr>
<td style="text-align:center;">
PC2:size p-val
</td>
<td style="text-align:center;">
0.247
</td>
<td style="text-align:center;">
0.067
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    ">0.163</span>
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    ">0.094</span>
</td>
<td style="text-align:center;">
0.66
</td>
</tr>
</tbody>
</table>
</div>
<div id="multiple-trees-11" class="section level3">
<h3>multiple trees</h3>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>rvTOTl <span class="ot">&lt;-</span> <span class="fu">as.character</span>(</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="fu">c</span>(</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>              FinTotM[<span class="dv">1</span>,<span class="dv">1</span>],FinTotM[<span class="dv">3</span>,<span class="dv">1</span>],FinTotM[<span class="dv">4</span>,<span class="dv">1</span>],FinTotM[<span class="dv">6</span>,<span class="dv">1</span>],</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>              FinTotM[<span class="dv">7</span>,<span class="dv">1</span>],FinTotM[<span class="dv">9</span>,<span class="dv">1</span>],<span class="st">&quot;NA&quot;</span>,<span class="st">&quot;NA&quot;</span>,</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>              FinTotM[<span class="dv">10</span>,<span class="dv">1</span>],FinTotM[<span class="dv">12</span>,<span class="dv">1</span>],</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>              FinTotM[<span class="dv">13</span>,<span class="dv">1</span>],FinTotM[<span class="dv">15</span>,<span class="dv">1</span>])),<span class="dv">3</span>))</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>rvTOTu <span class="ot">&lt;-</span> <span class="fu">as.character</span>(</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>            <span class="fu">format</span>(<span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="fu">c</span>(</span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>              FinTotM[<span class="dv">1</span>,<span class="dv">2</span>],FinTotM[<span class="dv">3</span>,<span class="dv">2</span>],FinTotM[<span class="dv">4</span>,<span class="dv">2</span>],FinTotM[<span class="dv">6</span>,<span class="dv">2</span>],</span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>              FinTotM[<span class="dv">7</span>,<span class="dv">2</span>],FinTotM[<span class="dv">9</span>,<span class="dv">2</span>],<span class="st">&quot;NA&quot;</span>,<span class="st">&quot;NA&quot;</span>,</span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>              FinTotM[<span class="dv">10</span>,<span class="dv">2</span>],FinTotM[<span class="dv">12</span>,<span class="dv">2</span>],</span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>              FinTotM[<span class="dv">13</span>,<span class="dv">2</span>],FinTotM[<span class="dv">15</span>,<span class="dv">2</span>])),<span class="dv">3</span>),<span class="at">nsmall=</span><span class="dv">3</span>))</span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a>rvVISl <span class="ot">&lt;-</span> <span class="fu">as.character</span>(</span>
<span id="cb87-17"><a href="#cb87-17" aria-hidden="true" tabindex="-1"></a>          <span class="fu">format</span>(<span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="fu">c</span>(</span>
<span id="cb87-18"><a href="#cb87-18" aria-hidden="true" tabindex="-1"></a>              FinVisM[<span class="dv">1</span>,<span class="dv">1</span>],FinVisM[<span class="dv">3</span>,<span class="dv">1</span>],FinVisM[<span class="dv">4</span>,<span class="dv">1</span>],FinVisM[<span class="dv">6</span>,<span class="dv">1</span>],</span>
<span id="cb87-19"><a href="#cb87-19" aria-hidden="true" tabindex="-1"></a>              FinVisM[<span class="dv">7</span>,<span class="dv">1</span>],FinVisM[<span class="dv">9</span>,<span class="dv">1</span>],<span class="st">&quot;NA&quot;</span>,<span class="st">&quot;NA&quot;</span>,</span>
<span id="cb87-20"><a href="#cb87-20" aria-hidden="true" tabindex="-1"></a>              FinVisM[<span class="dv">10</span>,<span class="dv">1</span>],FinVisM[<span class="dv">12</span>,<span class="dv">1</span>],</span>
<span id="cb87-21"><a href="#cb87-21" aria-hidden="true" tabindex="-1"></a>              FinVisM[<span class="dv">13</span>,<span class="dv">1</span>],FinVisM[<span class="dv">15</span>,<span class="dv">1</span>])),<span class="dv">3</span>),<span class="at">nsmall=</span><span class="dv">3</span>))</span>
<span id="cb87-22"><a href="#cb87-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-23"><a href="#cb87-23" aria-hidden="true" tabindex="-1"></a>rvVISu <span class="ot">&lt;-</span> <span class="fu">as.character</span>(</span>
<span id="cb87-24"><a href="#cb87-24" aria-hidden="true" tabindex="-1"></a>            <span class="fu">format</span>(<span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="fu">c</span>(</span>
<span id="cb87-25"><a href="#cb87-25" aria-hidden="true" tabindex="-1"></a>              FinVisM[<span class="dv">1</span>,<span class="dv">2</span>],FinVisM[<span class="dv">3</span>,<span class="dv">2</span>],FinVisM[<span class="dv">4</span>,<span class="dv">2</span>],FinVisM[<span class="dv">6</span>,<span class="dv">2</span>],</span>
<span id="cb87-26"><a href="#cb87-26" aria-hidden="true" tabindex="-1"></a>              FinVisM[<span class="dv">7</span>,<span class="dv">2</span>],FinVisM[<span class="dv">9</span>,<span class="dv">2</span>],<span class="st">&quot;NA&quot;</span>,<span class="st">&quot;NA&quot;</span>,</span>
<span id="cb87-27"><a href="#cb87-27" aria-hidden="true" tabindex="-1"></a>              FinVisM[<span class="dv">10</span>,<span class="dv">2</span>],FinVisM[<span class="dv">12</span>,<span class="dv">2</span>],</span>
<span id="cb87-28"><a href="#cb87-28" aria-hidden="true" tabindex="-1"></a>              FinVisM[<span class="dv">13</span>,<span class="dv">2</span>],FinVisM[<span class="dv">15</span>,<span class="dv">2</span>])),<span class="dv">3</span>),<span class="at">nsmall=</span><span class="dv">3</span>))</span>
<span id="cb87-29"><a href="#cb87-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-30"><a href="#cb87-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-31"><a href="#cb87-31" aria-hidden="true" tabindex="-1"></a>rvNIRl <span class="ot">&lt;-</span> <span class="fu">as.character</span>(</span>
<span id="cb87-32"><a href="#cb87-32" aria-hidden="true" tabindex="-1"></a>            <span class="fu">format</span>(<span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="fu">c</span>(</span>
<span id="cb87-33"><a href="#cb87-33" aria-hidden="true" tabindex="-1"></a>              FinNirM[<span class="dv">1</span>,<span class="dv">1</span>],FinNirM[<span class="dv">3</span>,<span class="dv">1</span>],FinNirM[<span class="dv">4</span>,<span class="dv">1</span>],FinNirM[<span class="dv">6</span>,<span class="dv">1</span>],</span>
<span id="cb87-34"><a href="#cb87-34" aria-hidden="true" tabindex="-1"></a>              FinNirM[<span class="dv">7</span>,<span class="dv">1</span>],FinNirM[<span class="dv">9</span>,<span class="dv">1</span>],FinNirM[<span class="dv">10</span>,<span class="dv">1</span>],FinNirM[<span class="dv">12</span>,<span class="dv">1</span>],</span>
<span id="cb87-35"><a href="#cb87-35" aria-hidden="true" tabindex="-1"></a>              FinNirM[<span class="dv">13</span>,<span class="dv">1</span>],FinNirM[<span class="dv">15</span>,<span class="dv">1</span>], FinNirM[<span class="dv">16</span>,<span class="dv">1</span>],FinNirM[<span class="dv">18</span>,<span class="dv">1</span>]</span>
<span id="cb87-36"><a href="#cb87-36" aria-hidden="true" tabindex="-1"></a>              )),<span class="dv">3</span>),<span class="at">nsmall=</span><span class="dv">3</span>))</span>
<span id="cb87-37"><a href="#cb87-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-38"><a href="#cb87-38" aria-hidden="true" tabindex="-1"></a>rvNIRu <span class="ot">&lt;-</span> <span class="fu">as.character</span>(</span>
<span id="cb87-39"><a href="#cb87-39" aria-hidden="true" tabindex="-1"></a>           <span class="fu">format</span>(<span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="fu">c</span>(</span>
<span id="cb87-40"><a href="#cb87-40" aria-hidden="true" tabindex="-1"></a>              FinNirM[<span class="dv">1</span>,<span class="dv">2</span>],FinNirM[<span class="dv">3</span>,<span class="dv">2</span>],FinNirM[<span class="dv">4</span>,<span class="dv">2</span>],FinNirM[<span class="dv">6</span>,<span class="dv">2</span>],</span>
<span id="cb87-41"><a href="#cb87-41" aria-hidden="true" tabindex="-1"></a>              FinNirM[<span class="dv">7</span>,<span class="dv">2</span>],FinNirM[<span class="dv">9</span>,<span class="dv">2</span>],FinNirM[<span class="dv">10</span>,<span class="dv">2</span>],FinNirM[<span class="dv">12</span>,<span class="dv">2</span>],</span>
<span id="cb87-42"><a href="#cb87-42" aria-hidden="true" tabindex="-1"></a>              FinNirM[<span class="dv">13</span>,<span class="dv">2</span>],FinNirM[<span class="dv">15</span>,<span class="dv">2</span>], FinNirM[<span class="dv">16</span>,<span class="dv">2</span>],FinNirM[<span class="dv">18</span>,<span class="dv">2</span>]</span>
<span id="cb87-43"><a href="#cb87-43" aria-hidden="true" tabindex="-1"></a>              )),<span class="dv">3</span>),<span class="at">nsmall=</span><span class="dv">3</span>))</span>
<span id="cb87-44"><a href="#cb87-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-45"><a href="#cb87-45" aria-hidden="true" tabindex="-1"></a>rvFRSl <span class="ot">&lt;-</span> <span class="fu">as.character</span>(</span>
<span id="cb87-46"><a href="#cb87-46" aria-hidden="true" tabindex="-1"></a>            <span class="fu">format</span>(<span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="fu">c</span>(</span>
<span id="cb87-47"><a href="#cb87-47" aria-hidden="true" tabindex="-1"></a>              FinFRSM[<span class="dv">1</span>,<span class="dv">1</span>],FinFRSM[<span class="dv">3</span>,<span class="dv">1</span>],FinFRSM[<span class="dv">4</span>,<span class="dv">1</span>],FinFRSM[<span class="dv">6</span>,<span class="dv">1</span>],</span>
<span id="cb87-48"><a href="#cb87-48" aria-hidden="true" tabindex="-1"></a>              FinFRSM[<span class="dv">7</span>,<span class="dv">1</span>],FinFRSM[<span class="dv">9</span>,<span class="dv">1</span>],<span class="st">&quot;NA&quot;</span>,<span class="st">&quot;NA&quot;</span>,</span>
<span id="cb87-49"><a href="#cb87-49" aria-hidden="true" tabindex="-1"></a>              FinFRSM[<span class="dv">10</span>,<span class="dv">1</span>],FinFRSM[<span class="dv">12</span>,<span class="dv">1</span>],</span>
<span id="cb87-50"><a href="#cb87-50" aria-hidden="true" tabindex="-1"></a>              FinFRSM[<span class="dv">13</span>,<span class="dv">1</span>],FinFRSM[<span class="dv">15</span>,<span class="dv">1</span>])),<span class="dv">3</span>),<span class="at">nsmall=</span><span class="dv">3</span>))</span>
<span id="cb87-51"><a href="#cb87-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-52"><a href="#cb87-52" aria-hidden="true" tabindex="-1"></a>rvFRSu <span class="ot">&lt;-</span> <span class="fu">as.character</span>(</span>
<span id="cb87-53"><a href="#cb87-53" aria-hidden="true" tabindex="-1"></a>            <span class="fu">format</span>(<span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="fu">c</span>(</span>
<span id="cb87-54"><a href="#cb87-54" aria-hidden="true" tabindex="-1"></a>              FinFRSM[<span class="dv">1</span>,<span class="dv">2</span>],FinFRSM[<span class="dv">3</span>,<span class="dv">2</span>],FinFRSM[<span class="dv">4</span>,<span class="dv">2</span>],FinFRSM[<span class="dv">6</span>,<span class="dv">2</span>],</span>
<span id="cb87-55"><a href="#cb87-55" aria-hidden="true" tabindex="-1"></a>              FinFRSM[<span class="dv">7</span>,<span class="dv">2</span>],FinFRSM[<span class="dv">9</span>,<span class="dv">2</span>],<span class="st">&quot;NA&quot;</span>,<span class="st">&quot;NA&quot;</span>,</span>
<span id="cb87-56"><a href="#cb87-56" aria-hidden="true" tabindex="-1"></a>              FinFRSM[<span class="dv">10</span>,<span class="dv">2</span>],FinFRSM[<span class="dv">12</span>,<span class="dv">2</span>],</span>
<span id="cb87-57"><a href="#cb87-57" aria-hidden="true" tabindex="-1"></a>              FinFRSM[<span class="dv">13</span>,<span class="dv">2</span>],FinFRSM[<span class="dv">15</span>,<span class="dv">2</span>])),<span class="dv">3</span>),<span class="at">nsmall=</span><span class="dv">3</span>))</span>
<span id="cb87-58"><a href="#cb87-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-59"><a href="#cb87-59" aria-hidden="true" tabindex="-1"></a>rvPRSl <span class="ot">&lt;-</span> <span class="fu">as.character</span>(</span>
<span id="cb87-60"><a href="#cb87-60" aria-hidden="true" tabindex="-1"></a>            <span class="fu">format</span>(<span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="fu">c</span>(</span>
<span id="cb87-61"><a href="#cb87-61" aria-hidden="true" tabindex="-1"></a>              FinPRSM[<span class="dv">1</span>,<span class="dv">1</span>],FinPRSM[<span class="dv">3</span>,<span class="dv">1</span>],FinPRSM[<span class="dv">4</span>,<span class="dv">1</span>],FinPRSM[<span class="dv">6</span>,<span class="dv">1</span>],</span>
<span id="cb87-62"><a href="#cb87-62" aria-hidden="true" tabindex="-1"></a>              FinPRSM[<span class="dv">7</span>,<span class="dv">1</span>],FinPRSM[<span class="dv">9</span>,<span class="dv">1</span>],<span class="st">&quot;NA&quot;</span>,<span class="st">&quot;NA&quot;</span>,</span>
<span id="cb87-63"><a href="#cb87-63" aria-hidden="true" tabindex="-1"></a>              FinPRSM[<span class="dv">10</span>,<span class="dv">1</span>],FinPRSM[<span class="dv">12</span>,<span class="dv">1</span>],</span>
<span id="cb87-64"><a href="#cb87-64" aria-hidden="true" tabindex="-1"></a>              FinPRSM[<span class="dv">13</span>,<span class="dv">1</span>],FinPRSM[<span class="dv">15</span>,<span class="dv">1</span>])),<span class="dv">3</span>),<span class="at">nsmall=</span><span class="dv">3</span>))</span>
<span id="cb87-65"><a href="#cb87-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-66"><a href="#cb87-66" aria-hidden="true" tabindex="-1"></a>rvPRSu <span class="ot">&lt;-</span> <span class="fu">as.character</span>(</span>
<span id="cb87-67"><a href="#cb87-67" aria-hidden="true" tabindex="-1"></a>            <span class="fu">format</span>(<span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="fu">c</span>(</span>
<span id="cb87-68"><a href="#cb87-68" aria-hidden="true" tabindex="-1"></a>              FinPRSM[<span class="dv">1</span>,<span class="dv">2</span>],FinPRSM[<span class="dv">3</span>,<span class="dv">2</span>],FinPRSM[<span class="dv">4</span>,<span class="dv">2</span>],FinPRSM[<span class="dv">6</span>,<span class="dv">2</span>],</span>
<span id="cb87-69"><a href="#cb87-69" aria-hidden="true" tabindex="-1"></a>              FinPRSM[<span class="dv">7</span>,<span class="dv">2</span>],FinPRSM[<span class="dv">9</span>,<span class="dv">2</span>],<span class="st">&quot;NA&quot;</span>,<span class="st">&quot;NA&quot;</span>,</span>
<span id="cb87-70"><a href="#cb87-70" aria-hidden="true" tabindex="-1"></a>              FinPRSM[<span class="dv">10</span>,<span class="dv">2</span>],FinPRSM[<span class="dv">12</span>,<span class="dv">2</span>],</span>
<span id="cb87-71"><a href="#cb87-71" aria-hidden="true" tabindex="-1"></a>              FinPRSM[<span class="dv">13</span>,<span class="dv">2</span>],FinPRSM[<span class="dv">15</span>,<span class="dv">2</span>])),<span class="dv">3</span>),<span class="at">nsmall=</span><span class="dv">3</span>))</span>
<span id="cb87-72"><a href="#cb87-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-73"><a href="#cb87-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-74"><a href="#cb87-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-75"><a href="#cb87-75" aria-hidden="true" tabindex="-1"></a>rvTOTi<span class="ot">&lt;-</span><span class="fu">paste</span>(rvTOTl,rvTOTu, <span class="at">sep =</span> <span class="st">&quot; ; &quot;</span>)</span>
<span id="cb87-76"><a href="#cb87-76" aria-hidden="true" tabindex="-1"></a>rvVISi<span class="ot">&lt;-</span><span class="fu">paste</span>(rvVISl,rvVISu, <span class="at">sep =</span> <span class="st">&quot; ; &quot;</span>)</span>
<span id="cb87-77"><a href="#cb87-77" aria-hidden="true" tabindex="-1"></a>rvNIRi<span class="ot">&lt;-</span><span class="fu">paste</span>(rvNIRl,rvNIRu, <span class="at">sep =</span> <span class="st">&quot; ; &quot;</span>)</span>
<span id="cb87-78"><a href="#cb87-78" aria-hidden="true" tabindex="-1"></a>rvFRSi<span class="ot">&lt;-</span><span class="fu">paste</span>(rvFRSl,rvFRSu, <span class="at">sep =</span> <span class="st">&quot; ; &quot;</span>)</span>
<span id="cb87-79"><a href="#cb87-79" aria-hidden="true" tabindex="-1"></a>rvPRSi<span class="ot">&lt;-</span><span class="fu">paste</span>(rvPRSl,rvPRSu, <span class="at">sep =</span> <span class="st">&quot; ; &quot;</span>)</span>
<span id="cb87-80"><a href="#cb87-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-81"><a href="#cb87-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-82"><a href="#cb87-82" aria-hidden="true" tabindex="-1"></a>rvVISi[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(rvVISi[<span class="dv">1</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#367D91&quot;</span>)</span>
<span id="cb87-83"><a href="#cb87-83" aria-hidden="true" tabindex="-1"></a>rvVISi[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(rvVISi[<span class="dv">2</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#B2B9BF&quot;</span>)</span>
<span id="cb87-84"><a href="#cb87-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-85"><a href="#cb87-85" aria-hidden="true" tabindex="-1"></a>rvVISi[<span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(rvVISi[<span class="dv">5</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb87-86"><a href="#cb87-86" aria-hidden="true" tabindex="-1"></a>rvVISi[<span class="dv">6</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(rvVISi[<span class="dv">6</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb87-87"><a href="#cb87-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-88"><a href="#cb87-88" aria-hidden="true" tabindex="-1"></a>rvVISi[<span class="dv">9</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(rvVISi[<span class="dv">9</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#367D91&quot;</span>)</span>
<span id="cb87-89"><a href="#cb87-89" aria-hidden="true" tabindex="-1"></a>rvVISi[<span class="dv">10</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(rvVISi[<span class="dv">10</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>,  <span class="at">color=</span><span class="st">&quot;#B2B9BF&quot;</span>)</span>
<span id="cb87-90"><a href="#cb87-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-91"><a href="#cb87-91" aria-hidden="true" tabindex="-1"></a>rvNIRi[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(rvNIRi[<span class="dv">3</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb87-92"><a href="#cb87-92" aria-hidden="true" tabindex="-1"></a>rvNIRi[<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(rvNIRi[<span class="dv">4</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb87-93"><a href="#cb87-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-94"><a href="#cb87-94" aria-hidden="true" tabindex="-1"></a>rvNIRi[<span class="dv">7</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(rvNIRi[<span class="dv">7</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb87-95"><a href="#cb87-95" aria-hidden="true" tabindex="-1"></a>rvNIRi[<span class="dv">8</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(rvNIRi[<span class="dv">8</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb87-96"><a href="#cb87-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-97"><a href="#cb87-97" aria-hidden="true" tabindex="-1"></a>rvNIRi[<span class="dv">11</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(rvNIRi[<span class="dv">11</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb87-98"><a href="#cb87-98" aria-hidden="true" tabindex="-1"></a>rvNIRi[<span class="dv">12</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(rvNIRi[<span class="dv">12</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb87-99"><a href="#cb87-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-100"><a href="#cb87-100" aria-hidden="true" tabindex="-1"></a>rvFRSi[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(rvFRSi[<span class="dv">3</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb87-101"><a href="#cb87-101" aria-hidden="true" tabindex="-1"></a>rvFRSi[<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(rvFRSi[<span class="dv">4</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb87-102"><a href="#cb87-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-103"><a href="#cb87-103" aria-hidden="true" tabindex="-1"></a>rvFRSi[<span class="dv">11</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(rvFRSi[<span class="dv">11</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb87-104"><a href="#cb87-104" aria-hidden="true" tabindex="-1"></a>rvFRSi[<span class="dv">12</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(rvFRSi[<span class="dv">12</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb87-105"><a href="#cb87-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-106"><a href="#cb87-106" aria-hidden="true" tabindex="-1"></a>Resultspgls <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Predictor,  </span>
<span id="cb87-107"><a href="#cb87-107" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;TOT&quot;</span> <span class="ot">=</span> rvTOTi,</span>
<span id="cb87-108"><a href="#cb87-108" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;VIS&quot;</span> <span class="ot">=</span> rvVISi,</span>
<span id="cb87-109"><a href="#cb87-109" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;NIR&quot;</span> <span class="ot">=</span> rvNIRi,</span>
<span id="cb87-110"><a href="#cb87-110" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;Res&quot;</span> <span class="ot">=</span> rvFRSi, </span>
<span id="cb87-111"><a href="#cb87-111" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;Phr&quot;</span> <span class="ot">=</span> rvPRSi) </span>
<span id="cb87-112"><a href="#cb87-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-113"><a href="#cb87-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-114"><a href="#cb87-114" aria-hidden="true" tabindex="-1"></a>Resultspgls <span class="sc">%&gt;%</span> </span>
<span id="cb87-115"><a href="#cb87-115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">align =</span><span class="st">&quot;c&quot;</span>, <span class="at">escape =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb87-116"><a href="#cb87-116" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb87-117"><a href="#cb87-117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_indent</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">9</span>)) </span></code></pre></div>
<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
Predictor
</th>
<th style="text-align:center;">
TOT
</th>
<th style="text-align:center;">
VIS
</th>
<th style="text-align:center;">
NIR
</th>
<th style="text-align:center;">
Res
</th>
<th style="text-align:center;">
Phr
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;padding-left: 2em;" indentlevel="1">
PC1
</td>
<td style="text-align:center;">
-7.049 ; -4.286
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    color: #367D91 !important;"> -7.468
; -4.959</span>
</td>
<td style="text-align:center;">
-0.170 ; 1.414
</td>
<td style="text-align:center;">
0.533 ; 1.986
</td>
<td style="text-align:center;">
0.763 ; 0.763
</td>
</tr>
<tr>
<td style="text-align:center;">
PC1 p-val
</td>
<td style="text-align:center;">
0.046 ; 0.196
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    color: #B2B9BF !important;"> 0.022 ;
0.118</span>
</td>
<td style="text-align:center;">
0.643 ; 0.993
</td>
<td style="text-align:center;">
0.445 ; 0.837
</td>
<td style="text-align:center;">
0.666 ; 0.666
</td>
</tr>
<tr>
<td style="text-align:center;padding-left: 2em;" indentlevel="1">
PC2
</td>
<td style="text-align:center;">
-7.907 ; -3.816
</td>
<td style="text-align:center;">
-10.130 ; -6.962
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    color: #D40481 !important;"> 2.799 ;
6.543</span>
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    color: #D40481 !important;"> 3.593 ;
7.236</span>
</td>
<td style="text-align:center;">
-0.739 ; -0.739
</td>
</tr>
<tr>
<td style="text-align:center;">
PC2 p-val
</td>
<td style="text-align:center;">
0.089 ; 0.346
</td>
<td style="text-align:center;">
0.018 ; 0.107
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    "> 0.042 ; 0.413</span>
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    "> 0.027 ; 0.282</span>
</td>
<td style="text-align:center;">
0.741 ; 0.741
</td>
</tr>
<tr>
<td style="text-align:center;padding-left: 2em;" indentlevel="1">
Size
</td>
<td style="text-align:center;">
7.466 ; 10.141
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    color: #D40481 !important;"> 6.860 ;
9.275</span>
</td>
<td style="text-align:center;">
-0.314 ; 2.034
</td>
<td style="text-align:center;">
-0.791 ; 1.097
</td>
<td style="text-align:center;">
1.114 ; 1.114
</td>
</tr>
<tr>
<td style="text-align:center;">
Size p-val
</td>
<td style="text-align:center;">
0.005 ; 0.040
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    "> 0.007 ; 0.038</span>
</td>
<td style="text-align:center;">
0.476 ; 0.999
</td>
<td style="text-align:center;">
0.690 ; 1.000
</td>
<td style="text-align:center;">
0.470 ; 0.470
</td>
</tr>
<tr>
<td style="text-align:center;padding-left: 2em;" indentlevel="1">
VIS
</td>
<td style="text-align:center;">
NA ; NA
</td>
<td style="text-align:center;">
NA ; NA
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    color: #D40481 !important;"> 0.930 ;
1.009</span>
</td>
<td style="text-align:center;">
NA ; NA
</td>
<td style="text-align:center;">
NA ; NA
</td>
</tr>
<tr>
<td style="text-align:center;">
VIS p-val
</td>
<td style="text-align:center;">
NA ; NA
</td>
<td style="text-align:center;">
NA ; NA
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    "> 0.000 ; 0.000</span>
</td>
<td style="text-align:center;">
NA ; NA
</td>
<td style="text-align:center;">
NA ; NA
</td>
</tr>
<tr>
<td style="text-align:center;padding-left: 2em;" indentlevel="1">
PC1:size
</td>
<td style="text-align:center;">
2.072 ; 3.174
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    color: #367D91 !important;"> 2.225 ;
3.237</span>
</td>
<td style="text-align:center;">
-0.379 ; 0.398
</td>
<td style="text-align:center;">
-0.621 ; 0.080
</td>
<td style="text-align:center;">
-0.452 ; -0.452
</td>
</tr>
<tr>
<td style="text-align:center;">
PC1:size p-val
</td>
<td style="text-align:center;">
0.028 ; 0.143
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    color: #B2B9BF !important;"> 0.020 ;
0.103</span>
</td>
<td style="text-align:center;">
0.724 ; 1.000
</td>
<td style="text-align:center;">
0.628 ; 0.999
</td>
<td style="text-align:center;">
0.552 ; 0.552
</td>
</tr>
<tr>
<td style="text-align:center;">
PC2:size
</td>
<td style="text-align:center;">
1.243 ; 2.853
</td>
<td style="text-align:center;">
2.502 ; 3.762
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    color: #D40481 !important;">-2.597 ;
-1.196</span>
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    color: #D40481 !important;">-2.867 ;
-1.507</span>
</td>
<td style="text-align:center;">
0.393 ; 0.393
</td>
</tr>
<tr>
<td style="text-align:center;">
PC2:size p-val
</td>
<td style="text-align:center;">
0.109 ; 0.405
</td>
<td style="text-align:center;">
0.025 ; 0.126
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    "> 0.065 ; 0.394</span>
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    "> 0.032 ; 0.257</span>
</td>
<td style="text-align:center;">
0.660 ; 0.660
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="simple-models" class="section level2">
<h2>Simple models</h2>
<div id="mcc-tree-12" class="section level3">
<h3>MCC Tree</h3>
<p>We run reduced models with the predictors that were signifficant in
the MCC tree to confirm the patterns and to reduce issues with the
abnormal termination in some trees (because in larger models some
parameters can’t be calculated when using particular trees)</p>
<p>In this table PC represents the relevant PC for each band: For VIS it
is PC1 and for NIR/Res it is PC2. This is also true for the
correspondent interactions.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>sPredictor <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;PC&quot;</span>,<span class="st">&quot;PC p-val&quot;</span> , </span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;Size&quot;</span>, <span class="st">&quot;Size p-val&quot;</span>,</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;VIS&quot;</span>, <span class="st">&quot;VIS p-val&quot;</span>, </span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;PC:size&quot;</span>, <span class="st">&quot;PC:size p-val&quot;</span>)</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Arrange the vectors to build the data frame</span></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a><span class="co"># New vectors alternate coefficient and p-values to match &quot;predictors&quot;</span></span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>sVisi <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rbind</span>((<span class="fu">c</span>(</span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a>            sFinMccVisc[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>],<span class="st">&quot;NA&quot;</span>,sFinMccVisc[<span class="dv">4</span>])),</span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a>                (<span class="fu">c</span>(sFinMccVisp[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>],<span class="st">&quot;NA&quot;</span>,sFinMccVisp[<span class="dv">4</span>]))))))</span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a>sNiri <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rbind</span>(</span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a>            sFinMccNirc[<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>], sFinMccNirp[<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>]))))</span>
<span id="cb88-15"><a href="#cb88-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-16"><a href="#cb88-16" aria-hidden="true" tabindex="-1"></a>sFRSi <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rbind</span>((<span class="fu">c</span>(</span>
<span id="cb88-17"><a href="#cb88-17" aria-hidden="true" tabindex="-1"></a>            sFinMccFRSc[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>],<span class="st">&quot;NA&quot;</span>,sFinMccFRSc[<span class="dv">4</span>])),</span>
<span id="cb88-18"><a href="#cb88-18" aria-hidden="true" tabindex="-1"></a>                (<span class="fu">c</span>(sFinMccFRSp[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>],<span class="st">&quot;NA&quot;</span>,sFinMccFRSp[<span class="dv">4</span>]))))))</span>
<span id="cb88-19"><a href="#cb88-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-20"><a href="#cb88-20" aria-hidden="true" tabindex="-1"></a>sPRSi <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rbind</span>((<span class="fu">c</span>(</span>
<span id="cb88-21"><a href="#cb88-21" aria-hidden="true" tabindex="-1"></a>            sFinMccPRSc[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>],<span class="st">&quot;NA&quot;</span>,sFinMccPRSc[<span class="dv">4</span>])),</span>
<span id="cb88-22"><a href="#cb88-22" aria-hidden="true" tabindex="-1"></a>                (<span class="fu">c</span>(sFinMccPRSp[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>],<span class="st">&quot;NA&quot;</span>,sFinMccPRSp[<span class="dv">4</span>]))))))</span>
<span id="cb88-23"><a href="#cb88-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb88-24"><a href="#cb88-24" aria-hidden="true" tabindex="-1"></a><span class="co"># This section colours the signifficant p-values and their coefficients</span></span>
<span id="cb88-25"><a href="#cb88-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-26"><a href="#cb88-26" aria-hidden="true" tabindex="-1"></a>sVisi[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(sVisi[<span class="dv">1</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb88-27"><a href="#cb88-27" aria-hidden="true" tabindex="-1"></a>sVisi[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(sVisi[<span class="dv">2</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb88-28"><a href="#cb88-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-29"><a href="#cb88-29" aria-hidden="true" tabindex="-1"></a>sVisi[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(sVisi[<span class="dv">3</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb88-30"><a href="#cb88-30" aria-hidden="true" tabindex="-1"></a>sVisi[<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(sVisi[<span class="dv">4</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb88-31"><a href="#cb88-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-32"><a href="#cb88-32" aria-hidden="true" tabindex="-1"></a>sVisi[<span class="dv">7</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(sVisi[<span class="dv">7</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb88-33"><a href="#cb88-33" aria-hidden="true" tabindex="-1"></a>sVisi[<span class="dv">8</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(sVisi[<span class="dv">8</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb88-34"><a href="#cb88-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-35"><a href="#cb88-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-36"><a href="#cb88-36" aria-hidden="true" tabindex="-1"></a>sNiri[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(sNiri[<span class="dv">1</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb88-37"><a href="#cb88-37" aria-hidden="true" tabindex="-1"></a>sNiri[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(sNiri[<span class="dv">2</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb88-38"><a href="#cb88-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-39"><a href="#cb88-39" aria-hidden="true" tabindex="-1"></a>sNiri[<span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(sNiri[<span class="dv">5</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb88-40"><a href="#cb88-40" aria-hidden="true" tabindex="-1"></a>sNiri[<span class="dv">6</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(sNiri[<span class="dv">6</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb88-41"><a href="#cb88-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-42"><a href="#cb88-42" aria-hidden="true" tabindex="-1"></a>sNiri[<span class="dv">7</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(sNiri[<span class="dv">7</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb88-43"><a href="#cb88-43" aria-hidden="true" tabindex="-1"></a>sNiri[<span class="dv">8</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(sNiri[<span class="dv">8</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb88-44"><a href="#cb88-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-45"><a href="#cb88-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-46"><a href="#cb88-46" aria-hidden="true" tabindex="-1"></a>sFRSi[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(sFRSi[<span class="dv">1</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb88-47"><a href="#cb88-47" aria-hidden="true" tabindex="-1"></a>sFRSi[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(sFRSi[<span class="dv">2</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb88-48"><a href="#cb88-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-49"><a href="#cb88-49" aria-hidden="true" tabindex="-1"></a>sFRSi[<span class="dv">7</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(sFRSi[<span class="dv">7</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb88-50"><a href="#cb88-50" aria-hidden="true" tabindex="-1"></a>sFRSi[<span class="dv">8</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(sFRSi[<span class="dv">8</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb88-51"><a href="#cb88-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-52"><a href="#cb88-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Assemble the table</span></span>
<span id="cb88-53"><a href="#cb88-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-54"><a href="#cb88-54" aria-hidden="true" tabindex="-1"></a>sResultspgls <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(sPredictor,  </span>
<span id="cb88-55"><a href="#cb88-55" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;VIS&quot;</span> <span class="ot">=</span> sVisi,</span>
<span id="cb88-56"><a href="#cb88-56" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;NIR&quot;</span> <span class="ot">=</span> sNiri,</span>
<span id="cb88-57"><a href="#cb88-57" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;Res&quot;</span> <span class="ot">=</span> sFRSi,</span>
<span id="cb88-58"><a href="#cb88-58" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;Phr&quot;</span> <span class="ot">=</span> sPRSi) </span>
<span id="cb88-59"><a href="#cb88-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-60"><a href="#cb88-60" aria-hidden="true" tabindex="-1"></a>sResultspgls <span class="sc">%&gt;%</span> </span>
<span id="cb88-61"><a href="#cb88-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">align =</span><span class="st">&quot;c&quot;</span>, <span class="at">escape =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb88-62"><a href="#cb88-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb88-63"><a href="#cb88-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_indent</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>)) </span></code></pre></div>
<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
sPredictor
</th>
<th style="text-align:center;">
VIS
</th>
<th style="text-align:center;">
NIR
</th>
<th style="text-align:center;">
Res
</th>
<th style="text-align:center;">
Phr
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;padding-left: 2em;" indentlevel="1">
PC
</td>
<td style="text-align:center;">
<span
style=" font-weight: bold;    color: #D40481 !important;">-5.816</span>
</td>
<td style="text-align:center;">
<span
style=" font-weight: bold;    color: #D40481 !important;">6.013</span>
</td>
<td style="text-align:center;">
<span
style=" font-weight: bold;    color: #D40481 !important;">6.533</span>
</td>
<td style="text-align:center;">
-1.671
</td>
</tr>
<tr>
<td style="text-align:center;">
PC p-val
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    ">0.033</span>
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    ">0.074</span>
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    ">0.046</span>
</td>
<td style="text-align:center;">
0.408
</td>
</tr>
<tr>
<td style="text-align:center;padding-left: 2em;" indentlevel="1">
Size
</td>
<td style="text-align:center;">
<span
style=" font-weight: bold;    color: #D40481 !important;">5.453</span>
</td>
<td style="text-align:center;">
0.914
</td>
<td style="text-align:center;">
0.544
</td>
<td style="text-align:center;">
1.281
</td>
</tr>
<tr>
<td style="text-align:center;">
Size p-val
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    ">0.04</span>
</td>
<td style="text-align:center;">
0.677
</td>
<td style="text-align:center;">
0.798
</td>
<td style="text-align:center;">
0.264
</td>
</tr>
<tr>
<td style="text-align:center;padding-left: 2em;" indentlevel="1">
VIS
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
<span
style=" font-weight: bold;    color: #D40481 !important;">0.975</span>
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
</tr>
<tr>
<td style="text-align:center;">
VIS p-val
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    ">0</span>
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
</tr>
<tr>
<td style="text-align:center;padding-left: 2em;" indentlevel="1">
PC:size
</td>
<td style="text-align:center;">
<span
style=" font-weight: bold;    color: #D40481 !important;">2.459</span>
</td>
<td style="text-align:center;">
<span
style=" font-weight: bold;    color: #D40481 !important;">-2.443</span>
</td>
<td style="text-align:center;">
<span
style=" font-weight: bold;    color: #D40481 !important;">-2.615</span>
</td>
<td style="text-align:center;">
0.775
</td>
</tr>
<tr>
<td style="text-align:center;">
PC:size p-val
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    ">0.03</span>
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    ">0.061</span>
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    ">0.041</span>
</td>
<td style="text-align:center;">
0.336
</td>
</tr>
</tbody>
</table>
</div>
<div id="multiple-trees-12" class="section level3">
<h3>multiple trees</h3>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>srvVISl <span class="ot">&lt;-</span> <span class="fu">as.character</span>(</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">format</span>(<span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="fu">c</span>(</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>              FinVisS[<span class="dv">1</span>,<span class="dv">1</span>],FinVisS[<span class="dv">3</span>,<span class="dv">1</span>],</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>              FinResS[<span class="dv">4</span>,<span class="dv">1</span>],FinVisS[<span class="dv">6</span>,<span class="dv">1</span>],<span class="st">&quot;NA&quot;</span>,<span class="st">&quot;NA&quot;</span>,</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>              FinVisS[<span class="dv">7</span>,<span class="dv">1</span>],FinVisS[<span class="dv">9</span>,<span class="dv">1</span>])),<span class="dv">3</span>),<span class="at">nsmall=</span><span class="dv">3</span>))</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>srvVISu <span class="ot">&lt;-</span> <span class="fu">as.character</span>(</span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>            <span class="fu">format</span>(<span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="fu">c</span>(</span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>              FinVisS[<span class="dv">1</span>,<span class="dv">2</span>],FinVisS[<span class="dv">3</span>,<span class="dv">2</span>],</span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>              FinVisS[<span class="dv">4</span>,<span class="dv">2</span>],FinVisS[<span class="dv">6</span>,<span class="dv">2</span>],<span class="st">&quot;NA&quot;</span>,<span class="st">&quot;NA&quot;</span>,</span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>              FinVisS[<span class="dv">7</span>,<span class="dv">2</span>],FinVisS[<span class="dv">9</span>,<span class="dv">2</span>])),<span class="dv">3</span>),<span class="at">nsmall=</span><span class="dv">3</span>))</span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a>srvNIRl <span class="ot">&lt;-</span> <span class="fu">as.character</span>(</span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a>            <span class="fu">format</span>(<span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="fu">c</span>(</span>
<span id="cb89-16"><a href="#cb89-16" aria-hidden="true" tabindex="-1"></a>              FinNirS[<span class="dv">1</span>,<span class="dv">1</span>],FinNirS[<span class="dv">3</span>,<span class="dv">1</span>],</span>
<span id="cb89-17"><a href="#cb89-17" aria-hidden="true" tabindex="-1"></a>              FinNirS[<span class="dv">4</span>,<span class="dv">1</span>],FinNirS[<span class="dv">6</span>,<span class="dv">1</span>],</span>
<span id="cb89-18"><a href="#cb89-18" aria-hidden="true" tabindex="-1"></a>              FinNirS[<span class="dv">7</span>,<span class="dv">1</span>],FinNirS[<span class="dv">9</span>,<span class="dv">1</span>],</span>
<span id="cb89-19"><a href="#cb89-19" aria-hidden="true" tabindex="-1"></a>              FinNirS[<span class="dv">10</span>,<span class="dv">1</span>],FinNirS[<span class="dv">12</span>,<span class="dv">1</span>]</span>
<span id="cb89-20"><a href="#cb89-20" aria-hidden="true" tabindex="-1"></a>              )),<span class="dv">3</span>),<span class="at">nsmall=</span><span class="dv">3</span>))</span>
<span id="cb89-21"><a href="#cb89-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-22"><a href="#cb89-22" aria-hidden="true" tabindex="-1"></a>srvNIRu <span class="ot">&lt;-</span> <span class="fu">as.character</span>(</span>
<span id="cb89-23"><a href="#cb89-23" aria-hidden="true" tabindex="-1"></a>           <span class="fu">format</span>(<span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="fu">c</span>(</span>
<span id="cb89-24"><a href="#cb89-24" aria-hidden="true" tabindex="-1"></a>              FinNirS[<span class="dv">1</span>,<span class="dv">2</span>],FinNirS[<span class="dv">3</span>,<span class="dv">2</span>],</span>
<span id="cb89-25"><a href="#cb89-25" aria-hidden="true" tabindex="-1"></a>              FinNirS[<span class="dv">4</span>,<span class="dv">2</span>],FinNirS[<span class="dv">6</span>,<span class="dv">2</span>],</span>
<span id="cb89-26"><a href="#cb89-26" aria-hidden="true" tabindex="-1"></a>              FinNirS[<span class="dv">7</span>,<span class="dv">2</span>],FinNirS[<span class="dv">9</span>,<span class="dv">2</span>],</span>
<span id="cb89-27"><a href="#cb89-27" aria-hidden="true" tabindex="-1"></a>              FinNirS[<span class="dv">10</span>,<span class="dv">2</span>],FinNirS[<span class="dv">12</span>,<span class="dv">2</span>]</span>
<span id="cb89-28"><a href="#cb89-28" aria-hidden="true" tabindex="-1"></a>              )),<span class="dv">3</span>),<span class="at">nsmall=</span><span class="dv">3</span>))</span>
<span id="cb89-29"><a href="#cb89-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-30"><a href="#cb89-30" aria-hidden="true" tabindex="-1"></a>srvFRSl <span class="ot">&lt;-</span> <span class="fu">as.character</span>(</span>
<span id="cb89-31"><a href="#cb89-31" aria-hidden="true" tabindex="-1"></a>            <span class="fu">format</span>(<span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="fu">c</span>(</span>
<span id="cb89-32"><a href="#cb89-32" aria-hidden="true" tabindex="-1"></a>              FinFRSS[<span class="dv">1</span>,<span class="dv">1</span>],FinFRSS[<span class="dv">3</span>,<span class="dv">1</span>],</span>
<span id="cb89-33"><a href="#cb89-33" aria-hidden="true" tabindex="-1"></a>              FinFRSS[<span class="dv">4</span>,<span class="dv">1</span>],FinFRSS[<span class="dv">6</span>,<span class="dv">1</span>],<span class="st">&quot;NA&quot;</span>,<span class="st">&quot;NA&quot;</span>,</span>
<span id="cb89-34"><a href="#cb89-34" aria-hidden="true" tabindex="-1"></a>              FinFRSS[<span class="dv">7</span>,<span class="dv">1</span>],FinFRSS[<span class="dv">9</span>,<span class="dv">1</span>])),<span class="dv">3</span>),<span class="at">nsmall=</span><span class="dv">3</span>))</span>
<span id="cb89-35"><a href="#cb89-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-36"><a href="#cb89-36" aria-hidden="true" tabindex="-1"></a>srvFRSu <span class="ot">&lt;-</span> <span class="fu">as.character</span>(</span>
<span id="cb89-37"><a href="#cb89-37" aria-hidden="true" tabindex="-1"></a>            <span class="fu">format</span>(<span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="fu">c</span>(</span>
<span id="cb89-38"><a href="#cb89-38" aria-hidden="true" tabindex="-1"></a>              FinFRSS[<span class="dv">1</span>,<span class="dv">2</span>],FinFRSS[<span class="dv">3</span>,<span class="dv">2</span>],</span>
<span id="cb89-39"><a href="#cb89-39" aria-hidden="true" tabindex="-1"></a>              FinFRSS[<span class="dv">4</span>,<span class="dv">2</span>],FinFRSS[<span class="dv">6</span>,<span class="dv">2</span>],<span class="st">&quot;NA&quot;</span>,<span class="st">&quot;NA&quot;</span>,</span>
<span id="cb89-40"><a href="#cb89-40" aria-hidden="true" tabindex="-1"></a>              FinFRSS[<span class="dv">7</span>,<span class="dv">2</span>],FinFRSS[<span class="dv">9</span>,<span class="dv">2</span>])),<span class="dv">3</span>),<span class="at">nsmall=</span><span class="dv">3</span>))</span>
<span id="cb89-41"><a href="#cb89-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-42"><a href="#cb89-42" aria-hidden="true" tabindex="-1"></a>srvPRSl <span class="ot">&lt;-</span> <span class="fu">as.character</span>(</span>
<span id="cb89-43"><a href="#cb89-43" aria-hidden="true" tabindex="-1"></a>            <span class="fu">format</span>(<span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="fu">c</span>(</span>
<span id="cb89-44"><a href="#cb89-44" aria-hidden="true" tabindex="-1"></a>              FinPRSS[<span class="dv">1</span>,<span class="dv">1</span>],FinPRSS[<span class="dv">3</span>,<span class="dv">1</span>],</span>
<span id="cb89-45"><a href="#cb89-45" aria-hidden="true" tabindex="-1"></a>              FinPRSS[<span class="dv">4</span>,<span class="dv">1</span>],FinPRSS[<span class="dv">6</span>,<span class="dv">1</span>],<span class="st">&quot;NA&quot;</span>,<span class="st">&quot;NA&quot;</span>,</span>
<span id="cb89-46"><a href="#cb89-46" aria-hidden="true" tabindex="-1"></a>              FinPRSS[<span class="dv">7</span>,<span class="dv">1</span>],FinPRSS[<span class="dv">9</span>,<span class="dv">1</span>])),<span class="dv">3</span>),<span class="at">nsmall=</span><span class="dv">3</span>))</span>
<span id="cb89-47"><a href="#cb89-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-48"><a href="#cb89-48" aria-hidden="true" tabindex="-1"></a>srvPRSu <span class="ot">&lt;-</span> <span class="fu">as.character</span>(</span>
<span id="cb89-49"><a href="#cb89-49" aria-hidden="true" tabindex="-1"></a>            <span class="fu">format</span>(<span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="fu">c</span>(</span>
<span id="cb89-50"><a href="#cb89-50" aria-hidden="true" tabindex="-1"></a>              FinPRSS[<span class="dv">1</span>,<span class="dv">2</span>],FinPRSS[<span class="dv">3</span>,<span class="dv">2</span>],</span>
<span id="cb89-51"><a href="#cb89-51" aria-hidden="true" tabindex="-1"></a>              FinPRSS[<span class="dv">4</span>,<span class="dv">2</span>],FinPRSS[<span class="dv">6</span>,<span class="dv">2</span>],<span class="st">&quot;NA&quot;</span>,<span class="st">&quot;NA&quot;</span>,</span>
<span id="cb89-52"><a href="#cb89-52" aria-hidden="true" tabindex="-1"></a>              FinPRSS[<span class="dv">7</span>,<span class="dv">2</span>],FinPRSS[<span class="dv">9</span>,<span class="dv">2</span>])),<span class="dv">3</span>),<span class="at">nsmall=</span><span class="dv">3</span>))</span>
<span id="cb89-53"><a href="#cb89-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-54"><a href="#cb89-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-55"><a href="#cb89-55" aria-hidden="true" tabindex="-1"></a>srvVISi<span class="ot">&lt;-</span><span class="fu">paste</span>(srvVISl,srvVISu, <span class="at">sep =</span> <span class="st">&quot; ; &quot;</span>)</span>
<span id="cb89-56"><a href="#cb89-56" aria-hidden="true" tabindex="-1"></a>srvNIRi<span class="ot">&lt;-</span><span class="fu">paste</span>(srvNIRl,srvNIRu, <span class="at">sep =</span> <span class="st">&quot; ; &quot;</span>)</span>
<span id="cb89-57"><a href="#cb89-57" aria-hidden="true" tabindex="-1"></a>srvFRSi<span class="ot">&lt;-</span><span class="fu">paste</span>(srvFRSl,srvFRSu, <span class="at">sep =</span> <span class="st">&quot; ; &quot;</span>)</span>
<span id="cb89-58"><a href="#cb89-58" aria-hidden="true" tabindex="-1"></a>srvPRSi<span class="ot">&lt;-</span><span class="fu">paste</span>(srvPRSl,srvPRSu, <span class="at">sep =</span> <span class="st">&quot; ; &quot;</span>)</span>
<span id="cb89-59"><a href="#cb89-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-60"><a href="#cb89-60" aria-hidden="true" tabindex="-1"></a>srvVISi[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(srvVISi[<span class="dv">1</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb89-61"><a href="#cb89-61" aria-hidden="true" tabindex="-1"></a>srvVISi[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(srvVISi[<span class="dv">2</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb89-62"><a href="#cb89-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-63"><a href="#cb89-63" aria-hidden="true" tabindex="-1"></a>srvVISi[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(srvVISi[<span class="dv">3</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb89-64"><a href="#cb89-64" aria-hidden="true" tabindex="-1"></a>srvVISi[<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(srvVISi[<span class="dv">4</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb89-65"><a href="#cb89-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-66"><a href="#cb89-66" aria-hidden="true" tabindex="-1"></a>srvVISi[<span class="dv">7</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(srvVISi[<span class="dv">7</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb89-67"><a href="#cb89-67" aria-hidden="true" tabindex="-1"></a>srvVISi[<span class="dv">8</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(srvVISi[<span class="dv">8</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb89-68"><a href="#cb89-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-69"><a href="#cb89-69" aria-hidden="true" tabindex="-1"></a>srvNIRi[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(srvNIRi[<span class="dv">1</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb89-70"><a href="#cb89-70" aria-hidden="true" tabindex="-1"></a>srvNIRi[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(srvNIRi[<span class="dv">2</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb89-71"><a href="#cb89-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-72"><a href="#cb89-72" aria-hidden="true" tabindex="-1"></a>srvNIRi[<span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(srvNIRi[<span class="dv">5</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb89-73"><a href="#cb89-73" aria-hidden="true" tabindex="-1"></a>srvNIRi[<span class="dv">6</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(srvNIRi[<span class="dv">6</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb89-74"><a href="#cb89-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-75"><a href="#cb89-75" aria-hidden="true" tabindex="-1"></a>srvNIRi[<span class="dv">7</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(srvNIRi[<span class="dv">7</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb89-76"><a href="#cb89-76" aria-hidden="true" tabindex="-1"></a>srvNIRi[<span class="dv">8</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(srvNIRi[<span class="dv">8</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb89-77"><a href="#cb89-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-78"><a href="#cb89-78" aria-hidden="true" tabindex="-1"></a>srvFRSi[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(srvFRSi[<span class="dv">1</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb89-79"><a href="#cb89-79" aria-hidden="true" tabindex="-1"></a>srvFRSi[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(srvFRSi[<span class="dv">2</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb89-80"><a href="#cb89-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-81"><a href="#cb89-81" aria-hidden="true" tabindex="-1"></a>srvFRSi[<span class="dv">7</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(srvFRSi[<span class="dv">7</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color=</span><span class="st">&quot;#D40481&quot;</span>)</span>
<span id="cb89-82"><a href="#cb89-82" aria-hidden="true" tabindex="-1"></a>srvFRSi[<span class="dv">8</span>] <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(srvFRSi[<span class="dv">8</span>],<span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb89-83"><a href="#cb89-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-84"><a href="#cb89-84" aria-hidden="true" tabindex="-1"></a>smResultspgls <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(sPredictor,</span>
<span id="cb89-85"><a href="#cb89-85" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;VIS&quot;</span> <span class="ot">=</span> srvVISi,</span>
<span id="cb89-86"><a href="#cb89-86" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;NIR&quot;</span> <span class="ot">=</span> srvNIRi,</span>
<span id="cb89-87"><a href="#cb89-87" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;Res&quot;</span> <span class="ot">=</span> srvFRSi,</span>
<span id="cb89-88"><a href="#cb89-88" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;Phr&quot;</span> <span class="ot">=</span> srvPRSi) </span>
<span id="cb89-89"><a href="#cb89-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-90"><a href="#cb89-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-91"><a href="#cb89-91" aria-hidden="true" tabindex="-1"></a>smResultspgls <span class="sc">%&gt;%</span> </span>
<span id="cb89-92"><a href="#cb89-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">align =</span><span class="st">&quot;c&quot;</span>, <span class="at">escape =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb89-93"><a href="#cb89-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb89-94"><a href="#cb89-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_indent</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>)) </span></code></pre></div>
<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
sPredictor
</th>
<th style="text-align:center;">
VIS
</th>
<th style="text-align:center;">
NIR
</th>
<th style="text-align:center;">
Res
</th>
<th style="text-align:center;">
Phr
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;padding-left: 2em;" indentlevel="1">
PC
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    color: #D40481 !important;">-7.498 ;
-4.872</span>
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    color: #D40481 !important;"> 4.652 ;
6.992</span>
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    color: #D40481 !important;"> 5.271 ;
7.547</span>
</td>
<td style="text-align:center;">
-1.671 ; -1.671
</td>
</tr>
<tr>
<td style="text-align:center;">
PC p-val
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    "> 0.000 ; 0.069</span>
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    "> 0.024 ; 0.146</span>
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    "> 0.014 ; 0.098</span>
</td>
<td style="text-align:center;">
0.408 ; 0.408
</td>
</tr>
<tr>
<td style="text-align:center;padding-left: 2em;" indentlevel="1">
Size
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    color: #D40481 !important;"> 0.167 ;
6.895</span>
</td>
<td style="text-align:center;">
0.136 ; 2.019
</td>
<td style="text-align:center;">
-0.110 ; 1.451
</td>
<td style="text-align:center;">
1.281 ; 1.281
</td>
</tr>
<tr>
<td style="text-align:center;">
Size p-val
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    "> 0.005 ; 0.116</span>
</td>
<td style="text-align:center;">
0.381 ; 0.964
</td>
<td style="text-align:center;">
0.530 ; 0.999
</td>
<td style="text-align:center;">
0.264 ; 0.264
</td>
</tr>
<tr>
<td style="text-align:center;padding-left: 2em;" indentlevel="1">
VIS
</td>
<td style="text-align:center;">
NA ; NA
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    color: #D40481 !important;"> 0.946 ;
1.011</span>
</td>
<td style="text-align:center;">
NA ; NA
</td>
<td style="text-align:center;">
NA ; NA
</td>
</tr>
<tr>
<td style="text-align:center;">
VIS p-val
</td>
<td style="text-align:center;">
NA ; NA
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    "> 0.000 ; 0.000</span>
</td>
<td style="text-align:center;">
NA ; NA
</td>
<td style="text-align:center;">
NA ; NA
</td>
</tr>
<tr>
<td style="text-align:center;padding-left: 2em;" indentlevel="1">
PC:size
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    color: #D40481 !important;"> 2.043 ;
3.219</span>
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    color: #D40481 !important;">-2.811 ;
-1.970</span>
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    color: #D40481 !important;">-2.977 ;
-2.155</span>
</td>
<td style="text-align:center;">
0.775 ; 0.775
</td>
</tr>
<tr>
<td style="text-align:center;">
PC:size p-val
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    "> 0.000 ; 0.072</span>
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    "> 0.022 ; 0.124</span>
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    "> 0.014 ; 0.088</span>
</td>
<td style="text-align:center;">
0.336 ; 0.336
</td>
</tr>
</tbody>
</table>
<p><br> <br></p>
</div>
</div>
</div>
<div id="pgls-assumptions" class="section level1">
<h1>PGLS Assumptions</h1>
<p>Residuals should be normally distributed and should not have any
extra patterns after fitting the model</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pglsmodTOT)</span></code></pre></div>
<p><img src="MacroEcol_9_ReflectivityQC_files/figure-html/unnamed-chunk-48-1.png" width="672" /></p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pglsmodVIS)</span></code></pre></div>
<p><img src="MacroEcol_9_ReflectivityQC_files/figure-html/unnamed-chunk-48-2.png" width="672" /></p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pglsmodNIR)</span></code></pre></div>
<p><img src="MacroEcol_9_ReflectivityQC_files/figure-html/unnamed-chunk-48-3.png" width="672" /></p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pglsmodRes)</span></code></pre></div>
<p><img src="MacroEcol_9_ReflectivityQC_files/figure-html/unnamed-chunk-48-4.png" width="672" /></p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pglsmodFRS)</span></code></pre></div>
<p><img src="MacroEcol_9_ReflectivityQC_files/figure-html/unnamed-chunk-48-5.png" width="672" /></p>
<p><br> <br></p>
</div>
<div id="interactions" class="section level1">
<h1>Interactions</h1>
<p>To understand the interaction terms we explored the relationships
between the PC value and the reflectance dividing the beetle species
into small and large.</p>
<p>Firstly, prepare data frames</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>VISSmall<span class="ot">&lt;-</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>  SimpleVIS <span class="sc">%&gt;%</span> <span class="co"># visible reflectance</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(size<span class="sc">&lt;</span><span class="fl">2.5</span>) <span class="co"># Small beetles</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>VISLarge<span class="ot">&lt;-</span></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>  SimpleVIS <span class="sc">%&gt;%</span> <span class="co"># visible reflectance</span></span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(size<span class="sc">&gt;</span><span class="fl">2.5</span>) <span class="co"># large beetles</span></span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>ProbPol <span class="ot">&lt;-</span></span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>  SimpleVIS <span class="sc">%&gt;%</span></span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>( <span class="co">#if we want to consider only polarized beetles</span></span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a>    phylogeny_name <span class="sc">!=</span> <span class="st">&quot;Paraschizognathus_ocularis&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a>    phylogeny_name <span class="sc">!=</span> <span class="st">&quot;Paraschizognathus_prasinus&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a>    phylogeny_name <span class="sc">!=</span> <span class="st">&quot;Paraschizognathus_olivaceous&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a>    phylogeny_name <span class="sc">!=</span> <span class="st">&quot;Anoplognathus_prasinus&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb95-16"><a href="#cb95-16" aria-hidden="true" tabindex="-1"></a>    phylogeny_name <span class="sc">!=</span> <span class="st">&quot;Xylonichus_sp&quot;</span>) <span class="co"># these all have white underlay</span></span>
<span id="cb95-17"><a href="#cb95-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-18"><a href="#cb95-18" aria-hidden="true" tabindex="-1"></a>VISSmallp<span class="ot">&lt;-</span></span>
<span id="cb95-19"><a href="#cb95-19" aria-hidden="true" tabindex="-1"></a>  ProbPol <span class="sc">%&gt;%</span> </span>
<span id="cb95-20"><a href="#cb95-20" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(size<span class="sc">&lt;</span><span class="fl">2.5</span>) <span class="co"># small beetles</span></span>
<span id="cb95-21"><a href="#cb95-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-22"><a href="#cb95-22" aria-hidden="true" tabindex="-1"></a>VISLargep<span class="ot">&lt;-</span></span>
<span id="cb95-23"><a href="#cb95-23" aria-hidden="true" tabindex="-1"></a>  ProbPol <span class="sc">%&gt;%</span> </span>
<span id="cb95-24"><a href="#cb95-24" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(size<span class="sc">&gt;</span><span class="fl">2.5</span>) <span class="co"># large beetles</span></span>
<span id="cb95-25"><a href="#cb95-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-26"><a href="#cb95-26" aria-hidden="true" tabindex="-1"></a>ResSmall<span class="ot">&lt;-</span></span>
<span id="cb95-27"><a href="#cb95-27" aria-hidden="true" tabindex="-1"></a>  SimpleRes <span class="sc">%&gt;%</span> <span class="co"># residuals between the relationship NIR~VIS</span></span>
<span id="cb95-28"><a href="#cb95-28" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(size<span class="sc">&lt;</span><span class="fl">2.5</span>) <span class="co"># small beetles</span></span>
<span id="cb95-29"><a href="#cb95-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-30"><a href="#cb95-30" aria-hidden="true" tabindex="-1"></a>ResLarge<span class="ot">&lt;-</span></span>
<span id="cb95-31"><a href="#cb95-31" aria-hidden="true" tabindex="-1"></a>  SimpleRes <span class="sc">%&gt;%</span> </span>
<span id="cb95-32"><a href="#cb95-32" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(size<span class="sc">&gt;</span><span class="fl">2.5</span>) <span class="co"># Large beetles</span></span></code></pre></div>
<p>Subsets for plots</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>ToPlotInt <span class="ot">&lt;-</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>  Cons1 <span class="sc">%&gt;%</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>phylogeny_name) <span class="sc">%&gt;%</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">&quot;spp&quot;</span> <span class="ot">=</span> <span class="fu">substr</span>(ind, <span class="dv">1</span>, <span class="dv">4</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(spp) <span class="sc">%&gt;%</span></span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(</span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">meanAll =</span> <span class="fu">mean</span>(R_ALL),</span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">meanVIS =</span> <span class="fu">mean</span>(R_VIS),</span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">meanNIR =</span> <span class="fu">mean</span>(R_NIR),</span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">meanRes =</span> <span class="fu">mean</span>(Res),</span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">meanPC1 =</span> <span class="fu">mean</span>(PC1),</span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">meanPC2 =</span> <span class="fu">mean</span>(PC2),</span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">meanSize =</span> <span class="fu">mean</span>(size),</span>
<span id="cb96-15"><a href="#cb96-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">sdAll =</span> <span class="fu">sd</span>(R_ALL),</span>
<span id="cb96-16"><a href="#cb96-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">sdVIS =</span> <span class="fu">sd</span>(R_VIS),</span>
<span id="cb96-17"><a href="#cb96-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">sdNIR =</span> <span class="fu">sd</span>(R_NIR),</span>
<span id="cb96-18"><a href="#cb96-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">sdRes =</span> <span class="fu">sd</span>(Res),</span>
<span id="cb96-19"><a href="#cb96-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">sdPC1 =</span> <span class="fu">sd</span>(PC1),</span>
<span id="cb96-20"><a href="#cb96-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">sdPC2 =</span> <span class="fu">sd</span>(PC2),</span>
<span id="cb96-21"><a href="#cb96-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">sdSize =</span> <span class="fu">sd</span>(size)</span>
<span id="cb96-22"><a href="#cb96-22" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb96-23"><a href="#cb96-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-24"><a href="#cb96-24" aria-hidden="true" tabindex="-1"></a>ToPlotInt <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(ToPlotInt)</span>
<span id="cb96-25"><a href="#cb96-25" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(ToPlotInt) <span class="ot">&lt;-</span> ToPlotInt[, <span class="dv">1</span>]</span>
<span id="cb96-26"><a href="#cb96-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-27"><a href="#cb96-27" aria-hidden="true" tabindex="-1"></a>plotVisSmall <span class="ot">&lt;-</span> </span>
<span id="cb96-28"><a href="#cb96-28" aria-hidden="true" tabindex="-1"></a>  ToPlotInt <span class="sc">%&gt;%</span> </span>
<span id="cb96-29"><a href="#cb96-29" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(meanSize<span class="sc">&lt;</span><span class="fl">2.5</span>) <span class="sc">%&gt;%</span>  <span class="co"># Small beetles</span></span>
<span id="cb96-30"><a href="#cb96-30" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">10</span>,<span class="dv">13</span>,<span class="dv">15</span>)</span>
<span id="cb96-31"><a href="#cb96-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-32"><a href="#cb96-32" aria-hidden="true" tabindex="-1"></a>plotVisLarge <span class="ot">&lt;-</span> </span>
<span id="cb96-33"><a href="#cb96-33" aria-hidden="true" tabindex="-1"></a>  ToPlotInt <span class="sc">%&gt;%</span> </span>
<span id="cb96-34"><a href="#cb96-34" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(meanSize<span class="sc">&gt;</span><span class="fl">2.5</span>) <span class="sc">%&gt;%</span>  <span class="co"># Large beetles </span></span>
<span id="cb96-35"><a href="#cb96-35" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">10</span>,<span class="dv">13</span>,<span class="dv">15</span>)</span>
<span id="cb96-36"><a href="#cb96-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-37"><a href="#cb96-37" aria-hidden="true" tabindex="-1"></a>plotNirSmall <span class="ot">&lt;-</span></span>
<span id="cb96-38"><a href="#cb96-38" aria-hidden="true" tabindex="-1"></a>  ToPlotInt <span class="sc">%&gt;%</span> </span>
<span id="cb96-39"><a href="#cb96-39" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(meanSize<span class="sc">&lt;</span><span class="fl">2.5</span>) <span class="sc">%&gt;%</span>  <span class="co"># Small beetles</span></span>
<span id="cb96-40"><a href="#cb96-40" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">12</span>,<span class="dv">14</span>,<span class="dv">15</span>)</span>
<span id="cb96-41"><a href="#cb96-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-42"><a href="#cb96-42" aria-hidden="true" tabindex="-1"></a>plotNirLarge <span class="ot">&lt;-</span></span>
<span id="cb96-43"><a href="#cb96-43" aria-hidden="true" tabindex="-1"></a>  ToPlotInt <span class="sc">%&gt;%</span> </span>
<span id="cb96-44"><a href="#cb96-44" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(meanSize<span class="sc">&gt;</span><span class="fl">2.5</span>) <span class="sc">%&gt;%</span>  <span class="co"># Large beetles</span></span>
<span id="cb96-45"><a href="#cb96-45" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">12</span>,<span class="dv">14</span>,<span class="dv">15</span>)</span></code></pre></div>
<div id="preliminary" class="section level2">
<h2>Preliminary</h2>
<ol style="list-style-type: decimal">
<li>Relationship between vis reflectance and size.</li>
</ol>
<p>This relationship is intensified if the most reflective beetles are
removed. The species A. aures, A. parvulus and A. roseus.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>AllBeet <span class="ot">&lt;-</span> <span class="fu">lm</span>(VISDataSet<span class="sc">$</span>Response <span class="sc">~</span> VISDataSet<span class="sc">$</span>size)</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(AllBeet)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = VISDataSet$Response ~ VISDataSet$size)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -9.773 -4.040 -1.341  3.565 21.378 
## 
## Coefficients:
##                 Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)        8.433      5.940   1.420    0.163
## VISDataSet$size    2.637      2.566   1.027    0.310
## 
## Residual standard error: 6.9 on 40 degrees of freedom
## Multiple R-squared:  0.02571,    Adjusted R-squared:  0.001357 
## F-statistic: 1.056 on 1 and 40 DF,  p-value: 0.3104</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>AA <span class="ot">&lt;-</span> <span class="co"># removing the most reflective beetles</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>  VISDataSet <span class="sc">%&gt;%</span> </span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(phylogeny_name <span class="sc">!=</span> <span class="st">&quot;Anoplognathus_aureus&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>                phylogeny_name <span class="sc">!=</span> <span class="st">&quot;Anoplognathus_parvulus&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>                phylogeny_name <span class="sc">!=</span> <span class="st">&quot;Anoplostethus_roseus&quot;</span>) </span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>SubsetBeet <span class="ot">&lt;-</span><span class="fu">lm</span>(AA<span class="sc">$</span>Response <span class="sc">~</span> AA<span class="sc">$</span>size)</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(SubsetBeet)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = AA$Response ~ AA$size)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -8.462 -2.797 -1.098  3.049 14.172 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)   -2.831      4.658  -0.608  0.54706   
## AA$size        6.971      1.981   3.519  0.00117 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.979 on 37 degrees of freedom
## Multiple R-squared:  0.2508, Adjusted R-squared:  0.2305 
## F-statistic: 12.38 on 1 and 37 DF,  p-value: 0.001167</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>PC1</li>
</ol>
<p>We divided the beetles into two groups large beetles &gt; 2.5 cm and
small beetles &lt; 2.5 cm.</p>
<p>** If I remove the non-polarized beetles, the pattern remains the
same.</p>
<div class="sourceCode" id="cb101"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(VISSmall<span class="sc">$</span>Response <span class="sc">~</span> VISSmall<span class="sc">$</span>PC, </span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;PC1&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Reflectance&quot;</span>,  <span class="at">main=</span><span class="st">&quot;Small beetles (&lt;2.5cm)&quot;</span>)</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(VISLarge<span class="sc">$</span>Response <span class="sc">~</span> VISLarge<span class="sc">$</span>PC,</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;PC1&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Reflectance&quot;</span>, <span class="at">main=</span><span class="st">&quot;Large beetles (&gt;2.5cm)&quot;</span>)</span></code></pre></div>
<p><img src="MacroEcol_9_ReflectivityQC_files/figure-html/unnamed-chunk-52-1.png" width="672" /></p>
<div class="sourceCode" id="cb102"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>dumModVs <span class="ot">&lt;-</span> <span class="fu">lm</span>(VISSmall<span class="sc">$</span>Response <span class="sc">~</span> VISSmall<span class="sc">$</span>PC)</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dumModVs)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = VISSmall$Response ~ VISSmall$PC)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -9.5153 -4.5045  0.5416  2.8701 20.1281 
## 
## Coefficients:
##             Estimate Std. Error t value      Pr(&gt;|t|)    
## (Intercept)  12.7140     1.4988   8.483 0.00000000427 ***
## VISSmall$PC  -0.4769     0.8166  -0.584         0.564    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 7.333 on 27 degrees of freedom
## Multiple R-squared:  0.01248,    Adjusted R-squared:  -0.0241 
## F-statistic: 0.3411 on 1 and 27 DF,  p-value: 0.564</code></pre>
<div class="sourceCode" id="cb104"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>dumModVl <span class="ot">&lt;-</span> <span class="fu">lm</span>(VISLarge<span class="sc">$</span>Response <span class="sc">~</span> VISLarge<span class="sc">$</span>PC) </span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dumModVl)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = VISLarge$Response ~ VISLarge$PC)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -5.081 -3.402 -1.142  1.540 12.700 
## 
## Coefficients:
##             Estimate Std. Error t value     Pr(&gt;|t|)    
## (Intercept)  17.4595     1.4043  12.433 0.0000000808 ***
## VISLarge$PC   1.0371     0.9633   1.077        0.305    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.063 on 11 degrees of freedom
## Multiple R-squared:  0.09533,    Adjusted R-squared:  0.01309 
## F-statistic: 1.159 on 1 and 11 DF,  p-value: 0.3047</code></pre>
<p>Plots for NIR light</p>
<p>We separated the beetles into two groups large beetles &gt; 2.5 cm
and small beetles &lt; 2.5 cm.</p>
<div class="sourceCode" id="cb106"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>((ResDataSet[ResDataSet<span class="sc">$</span>size<span class="sc">&lt;</span><span class="fl">2.5</span>,])<span class="sc">$</span>PC2,</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>     (ResDataSet[ResDataSet<span class="sc">$</span>size<span class="sc">&lt;</span><span class="fl">2.5</span>,])<span class="sc">$</span>Response,</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">&quot;Reflectance&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;PC2&quot;</span>, <span class="at">main=</span><span class="st">&quot;Small beetles (&lt;2.5cm)&quot;</span>)</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>((ResDataSet[ResDataSet<span class="sc">$</span>size<span class="sc">&gt;</span><span class="fl">2.5</span>,])<span class="sc">$</span>PC2,</span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>     (ResDataSet[ResDataSet<span class="sc">$</span>size<span class="sc">&gt;</span><span class="fl">2.5</span>,])<span class="sc">$</span>Response,</span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">&quot;Reflectance&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;PC2&quot;</span>, <span class="at">main=</span><span class="st">&quot;Large beetles (&gt;2.5cm)&quot;</span>)</span></code></pre></div>
<p><img src="MacroEcol_9_ReflectivityQC_files/figure-html/unnamed-chunk-53-1.png" width="672" /></p>
<div class="sourceCode" id="cb107"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>dumModNb <span class="ot">&lt;-</span> <span class="fu">lm</span>(ResDataSet<span class="sc">$</span>Response <span class="sc">~</span> ResDataSet<span class="sc">$</span>PC2) <span class="co"># All together</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dumModNb)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = ResDataSet$Response ~ ResDataSet$PC2)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -9.5553 -3.5185  0.3053  4.4693  8.3776 
## 
## Coefficients:
##                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)     -3.4301     0.8153  -4.207 0.000142 ***
## ResDataSet$PC2  -0.2999     0.5377  -0.558 0.580178    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.133 on 40 degrees of freedom
## Multiple R-squared:  0.007715,   Adjusted R-squared:  -0.01709 
## F-statistic: 0.311 on 1 and 40 DF,  p-value: 0.5802</code></pre>
<div class="sourceCode" id="cb109"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>dumModNs <span class="ot">&lt;-</span> <span class="fu">lm</span>(ResSmall<span class="sc">$</span>Response <span class="sc">~</span> ResSmall<span class="sc">$</span>PC) <span class="co"># size &lt; 2.5</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dumModNs)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = ResSmall$Response ~ ResSmall$PC)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -10.7394  -3.1318  -0.7258   4.5840   7.7681 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  -3.8383     0.9919  -3.870 0.000624 ***
## ResSmall$PC   0.8459     0.8955   0.945 0.353269    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.336 on 27 degrees of freedom
## Multiple R-squared:  0.03199,    Adjusted R-squared:  -0.003866 
## F-statistic: 0.8922 on 1 and 27 DF,  p-value: 0.3533</code></pre>
<div class="sourceCode" id="cb111"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>dumModNl <span class="ot">&lt;-</span> <span class="fu">lm</span>(ResLarge<span class="sc">$</span>Response <span class="sc">~</span> ResLarge<span class="sc">$</span>PC) <span class="co"># size &gt; 2.5</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dumModNl)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = ResLarge$Response ~ ResLarge$PC)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -7.5858 -1.8395  0.1237  2.9330  6.5657 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)  -3.0062     1.3603  -2.210   0.0492 *
## ResLarge$PC  -0.8831     0.6281  -1.406   0.1873  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.289 on 11 degrees of freedom
## Multiple R-squared:  0.1523, Adjusted R-squared:  0.07527 
## F-statistic: 1.977 on 1 and 11 DF,  p-value: 0.1873</code></pre>
<p>There is a positive correlation between PC2 and NIR (residuals
NIR~VIS) but this is only valid for small beetles. For small beetles,
the NIR reflectance is greater in fresh environments. This is opposite
to the original hypothesis in which we expected more NIR in more arid
and hot environments.</p>
<p><br></p>
</div>
<div id="predictions" class="section level2">
<h2>Predictions</h2>
<p>We calculated the expected values of visible and NIR reflectance for
the two groups of beetles, small and large based on the large full
model.</p>
<p>Fos the visible reflectance we only graphed the PC1 since PC2 did not
have a signifficant effect in reflectance. For NIR reflectance we
graphed only PC2.</p>
<div class="sourceCode" id="cb113"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Small beetles VIS</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a><span class="do">## set values for predictors: </span></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>SVPC1 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">range</span>(plotVisSmall<span class="sc">$</span>meanPC1)[<span class="dv">1</span>],</span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>             <span class="fu">range</span>(plotVisSmall<span class="sc">$</span>meanPC1)[<span class="dv">2</span>],<span class="fl">0.01</span>) <span class="co"># A range of PC1 values</span></span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a>SVPC2 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">mean</span>(VISDataSet<span class="sc">$</span>PC2),<span class="fu">length</span>(SVPC1)) <span class="co"># The mean PC2 for all beetles </span></span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a>SVsize <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">mean</span>(plotVisSmall<span class="sc">$</span>meanSize),</span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a>              <span class="fu">length</span>(SVPC1)) <span class="co"># mean size of the small beetles</span></span>
<span id="cb113-11"><a href="#cb113-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-12"><a href="#cb113-12" aria-hidden="true" tabindex="-1"></a>new1<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="st">&quot;PC1&quot;</span> <span class="ot">=</span> SVPC1, <span class="st">&quot;PC2&quot;</span> <span class="ot">=</span> SVPC2, <span class="st">&quot;size&quot;</span> <span class="ot">=</span> SVsize) <span class="co"># data frame</span></span>
<span id="cb113-13"><a href="#cb113-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-14"><a href="#cb113-14" aria-hidden="true" tabindex="-1"></a>ref1<span class="ot">&lt;-</span><span class="fu">predict</span>(pglsmodVIS, <span class="at">newdata =</span> new1, </span>
<span id="cb113-15"><a href="#cb113-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">type =</span> <span class="st">&quot;response&quot;</span>) <span class="co"># Expected reflectance</span></span>
<span id="cb113-16"><a href="#cb113-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-17"><a href="#cb113-17" aria-hidden="true" tabindex="-1"></a>trend1<span class="ot">&lt;-</span><span class="fu">data.frame</span>(ref1,SVPC1) <span class="co"># PC1 values and expected reflectance joint</span></span>
<span id="cb113-18"><a href="#cb113-18" aria-hidden="true" tabindex="-1"></a>trend1<span class="sc">$</span>invSVPC1<span class="ot">&lt;-</span> trend1<span class="sc">$</span>SVPC1<span class="sc">*-</span><span class="dv">1</span></span>
<span id="cb113-19"><a href="#cb113-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-20"><a href="#cb113-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Large beetles VIS</span></span>
<span id="cb113-21"><a href="#cb113-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-22"><a href="#cb113-22" aria-hidden="true" tabindex="-1"></a>LVPC1 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">range</span>(plotVisLarge<span class="sc">$</span>meanPC1)[<span class="dv">1</span>],</span>
<span id="cb113-23"><a href="#cb113-23" aria-hidden="true" tabindex="-1"></a>             <span class="fu">range</span>(plotVisLarge<span class="sc">$</span>meanPC1)[<span class="dv">2</span>],<span class="fl">0.01</span>) <span class="co"># A range of PC1 values</span></span>
<span id="cb113-24"><a href="#cb113-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-25"><a href="#cb113-25" aria-hidden="true" tabindex="-1"></a>LVPC2 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">mean</span>(VISDataSet<span class="sc">$</span>PC2),<span class="fu">length</span>(LVPC1)) <span class="co"># The mean PC2 for all beetles</span></span>
<span id="cb113-26"><a href="#cb113-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-27"><a href="#cb113-27" aria-hidden="true" tabindex="-1"></a>LVsize <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">mean</span>(plotVisLarge<span class="sc">$</span>meanSize),</span>
<span id="cb113-28"><a href="#cb113-28" aria-hidden="true" tabindex="-1"></a>              <span class="fu">length</span>(LVPC1)) <span class="co"># mean size of the large beetles</span></span>
<span id="cb113-29"><a href="#cb113-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-30"><a href="#cb113-30" aria-hidden="true" tabindex="-1"></a>new2<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="st">&quot;PC1&quot;</span> <span class="ot">=</span> LVPC1, <span class="st">&quot;PC2&quot;</span> <span class="ot">=</span> LVPC2, <span class="st">&quot;size&quot;</span> <span class="ot">=</span> LVsize) <span class="co"># data frame </span></span>
<span id="cb113-31"><a href="#cb113-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-32"><a href="#cb113-32" aria-hidden="true" tabindex="-1"></a>ref2<span class="ot">&lt;-</span><span class="fu">predict</span>(pglsmodVIS, <span class="at">newdata =</span> new2, </span>
<span id="cb113-33"><a href="#cb113-33" aria-hidden="true" tabindex="-1"></a>              <span class="at">type =</span> <span class="st">&quot;response&quot;</span>) <span class="co"># Expected reflectance</span></span>
<span id="cb113-34"><a href="#cb113-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-35"><a href="#cb113-35" aria-hidden="true" tabindex="-1"></a>trend2<span class="ot">&lt;-</span><span class="fu">data.frame</span>(ref2,LVPC1) <span class="co"># PC1 values and expected reflectance joint</span></span>
<span id="cb113-36"><a href="#cb113-36" aria-hidden="true" tabindex="-1"></a>trend2<span class="sc">$</span>invLVPC1 <span class="ot">&lt;-</span> trend2<span class="sc">$</span>LVPC1<span class="sc">*-</span><span class="dv">1</span></span>
<span id="cb113-37"><a href="#cb113-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-38"><a href="#cb113-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-39"><a href="#cb113-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Small beetles NIR</span></span>
<span id="cb113-40"><a href="#cb113-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-41"><a href="#cb113-41" aria-hidden="true" tabindex="-1"></a>SNPC2 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">range</span>(plotNirSmall<span class="sc">$</span>meanPC2)[<span class="dv">1</span>],</span>
<span id="cb113-42"><a href="#cb113-42" aria-hidden="true" tabindex="-1"></a>             <span class="fu">range</span>(plotNirSmall<span class="sc">$</span>meanPC2)[<span class="dv">2</span>],<span class="fl">0.01</span>) <span class="co"># A range of PC2 values</span></span>
<span id="cb113-43"><a href="#cb113-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-44"><a href="#cb113-44" aria-hidden="true" tabindex="-1"></a>SNPC1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">mean</span>(ResDataSet<span class="sc">$</span>PC1),<span class="fu">length</span>(SNPC2)) <span class="co"># The mean PC1 for all beetles</span></span>
<span id="cb113-45"><a href="#cb113-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-46"><a href="#cb113-46" aria-hidden="true" tabindex="-1"></a>SNsize <span class="ot">&lt;-</span> <span class="fu">rep</span>((<span class="fu">mean</span>(plotNirSmall<span class="sc">$</span>meanSize)<span class="co"># mean size of the small beetles</span></span>
<span id="cb113-47"><a href="#cb113-47" aria-hidden="true" tabindex="-1"></a>               <span class="sc">-</span><span class="fl">0.2</span>), <span class="co"># adjusted for visualization purposes</span></span>
<span id="cb113-48"><a href="#cb113-48" aria-hidden="true" tabindex="-1"></a>              <span class="fu">length</span>(SNPC2)) </span>
<span id="cb113-49"><a href="#cb113-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-50"><a href="#cb113-50" aria-hidden="true" tabindex="-1"></a>new3<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="st">&quot;PC1&quot;</span> <span class="ot">=</span> SNPC1, <span class="st">&quot;PC2&quot;</span> <span class="ot">=</span> SNPC2, <span class="st">&quot;size&quot;</span> <span class="ot">=</span> SNsize) <span class="co"># data frame </span></span>
<span id="cb113-51"><a href="#cb113-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-52"><a href="#cb113-52" aria-hidden="true" tabindex="-1"></a>ref3<span class="ot">&lt;-</span><span class="fu">predict</span>(pglsmodFRS, <span class="at">newdata =</span> new3, </span>
<span id="cb113-53"><a href="#cb113-53" aria-hidden="true" tabindex="-1"></a>              <span class="at">type =</span> <span class="st">&quot;response&quot;</span>) <span class="co"># Expected reflectance</span></span>
<span id="cb113-54"><a href="#cb113-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-55"><a href="#cb113-55" aria-hidden="true" tabindex="-1"></a>trend3 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(ref3,SNPC2)</span>
<span id="cb113-56"><a href="#cb113-56" aria-hidden="true" tabindex="-1"></a>trend3<span class="sc">$</span>invSNPC2 <span class="ot">&lt;-</span> trend3<span class="sc">$</span>SNPC2<span class="sc">*-</span><span class="dv">1</span></span>
<span id="cb113-57"><a href="#cb113-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-58"><a href="#cb113-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-59"><a href="#cb113-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-60"><a href="#cb113-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Large beetles NIR</span></span>
<span id="cb113-61"><a href="#cb113-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-62"><a href="#cb113-62" aria-hidden="true" tabindex="-1"></a>LNPC2 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">range</span>(plotNirLarge<span class="sc">$</span>meanPC2)[<span class="dv">1</span>],</span>
<span id="cb113-63"><a href="#cb113-63" aria-hidden="true" tabindex="-1"></a>             <span class="fu">range</span>(plotNirLarge<span class="sc">$</span>meanPC2)[<span class="dv">2</span>],<span class="fl">0.01</span>) <span class="co"># A range of PC1 values</span></span>
<span id="cb113-64"><a href="#cb113-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-65"><a href="#cb113-65" aria-hidden="true" tabindex="-1"></a>LNPC1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">mean</span>(ResDataSet<span class="sc">$</span>PC1),<span class="fu">length</span>(LNPC2)) <span class="co"># The mean PC2 for all beetles</span></span>
<span id="cb113-66"><a href="#cb113-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-67"><a href="#cb113-67" aria-hidden="true" tabindex="-1"></a>LNsize <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">mean</span>(plotNirLarge<span class="sc">$</span>meanSize),</span>
<span id="cb113-68"><a href="#cb113-68" aria-hidden="true" tabindex="-1"></a>              <span class="fu">length</span>(LNPC2)) <span class="co"># mean size of the large beetles</span></span>
<span id="cb113-69"><a href="#cb113-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-70"><a href="#cb113-70" aria-hidden="true" tabindex="-1"></a>new4<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="st">&quot;PC1&quot;</span> <span class="ot">=</span> LNPC1, <span class="st">&quot;PC2&quot;</span> <span class="ot">=</span> LNPC2, <span class="st">&quot;size&quot;</span> <span class="ot">=</span> LNsize) <span class="co"># data frame </span></span>
<span id="cb113-71"><a href="#cb113-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-72"><a href="#cb113-72" aria-hidden="true" tabindex="-1"></a>ref4<span class="ot">&lt;-</span><span class="fu">predict</span>(pglsmodFRS, <span class="at">newdata =</span> new4, </span>
<span id="cb113-73"><a href="#cb113-73" aria-hidden="true" tabindex="-1"></a>              <span class="at">type =</span> <span class="st">&quot;response&quot;</span>) <span class="co"># Expected reflectance</span></span>
<span id="cb113-74"><a href="#cb113-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-75"><a href="#cb113-75" aria-hidden="true" tabindex="-1"></a>trend4 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(ref4,LNPC2)</span>
<span id="cb113-76"><a href="#cb113-76" aria-hidden="true" tabindex="-1"></a>trend4<span class="sc">$</span>invLNPC2 <span class="ot">&lt;-</span> trend4<span class="sc">$</span>LNPC2<span class="sc">*-</span><span class="dv">1</span></span></code></pre></div>
<p>We also calculated the predictions to explore the variaton in
reflectance according to size while keeping the PC1 and PC2 at fixed
values.</p>
<p>Visible</p>
<div class="sourceCode" id="cb114"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>SzVsize <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">range</span>(ToPlotInt<span class="sc">$</span>meanSize)[<span class="dv">1</span>],</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>             <span class="fu">range</span>(ToPlotInt<span class="sc">$</span>meanSize)[<span class="dv">2</span>],<span class="fl">0.01</span>) <span class="co"># A range of size</span></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>SzVPC2 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">mean</span>(ToPlotInt<span class="sc">$</span>meanPC2),<span class="fu">length</span>(SzVsize)) <span class="co"># mean PC2 all beetles </span></span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>SzVPC1<span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">mean</span>(ToPlotInt<span class="sc">$</span>meanPC1),<span class="fu">length</span>(SzVsize)) <span class="co"># mean PC1 all beetles</span></span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a>new1z<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="st">&quot;PC1&quot;</span> <span class="ot">=</span> SzVPC1, <span class="st">&quot;PC2&quot;</span> <span class="ot">=</span> SzVPC2, <span class="st">&quot;size&quot;</span> <span class="ot">=</span> SzVsize) <span class="co"># data frame</span></span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a>ref1z<span class="ot">&lt;-</span><span class="fu">predict</span>(pglsmodVIS, <span class="at">newdata =</span> new1z, </span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">type =</span> <span class="st">&quot;response&quot;</span>) <span class="co"># Expected Visible reflectance</span></span>
<span id="cb114-12"><a href="#cb114-12" aria-hidden="true" tabindex="-1"></a>trend1z<span class="ot">&lt;-</span><span class="fu">data.frame</span>(ref1z,SzVsize) <span class="co"># join Size and expected NIR reflectance</span></span>
<span id="cb114-13"><a href="#cb114-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-14"><a href="#cb114-14" aria-hidden="true" tabindex="-1"></a>ref1Nz<span class="ot">&lt;-</span><span class="fu">predict</span>(pglsmodFRS, <span class="at">newdata =</span> new1z, </span>
<span id="cb114-15"><a href="#cb114-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">type =</span> <span class="st">&quot;response&quot;</span>) <span class="co"># Expected NIR reflectance</span></span>
<span id="cb114-16"><a href="#cb114-16" aria-hidden="true" tabindex="-1"></a>trend1Nz<span class="ot">&lt;-</span><span class="fu">data.frame</span>(ref1Nz,SzVsize) <span class="co"># join Size and expected NIR reflectance</span></span></code></pre></div>
</div>
<div id="figures" class="section level2">
<h2>Figures</h2>
<div id="refl-vs.-pcs" class="section level3">
<h3>Refl vs. PCs</h3>
<p>PC axis were inverted here so that they are easy to interpret</p>
<div class="sourceCode" id="cb115"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>PVS <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plotVisSmall, <span class="fu">aes</span>(<span class="at">x =</span> <span class="sc">-</span>meanPC1, <span class="at">y =</span> meanVIS)) <span class="sc">+</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">label=</span><span class="fu">rownames</span>(plotVisSmall), </span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">nudge_x =</span> <span class="fl">0.2</span>, <span class="at">nudge_y =</span> <span class="fl">0.8</span>, </span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">col=</span><span class="st">&quot;gray&quot;</span>, <span class="at">size=</span><span class="dv">3</span></span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(</span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymin =</span> meanVIS <span class="sc">-</span> sdVIS,</span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymax =</span> meanVIS <span class="sc">+</span> sdVIS</span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb115-11"><a href="#cb115-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;#cecec2&quot;</span></span>
<span id="cb115-12"><a href="#cb115-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb115-13"><a href="#cb115-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(</span>
<span id="cb115-14"><a href="#cb115-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmin =</span> <span class="sc">-</span>meanPC1 <span class="sc">-</span> sdPC1,</span>
<span id="cb115-15"><a href="#cb115-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmax =</span> <span class="sc">-</span>meanPC1 <span class="sc">+</span> sdPC1</span>
<span id="cb115-16"><a href="#cb115-16" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb115-17"><a href="#cb115-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;#cecec2&quot;</span></span>
<span id="cb115-18"><a href="#cb115-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb115-19"><a href="#cb115-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb115-20"><a href="#cb115-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">2</span>, <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&quot;#648fff&quot;</span>,</span>
<span id="cb115-21"><a href="#cb115-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.9</span></span>
<span id="cb115-22"><a href="#cb115-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb115-23"><a href="#cb115-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">40</span>)<span class="sc">+</span></span>
<span id="cb115-24"><a href="#cb115-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="fl">2.8</span>,<span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb115-25"><a href="#cb115-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb115-26"><a href="#cb115-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)<span class="sc">+</span></span>
<span id="cb115-27"><a href="#cb115-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span> invSVPC1, <span class="at">y=</span> ref1), <span class="at">data=</span>trend1)<span class="sc">+</span></span>
<span id="cb115-28"><a href="#cb115-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Humidity (-PC1)&quot;</span>) <span class="sc">+</span></span>
<span id="cb115-29"><a href="#cb115-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span> (<span class="st">&quot;VIS reflectivity (%)&quot;</span>)</span>
<span id="cb115-30"><a href="#cb115-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-31"><a href="#cb115-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-32"><a href="#cb115-32" aria-hidden="true" tabindex="-1"></a>PVL <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plotVisLarge, <span class="fu">aes</span>(<span class="at">x =</span> <span class="sc">-</span>meanPC1, <span class="at">y =</span> meanVIS)) <span class="sc">+</span></span>
<span id="cb115-33"><a href="#cb115-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb115-34"><a href="#cb115-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">label=</span><span class="fu">rownames</span>(plotVisLarge), </span>
<span id="cb115-35"><a href="#cb115-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">nudge_x =</span> <span class="fl">0.2</span>, <span class="at">nudge_y =</span> <span class="fl">0.8</span>, </span>
<span id="cb115-36"><a href="#cb115-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">col=</span><span class="st">&quot;gray&quot;</span>, <span class="at">size=</span><span class="dv">3</span></span>
<span id="cb115-37"><a href="#cb115-37" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb115-38"><a href="#cb115-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(</span>
<span id="cb115-39"><a href="#cb115-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymin =</span> meanVIS <span class="sc">-</span> sdVIS,</span>
<span id="cb115-40"><a href="#cb115-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymax =</span> meanVIS <span class="sc">+</span> sdVIS</span>
<span id="cb115-41"><a href="#cb115-41" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb115-42"><a href="#cb115-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;#cecec2&quot;</span></span>
<span id="cb115-43"><a href="#cb115-43" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb115-44"><a href="#cb115-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(</span>
<span id="cb115-45"><a href="#cb115-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmin =</span> <span class="sc">-</span>meanPC1 <span class="sc">-</span> sdPC1,</span>
<span id="cb115-46"><a href="#cb115-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmax =</span> <span class="sc">-</span>meanPC1 <span class="sc">+</span> sdPC1</span>
<span id="cb115-47"><a href="#cb115-47" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb115-48"><a href="#cb115-48" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;#cecec2&quot;</span></span>
<span id="cb115-49"><a href="#cb115-49" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb115-50"><a href="#cb115-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb115-51"><a href="#cb115-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">2</span>, <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&quot;#ff7200&quot;</span>,</span>
<span id="cb115-52"><a href="#cb115-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.9</span></span>
<span id="cb115-53"><a href="#cb115-53" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb115-54"><a href="#cb115-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">40</span>)<span class="sc">+</span></span>
<span id="cb115-55"><a href="#cb115-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="fl">2.8</span>,<span class="dv">4</span>)<span class="sc">+</span></span>
<span id="cb115-56"><a href="#cb115-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb115-57"><a href="#cb115-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)<span class="sc">+</span></span>
<span id="cb115-58"><a href="#cb115-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span> invLVPC1, <span class="at">y=</span> ref2), <span class="at">data=</span>trend2) <span class="sc">+</span></span>
<span id="cb115-59"><a href="#cb115-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Humidity (-PC1)&quot;</span>) <span class="sc">+</span></span>
<span id="cb115-60"><a href="#cb115-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span> (<span class="st">&quot;VIS reflectivity (%)&quot;</span>)</span>
<span id="cb115-61"><a href="#cb115-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-62"><a href="#cb115-62" aria-hidden="true" tabindex="-1"></a>PNS <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plotNirSmall, <span class="fu">aes</span>(<span class="at">x =</span> <span class="sc">-</span>meanPC2, <span class="at">y =</span> meanRes)) <span class="sc">+</span></span>
<span id="cb115-63"><a href="#cb115-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb115-64"><a href="#cb115-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">label=</span><span class="fu">rownames</span>(plotNirSmall), </span>
<span id="cb115-65"><a href="#cb115-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">nudge_x =</span> <span class="fl">0.2</span>, <span class="at">nudge_y =</span> <span class="fl">0.8</span>, </span>
<span id="cb115-66"><a href="#cb115-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">col=</span><span class="st">&quot;gray&quot;</span>, <span class="at">size=</span><span class="dv">3</span></span>
<span id="cb115-67"><a href="#cb115-67" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb115-68"><a href="#cb115-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(</span>
<span id="cb115-69"><a href="#cb115-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymin =</span> meanRes <span class="sc">-</span> sdRes,</span>
<span id="cb115-70"><a href="#cb115-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymax =</span> meanRes <span class="sc">+</span> sdRes</span>
<span id="cb115-71"><a href="#cb115-71" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb115-72"><a href="#cb115-72" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;#cecec2&quot;</span></span>
<span id="cb115-73"><a href="#cb115-73" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb115-74"><a href="#cb115-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(</span>
<span id="cb115-75"><a href="#cb115-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmin =</span> <span class="sc">-</span>meanPC2 <span class="sc">-</span> sdPC2,</span>
<span id="cb115-76"><a href="#cb115-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmax =</span> <span class="sc">-</span>meanPC2 <span class="sc">+</span> sdPC2</span>
<span id="cb115-77"><a href="#cb115-77" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb115-78"><a href="#cb115-78" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;#cecec2&quot;</span></span>
<span id="cb115-79"><a href="#cb115-79" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb115-80"><a href="#cb115-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb115-81"><a href="#cb115-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">2</span>, <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&quot;#ff2c85&quot;</span>,</span>
<span id="cb115-82"><a href="#cb115-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.9</span></span>
<span id="cb115-83"><a href="#cb115-83" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb115-84"><a href="#cb115-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">20</span>,<span class="dv">40</span>)<span class="sc">+</span></span>
<span id="cb115-85"><a href="#cb115-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">4</span>,<span class="dv">4</span>)<span class="sc">+</span></span>
<span id="cb115-86"><a href="#cb115-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb115-87"><a href="#cb115-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)<span class="sc">+</span></span>
<span id="cb115-88"><a href="#cb115-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span> invSNPC2, <span class="at">y=</span> ref3), <span class="at">data=</span>trend3)  <span class="sc">+</span></span>
<span id="cb115-89"><a href="#cb115-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Aridity &amp; Radiation (-PC2)&quot;</span>) <span class="sc">+</span></span>
<span id="cb115-90"><a href="#cb115-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span> (<span class="st">&quot;NIR (res) reflectivity (%)&quot;</span>)</span>
<span id="cb115-91"><a href="#cb115-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-92"><a href="#cb115-92" aria-hidden="true" tabindex="-1"></a>PNL <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plotNirLarge, <span class="fu">aes</span>(<span class="at">x =</span> <span class="sc">-</span>meanPC2, <span class="at">y =</span> meanRes)) <span class="sc">+</span></span>
<span id="cb115-93"><a href="#cb115-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb115-94"><a href="#cb115-94" aria-hidden="true" tabindex="-1"></a>    <span class="at">label=</span><span class="fu">rownames</span>(plotNirLarge), </span>
<span id="cb115-95"><a href="#cb115-95" aria-hidden="true" tabindex="-1"></a>    <span class="at">nudge_x =</span> <span class="fl">0.2</span>, <span class="at">nudge_y =</span> <span class="fl">0.8</span>, </span>
<span id="cb115-96"><a href="#cb115-96" aria-hidden="true" tabindex="-1"></a>    <span class="at">col=</span><span class="st">&quot;gray&quot;</span>, <span class="at">size=</span><span class="dv">3</span></span>
<span id="cb115-97"><a href="#cb115-97" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb115-98"><a href="#cb115-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(</span>
<span id="cb115-99"><a href="#cb115-99" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymin =</span> meanRes <span class="sc">-</span> sdRes,</span>
<span id="cb115-100"><a href="#cb115-100" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymax =</span> meanRes <span class="sc">+</span> sdRes</span>
<span id="cb115-101"><a href="#cb115-101" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb115-102"><a href="#cb115-102" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;#cecec2&quot;</span></span>
<span id="cb115-103"><a href="#cb115-103" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb115-104"><a href="#cb115-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(</span>
<span id="cb115-105"><a href="#cb115-105" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmin =</span> <span class="sc">-</span>meanPC2 <span class="sc">-</span> sdPC2,</span>
<span id="cb115-106"><a href="#cb115-106" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmax =</span> <span class="sc">-</span>meanPC2 <span class="sc">+</span> sdPC2</span>
<span id="cb115-107"><a href="#cb115-107" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb115-108"><a href="#cb115-108" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;#cecec2&quot;</span></span>
<span id="cb115-109"><a href="#cb115-109" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb115-110"><a href="#cb115-110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb115-111"><a href="#cb115-111" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">2</span>, <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&quot;#ffb000&quot;</span>,</span>
<span id="cb115-112"><a href="#cb115-112" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.9</span></span>
<span id="cb115-113"><a href="#cb115-113" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb115-114"><a href="#cb115-114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">20</span>,<span class="dv">40</span>)<span class="sc">+</span></span>
<span id="cb115-115"><a href="#cb115-115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="fl">2.8</span>,<span class="dv">6</span>)<span class="sc">+</span></span>
<span id="cb115-116"><a href="#cb115-116" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb115-117"><a href="#cb115-117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)<span class="sc">+</span></span>
<span id="cb115-118"><a href="#cb115-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span> invLNPC2, <span class="at">y=</span> ref4), <span class="at">data=</span>trend4)  <span class="sc">+</span></span>
<span id="cb115-119"><a href="#cb115-119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Aridity &amp; Radiation (-PC2)&quot;</span>)  <span class="sc">+</span></span>
<span id="cb115-120"><a href="#cb115-120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span> (<span class="st">&quot;NIR (res) reflectivity (%)&quot;</span>)</span>
<span id="cb115-121"><a href="#cb115-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-122"><a href="#cb115-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-123"><a href="#cb115-123" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(PVS, PVL, PNS, PNL, <span class="at">nrow =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="MacroEcol_9_ReflectivityQC_files/figure-html/unnamed-chunk-57-1.png" width="672" /></p>
</div>
<div id="refl-vs.-size" class="section level3">
<h3>Refl vs. Size</h3>
<div class="sourceCode" id="cb116"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>PViSize <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(ToPlotInt, <span class="fu">aes</span>(<span class="at">x =</span> meanSize, <span class="at">y =</span> meanVIS)) <span class="sc">+</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymin =</span> meanVIS <span class="sc">-</span> sdVIS,</span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymax =</span> meanVIS <span class="sc">+</span> sdVIS</span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;#cecec2&quot;</span></span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(</span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmin =</span> meanSize <span class="sc">-</span> sdSize,</span>
<span id="cb116-10"><a href="#cb116-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmax =</span> meanSize <span class="sc">+</span> sdSize</span>
<span id="cb116-11"><a href="#cb116-11" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb116-12"><a href="#cb116-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;#cecec2&quot;</span></span>
<span id="cb116-13"><a href="#cb116-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb116-14"><a href="#cb116-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb116-15"><a href="#cb116-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">2</span>, <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&quot;#648fff&quot;</span>,</span>
<span id="cb116-16"><a href="#cb116-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.9</span></span>
<span id="cb116-17"><a href="#cb116-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb116-18"><a href="#cb116-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb116-19"><a href="#cb116-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)<span class="sc">+</span></span>
<span id="cb116-20"><a href="#cb116-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span> SzVsize, <span class="at">y=</span> ref1z), <span class="at">data=</span>trend1z)<span class="sc">+</span></span>
<span id="cb116-21"><a href="#cb116-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Size (cm)&quot;</span>) <span class="sc">+</span></span>
<span id="cb116-22"><a href="#cb116-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span> (<span class="st">&quot;VIS reflectivity (%)&quot;</span>)</span>
<span id="cb116-23"><a href="#cb116-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-24"><a href="#cb116-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-25"><a href="#cb116-25" aria-hidden="true" tabindex="-1"></a>PNiSize <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(ToPlotInt, <span class="fu">aes</span>(<span class="at">x =</span> meanSize, <span class="at">y =</span> meanRes)) <span class="sc">+</span></span>
<span id="cb116-26"><a href="#cb116-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(</span>
<span id="cb116-27"><a href="#cb116-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymin =</span> meanRes <span class="sc">-</span> sdRes,</span>
<span id="cb116-28"><a href="#cb116-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymax =</span> meanRes <span class="sc">+</span> sdRes</span>
<span id="cb116-29"><a href="#cb116-29" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb116-30"><a href="#cb116-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;#cecec2&quot;</span></span>
<span id="cb116-31"><a href="#cb116-31" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb116-32"><a href="#cb116-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(</span>
<span id="cb116-33"><a href="#cb116-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmin =</span> meanSize <span class="sc">-</span> sdSize,</span>
<span id="cb116-34"><a href="#cb116-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmax =</span> meanSize <span class="sc">+</span> sdSize</span>
<span id="cb116-35"><a href="#cb116-35" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb116-36"><a href="#cb116-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;#cecec2&quot;</span></span>
<span id="cb116-37"><a href="#cb116-37" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb116-38"><a href="#cb116-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb116-39"><a href="#cb116-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">2</span>, <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&quot;#ff2c85&quot;</span>,</span>
<span id="cb116-40"><a href="#cb116-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.9</span></span>
<span id="cb116-41"><a href="#cb116-41" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb116-42"><a href="#cb116-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb116-43"><a href="#cb116-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)<span class="sc">+</span></span>
<span id="cb116-44"><a href="#cb116-44" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_line(aes(x= SzVsize, y= ref1Nz), data=trend1Nz)+</span></span>
<span id="cb116-45"><a href="#cb116-45" aria-hidden="true" tabindex="-1"></a>  <span class="co"># trend not included since it is not different than 0 (pval&gt;0.05)</span></span>
<span id="cb116-46"><a href="#cb116-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Size (cm)&quot;</span>) <span class="sc">+</span></span>
<span id="cb116-47"><a href="#cb116-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span> (<span class="st">&quot;NIR (res) reflectivity (%)&quot;</span>)</span>
<span id="cb116-48"><a href="#cb116-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-49"><a href="#cb116-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-50"><a href="#cb116-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-51"><a href="#cb116-51" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(PViSize, PNiSize, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 3 rows containing missing values (geom_errorbarh).
## Removed 3 rows containing missing values (geom_errorbarh).</code></pre>
<p><img src="MacroEcol_9_ReflectivityQC_files/figure-html/unnamed-chunk-58-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="pagels-lambda" class="section level1">
<h1>Pagel’s Lambda</h1>
<p>TOT reflectance</p>
<div class="sourceCode" id="cb118"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>pagelTOTRefl <span class="ot">&lt;-</span> Cons1agg<span class="sc">$</span>TOT <span class="co"># Define which trait you want to test</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(pagelTOTRefl) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(Cons1agg) <span class="co"># Row names = tree tips</span></span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a><span class="fu">phylosig</span>(MCCtree, pagelTOTRefl, <span class="at">method =</span> <span class="st">&quot;lambda&quot;</span>, <span class="at">test =</span> <span class="cn">TRUE</span>, <span class="at">nsim =</span> <span class="dv">999</span>)</span></code></pre></div>
<pre><code>## [1] &quot;some species in tree are missing from x , dropping missing taxa from the tree&quot;</code></pre>
<pre><code>## 
## Phylogenetic signal lambda : 0.876827 
## logL(lambda) : -141.237 
## LR(lambda=0) : 3.02617 
## P-value (based on LR test) : 0.081931</code></pre>
<div class="sourceCode" id="cb121"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co"># nsim = 999 means testing with 999 randomizations</span></span></code></pre></div>
<p>VIS reflectance</p>
<div class="sourceCode" id="cb122"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>pagelVISRefl <span class="ot">&lt;-</span> Cons1agg<span class="sc">$</span>VIS <span class="co"># Define which trait you want to test</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(pagelVISRefl) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(Cons1agg) <span class="co"># Row names = tree tips</span></span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a><span class="fu">phylosig</span>(MCCtree, pagelVISRefl, <span class="at">method =</span> <span class="st">&quot;lambda&quot;</span>, <span class="at">test =</span> <span class="cn">TRUE</span>, <span class="at">nsim =</span> <span class="dv">999</span>)</span></code></pre></div>
<pre><code>## [1] &quot;some species in tree are missing from x , dropping missing taxa from the tree&quot;</code></pre>
<pre><code>## 
## Phylogenetic signal lambda : 0.917646 
## logL(lambda) : -138.668 
## LR(lambda=0) : 3.14832 
## P-value (based on LR test) : 0.0760051</code></pre>
<div class="sourceCode" id="cb125"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co"># nsim = 999 means testing with 999 randomizations</span></span></code></pre></div>
<p>NIR reflectance</p>
<div class="sourceCode" id="cb126"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>pagelNIRRefl <span class="ot">&lt;-</span> Cons1agg<span class="sc">$</span>NIR <span class="co"># Define which trait you want to test</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(pagelNIRRefl) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(Cons1agg) <span class="co"># Row names = tree tips</span></span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a><span class="fu">phylosig</span>(MCCtree, pagelNIRRefl, <span class="at">method =</span> <span class="st">&quot;lambda&quot;</span>, <span class="at">test =</span> <span class="cn">TRUE</span>, <span class="at">nsim =</span> <span class="dv">999</span>)</span></code></pre></div>
<pre><code>## [1] &quot;some species in tree are missing from x , dropping missing taxa from the tree&quot;</code></pre>
<pre><code>## 
## Phylogenetic signal lambda : 0.837779 
## logL(lambda) : -146.965 
## LR(lambda=0) : 3.43904 
## P-value (based on LR test) : 0.0636728</code></pre>
<div class="sourceCode" id="cb129"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co"># nsim = 999 means testing with 999 randomizations</span></span></code></pre></div>
<p>NIR residuals (no phylogenetic correction)</p>
<div class="sourceCode" id="cb130"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>pagelRes <span class="ot">&lt;-</span> Cons1agg<span class="sc">$</span>Res <span class="co"># Define which trait you want to test</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(pagelRes) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(Cons1agg) <span class="co"># Row names = tree tips</span></span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a><span class="fu">phylosig</span>(MCCtree, pagelRes, <span class="at">method =</span> <span class="st">&quot;lambda&quot;</span>, <span class="at">test =</span> <span class="cn">TRUE</span>, <span class="at">nsim =</span> <span class="dv">999</span>)</span></code></pre></div>
<pre><code>## [1] &quot;some species in tree are missing from x , dropping missing taxa from the tree&quot;</code></pre>
<pre><code>## 
## Phylogenetic signal lambda : 0.759491 
## logL(lambda) : -124.569 
## LR(lambda=0) : 5.72677 
## P-value (based on LR test) : 0.0167082</code></pre>
<div class="sourceCode" id="cb133"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co"># nsim = 999 means testing with 999 randomizations</span></span></code></pre></div>
<p>FRS residuals from the PGLS</p>
<div class="sourceCode" id="cb134"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>pagelFRS <span class="ot">&lt;-</span> Cons1agg<span class="sc">$</span>FRS <span class="co"># Define which trait you want to test</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(pagelFRS) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(Cons1agg) <span class="co"># Row names = tree tips</span></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a><span class="fu">phylosig</span>(MCCtree, pagelFRS, <span class="at">method =</span> <span class="st">&quot;lambda&quot;</span>, <span class="at">test =</span> <span class="cn">TRUE</span>, <span class="at">nsim =</span> <span class="dv">999</span>)</span></code></pre></div>
<pre><code>## [1] &quot;some species in tree are missing from x , dropping missing taxa from the tree&quot;</code></pre>
<pre><code>## 
## Phylogenetic signal lambda : 0.76322 
## logL(lambda) : -124.813 
## LR(lambda=0) : 5.75908 
## P-value (based on LR test) : 0.0164037</code></pre>
<div class="sourceCode" id="cb137"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co"># nsim = 999 means testing with 999 randomizations</span></span></code></pre></div>
<p>PRS phylores residuals from the PGLS</p>
<div class="sourceCode" id="cb138"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>pagelPRS <span class="ot">&lt;-</span> Cons1agg<span class="sc">$</span>FRS2 <span class="co"># Define which trait you want to test</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(pagelPRS) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(Cons1agg) <span class="co"># Row names = tree tips</span></span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a><span class="fu">phylosig</span>(MCCtree, pagelPRS, <span class="at">method =</span> <span class="st">&quot;lambda&quot;</span>, <span class="at">test =</span> <span class="cn">TRUE</span>, <span class="at">nsim =</span> <span class="dv">999</span>)</span></code></pre></div>
<pre><code>## [1] &quot;some species in tree are missing from x , dropping missing taxa from the tree&quot;</code></pre>
<pre><code>## 
## Phylogenetic signal lambda : 0.0000683657 
## logL(lambda) : -101.227 
## LR(lambda=0) : -0.00144863 
## P-value (based on LR test) : 1</code></pre>
<div class="sourceCode" id="cb141"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co"># nsim = 999 means testing with 999 randomizations</span></span></code></pre></div>
</div>
<div id="conclusions" class="section level1">
<h1>Conclusions</h1>
<p><br> For Visible reflectivity the interaction between Size and PC1
was significant. Lower PC1 = higher humidity (vapour, rain and clouds)
lower aridity. Smaller beetles reflect more visible light in humid
environments</p>
<p><br> For NIR reflectivity the interaction between Size and PC2 was
significant. Lower PC2 = higher solar radiation, higher max temp, more
days above 35 and more aridity Smaller beetles reflect less NIR light in
hot/arid environments.</p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4,h5",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
